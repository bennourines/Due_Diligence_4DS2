c monero research lab research bulletin mrl 0001 note chain reactions traceability cryptonote 2 0 12 september 2014 surae noether sarang noether adam mackenzie correspondence lab monero cc monero research lab abstract research bulletin describes plausible attack ring signature based anonymity system use motivation cryptocurrency protocol cryptonote 2 0 ostensibly published nicolas van saberhagen 2012 previously demonstrated untraceability obscuring time key pair dependent untraceability keys composing ring signature allows possibility chain reactions traceability ring signatures causing critical loss untraceability network parameters poorly chosen attacker owns su cient percentage network signatures time attack necessarily violate anonymity users attack plausibly weaken resistance cryptonote demonstrates blockchain analysis research bulletin undergone peer review ects results internal investigation 1 introduction cryptonote protocol problem anonymity depends anonymity use 5 6 18 outputs compose ring signature true signer spend 5 6 18 outputs foreign outputs mixins ring signatures reveal spender observer true signer transaction malicious spent outputs non anonymously legitimate business legal reasons party large proportion utxo set gain knowledge traceability transactions reveal information network fancifully interpret problem abstract cryptocurrency implementation gresham s law bad money drives good unspent transaction output utxo set filled lot transactions aren t anonymous fewer ways untraceable ring signatures point noted scenario time key pairs called stealth addresses cryptonote protocols violated scenario anonymity users directly violated attack violates untraceability time ring signatures development somewhat worrying non malicious entities c monero research lab page 2 8 execute attack accident malicious entities spam network lots utxo set malicious entities break untraceability attacker s intent interest pump n dump scheme undermining credibility currency interest spying users disinterest paying extra cost adding foreign unspent transaction outputs ring signatures cases despite priori hope particular user interested large number mixins ring signatures matter principle interest personal security common good expectation practice version tragedy commons place cause traceability network subset users mind forest trees user compose trivial ring signature additional outputs immedi ately exposing outputs line second order problem new transaction exposed creating exposure risk ring signatures newly exposed transaction obfuscating mixin possible chain reaction occur malicious entity stops actively attacking early history coin research bulletin written analyze prob lem determine plausibility conservative route attack assess network parameters ensure graceful degradation untraceability 2 setup passive attack college probability class come following don t know solve urn contains n marbles possible colors nb black marbles nw white marbles nb nw n fixed draw m marbles urn probability marbles drew urn black probability marbles white 0 m m probability m black marbles m m white marbles phrased way immediately jump hypergeometric distribution probability mass function nb b n nb m b n m compute probability marbles hand black set b m use convenient formulae available number free online textbooks wikipedia order compute probability particular occurrence s nicer distributions play following game marbles draw black ll toss new black marble urn replace handful ll toss new white marble urn replace handful marbles cryptonote coins help envision marble atomic unit cryptonote analogue satoshi tracked utxo set cryptonote c monero research lab page 3 8 network color denotes control marble black controlled malicious entity white let s lisa wishes send money milhouse add marble bag utxo set lisa draws order ring signatures contain n transaction outputs nb controlled burns black marbles assume rest white formula exactly need lisa composed ring signature withm n mixins 1 drew handful marbles decide color marble add urn controlled burns burns spends outputs mixins 2 lisa s transaction exposed furthermore forget lisa ring signature burns signatures actually considered burns controlled set terms untraceability burns control private keys notice scenario having chain reaction occur burns reveals transaction outputs turn reveals lisa s output assumptions burns controls initial proportion unknown utxo set ii new transactions generate ring signatures drawn current utxo set uniform unordered way replacement iii new transactions use exactly mandatory minimum mixin level handful size m iv burns gains control new transactions ring signatures solely composed burns controlled transactions e burns stops putting new transactions system time t 0 change assumptions strengthen weaken attack scenario example attack weaker transactions use mandatory minimum attack stronger burns gain control transactions generating e passive actor background reasonable middle ground scenario interpret following way burns initially controls portion utxo set ood ostensibly honest transactions composed suddenly happens protecting network large scale degradation untraceability scenario simply matter smart engineering protect network large scale degradation worse scenarios better shall start considered christmas day attack simulations set mimic sudden ux economic activity truly malicious attacker respond ease coding attack executed ostensibly innocent individual simply spending money non anonymously perfectly legitimate reasons hypergeometric distribution nice expect game let analyze results single new transaction assuming m minimum number mixins network probability m mixin signatures controlled burns probability large new transactions likely controlled burns 1 define mixin foreign output included transaction 2 emphasized ostensibly innocent act attack c monero research lab page 4 8 reveal transaction outputs controls cryptonote transactions controlled single malicious party weaker untraceability trait new transactions consider following numerical example suppose n 103 transaction outputs anonymity set counting real output belonging lisa burns controls pn transactions 0 p 1 denote pr p probability ring signature mixins signed solely outputs belonging burns proba bility describes roughly lisa s new marble black white table 1 contains sample values pr p example p pn pr p 10 3 1 0 10 2 10 7 22 10 7 10 1 100 9 73 10 4 0 5 500 0 125 table 1 burns controls pn transaction outputs anonymity set n 103 outputs display probability pr p lisa s output traceable burns point view assuming lisa uses mixins construction ring signature beginning large scale simulation burns controls half transactions expect 12 5% new transactions interpret table burns controls single output anonymity set way distinct outputs ring signature long burns controls outputs probability 0 00000722 lisa s ring signature controlled burns small av erage 13 8 million signatures anonymity set start seeing collisions burns controls 100 outputs probability 0 000973 signature lisa controlled burns start seeing col lisions 100 000 signatures finally burns controls half outputs 12 5% new transactions ring signature composed entirely outputs burns gaining 1 8 new transactions burns share utxo set shrink time takes action table 2 produce values table 1 mixins case burns controls half outputs consequence new outputs controlled burns burns controls 10% outputs 1 1000 new transactions controlled burns clearly great 3 mixins terrible burns controls half transactions 25% chance new ring signature belong burns share utxo set shrink time takes action p pn pr p 10 3 1 0 10 2 10 9 01 10 5 10 1 100 9 91 10 3 0 5 500 0 25 table 2 burns controls pn transaction outputs anonymity set n 103 outputs display probability pr p new output revealed attack assuming lisa uses mixins construction ring signature beginning large scale simulation burns controls half transactions expect grab 25% new transactions c monero research lab page 5 8 3 monte carlo methods results hold tight notation choose parameters nb0 nw0 m nb0 denotes initial number black marbles owned burns nw0 denotes initial number white marbles m minimum mixin level play game iteratively record initial proportion unspent transactions owned burns p0 nb0 nb0 nw0 beginning ith iteration adding ni nb0 nw0 th marble bag draw uniform random number u 0 1 compare hypergeometric mass function described u nbi m ni m marble black iterate nbi nbi 1 1 regardless choice u iterate ni 1 ni 1 need compute nw simply subtract iterations iterations usually iterations double quadruple utxo set stop game consider proportion black marbles pf nbi ni concerned new marbles black total black watch metric success burns attack value b pf nbi nb0 number black marbles burns gained game divided number marbles added bag process constitutes simulation choice parameters nb0 nw0 m result b pf determined result sequence random experiments random variable run 37 trials sample mean sample variance experiments initially looked 95% confidence intervals narrow ignore end simulate utxo set growing 5000 transactions 20000 plot 20000pf 5000pi 15000 proportion os tensibly honest transactions burns grabs figure 1 illustrates simulation results nb nw 5000 m 1 2 3 4 mandatory minimum mixins event utxo set quadruples honest transactions 15 000 new transactions need new ring signatures horizontal axis displays ini tial proportion utxo set controlled burns varying 0 0 1 0 vertical axis displays final proportion new transactions utxo set controlled burns varying 0 0 1 0 note number zero y axis represents loss security s clear b pf monotonically increasing function p0 nb nb nw situation improves greater numbers ring signatures notice dynamical systems problems built data graph pf vs pi b pf vs pi interpret discrete time dynamical system s evolution function burns share zero time mixin 2 expect 1 mixin scenario urn stochastically jump y x line appreciably expectation moving direction random walk long require m 2 mixins chain reaction burn speak burns share utxo set shrink zero time takes action results suggest mandatory mixin 2 allow system recover passive attack quickly code generate data probably improved located http goo gl dgj5tz google documents generate figures c monero research lab page 6 8 figure 1 figure displays apologies color blind success attack executed burns increasing numbers mixins success uniformly decreases accross board refresh reader probably jumped directly graph s scenario evil guy burns starts initial proportion x axis utxo set 5000 transaction outputs inside ood 15 000 new honest transactions hits network lisa milhouse homer marge causing utxo set quadruple size event burns spend initial proportion pi utxo set mixins consequently break untraceability proportion 15 000 ostensibly honest transactions display proportion b pf function pi 10 mixins burns requires 55% utxo set capture quadrupling event requires 87% utxo set order capture 1% quadrupling event parameters 4 critical mass slow chain reactions active attackers questions recall set ask question critical chain reaction occur related question network parameters choose ensure plausible chain reaction burns need critical mass consider urn problem happens composition urn game evolves toss new black white marbles urn draw remember black marbles ones revealed draw black marbles means marble add urn black critical mass scenario black marbles urn burns starts grabbing black marbles pf pi expect sort critical mass occur numerical edge cases pf pi 2 mixins chain reactions truncated rapidly chain reactions act slower slower mixins increase single mixin inappropriate currency problem anonymous malicious user spam network transactions control hopes tually control greater proportions utxo set essentially transactions fully traceable burns point view burns doesn t single action initial seed transactions planted utxo set fixed initial cost attacker leading c monero research lab page 7 8 ending stream information form traceable transactions users clearly catastrophic economic failure important putting italics cryptonote coin allows 1 mixin vulnerable slow chain reaction owner private keys violate untraceability larger number users requiring mixin 2 transactions save transactions willfully spent 0 mixins chain reactions probabilistically smaller length number greater 1 force chain reactions burn spread network higher better course protocol enforced network wide mandatory minimimum mixin m 10 presumably cause blockchain bloat hinder adoption s security benefits terms network size likely optimal size mandatory minimum mixin suggest m 2 protocol enforced mandatory minimum advise users use mixin signatures little hearts desire note scenario different change parameters model change assumptions include active attackers let s discuss parameters real quick consider addition new marble nudging burns passive ownership probability way burns grabs incoming transactions share utxo set depleted time parameters change process recall parameters 1 nb0 number initial atomic units controlled burns utxo set 2 nw0 remaining atomic units utxo set 3 m mandatory minimum mixin enforced network protocol interested pi nb0 nb0 nw0 n0 nb0 nw0 seen pi m general change outcome experiment n0 gets big burns share start slow meaning burns grabbing incoming transactions s getting reduced rate returns terms overall proportion utxo set owns think utxo set size mass gets bigger gets harder change state hidden parameter new transactions added swept rug simply saying okay utxo set going quadruple s initial size reducing parameter space little bit reduced importance n0 parameter know n changes easily compute slope statistic t n respect change population size sensitivity s t nf t nf t 4 t 3no close zero suggests relationship far zero suggests strong relationship positive negative easily compute slope log statistic respect log population sensitivity s log t nf log t n0 log nf log 1 4 log t 4 t c monero research lab page 8 8 version sensitivity don t nf formula simply multiplicative factor nf 4 feel unnecessary present scale parameter space analysis model let s discuss changing assumptions apparently small tweak add simulation change assumption iv order model aggressive attacker christmas day accidental reveal sort attack implement probabilistic assumption like v burns gains control new transaction result sequence bernoulli trials fixed probability q burns generates transaction knows probability 1 q foreign transaction appears generates new ring signature solely composed burns controlled transactions e burns participates economy implement dynamical model malicious burns tries maintain minimum proportion utxo set spamming transactions network proportion drops secretly determined percentage v burns gains control new transaction result sequence non autonomous bernoulli like experiments probability q b n dependent number utxos controlled burns b total utxo set n burns generates transaction knows probability 1 q b n foreign transaction appears generates new ring signature solely composed burns controlled transactions function q b n burns try close 1 b n smaller burns preference allow burns grow share utxoset course easiest simplest strategy burns spam network fast possible transactions fees isn t free bring parameters assumptions work problem discovered network engineers need know order ensure graceful degradation pick big mixins interesting questions lurking surface solved problem graph theory probability note time goes utxo likely chosen mixins likely exposed previous users revealing transactions spending 0 mixins complicating wisdom choosing utxos ring signature uniform distribution technically sort critical mass sort problem s going steady state problem lurking surface definitely dynamical systems stuff ying 3 problem maybe ambitious undergraduate wants pick leave contribute cryptocurrency community expanding 3