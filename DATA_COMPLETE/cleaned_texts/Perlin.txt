b wavelet decentralized asynchronous general purpose proof stake ledger scales powerful adaptive adversaries kenta iwasaki kenta perlin net heyang zhou heyang zhou perlin net 26 2019 abstract wavelet introduces novel family directed acyclic graph dag based consensus protocols designed alleviate numerous scalability dilemmas predicated decentralized ledgers utilize longest chain rule variant stake delegation committee election scheme wavelet guarantees irreversibility transactions consistent total ordering transactions compromise safety performance liveness enabling features transaction graph pruning turing complete smart contract execution safety liveness wavelet solely dependent safety liveness arbitrarily chosen byzantine fault tolerant binary consensus protocol executed wavelet framework unlike prior works wavelet requires minimal configuration minuscule set system parameters work large range practical network settings communication partially synchronous 1 introduction distributed systems suffer known scalability dilemma dilemma forces system designers tradeoffs performance consistency availability aspects utmost importance comes creation practical resilient fault tolerant applications particular class distributed systems blockchains suffer aforementioned dilemma perform trivial analysis results classical computer science literature describe analyze plethora faults render numerous modern blockchain constructions impractical 1 1 scalability dilemma recall multiple readers multiple writers problem 4 exists n processors trying concurrently read write shared resource r additional processor alloted system requires exponential increase amounts coordination n processors read write resource r reposition problem distributed setting exists communication latency processor equivalence established problem fundamentally difficult efficiently coordinate network nodes maintain distributed ledger introducing exponential communication costs cumbersomely accounting faulty processors designing protocol coordinate multiple readers multiple writers interact resource r introduces significant additional overhead paper denote problem scalability dilemma 1 x0c1 2 longest chain rule scale consider network n nodes difficulty system mechanized decentralized random lottery n nodes established short time interval xe2 x88 x86 subset f n nodes propose block transactions append longest weighted path directed acyclic graph blocks g shared entire network denote distributed system follow longest chain rule 10 bitcoin ethereum decentralized ledger architectures noteworthy examples distributed systems follow rule time interval xe2 x88 x86 exist f xe2 x88 x92 1 conflicting blocks attempting appended longest weighted path g known longest chain resolving conflicts f xe2 x88 x92 1 blocks requires nodes f append additional blocks blocks proposed difficulty system makes task individual node xe2 x88 x88 f require exponential time complexity able resolve conflicts arduous relaxation scenario longest chain rule effectively trying n nodes compete having chance read write resource r longest chain simply scalable large n distributed system follows longest chain rule suffers scalability dilemma 1 3 committees improve performance weakening security consider network n nodes c subset n nodes denoted committee committee responsible verifying processing transactions network methodology electing committee time interval permits matter means stake delegation 9 verifiable random functions 6 decentralized electoral voting schemes 2 noteworthy examples distributed ledgers utilize committees algorand tendermint ouroboros praos dfinity eos scheme scale variably given communication nodes xe2 x88 x88 c necessary maintain distributed ledger c small form denial service attack collusion c jeopardize entire network minimize risks attacks happening require scaling size c contradicts benefits maintaining small committee given larger committee exponentially increases communication complexity distributed system relies subset nodes verify process transactions entire network suffers scalability dilemma 1 4 partial ordering transactions limited practicality notably consensus protocols orient consensus replication directed acyclic graph transactions nodes avalanche 12 1 able guarantee partial ordering transactions 2 unable guarantee irreversibility transactions 3 susceptible numerous challenges seeking enable new nodes bootstrap join network inability fulfill guarantees restricts ledger unable provide wide plethora features instance lack guarantee total ordering transactions render ledger incapable payments platform impossible turing complete smart contracts platform built ledger 2 x0cguarantees partial ordering transactions sequence smart contracts executed totally different different nodes network 1 5 network assumptions protocol guarantees definition 1 1 adversarial model assume powerful adaptive adversary capable observing internal state node network adversary uniformly drop reorder redirect messages sent node long 1 k messages successfully gets delivered node intended recipient k small fixed security parameter wavelet guarantees strong safety liveness assuming communication network partially synchronous 5 soft probabilistic bounds respect k given prescribed adversarial model conditions wavelet able achieve irreversible consistent total ordering application virtuous transactions network 2 wavelet protocol protocol comprises processes running parallel gossiping querying definition 2 1 identity node network assumes public key infrastructure pki nodes identified associated public keys definition 2 2 hash denote cryptographic hash function h random oracle differentiable refer bit length outputs hash function h h definition 2 3 account accounts referenced associated public key comprise balance balance virtual currency alongside nonce nonce nonce associated counter sequentially counts changes specified account procedure preventing replay attacks definition 2 4 state node network maintains ledger state s representative immutable merkelized key value store produce merkle root xce xb4 definition 2 5 graph node network maintains directed acyclic graph g vertices comprise accepted pending transactions edges representative causal topological ordering definition 2 6 transaction transaction tx denotes atomic unit changes applied locally node state s perspective designated creator transaction referenced unique id checksum contents metadata transactions vertices g casually reference set parent vertices tx parents id transactions reference depth respect graph g tx depth transaction denotes proposal changes apply state s payload tx payload invoke unique operation designated tx tag compactly transaction tx id depth parents tag payload definition 2 7 transaction authorship transaction tx applies changes state s respect creator creator transaction referenced public key tx creator optional possible creator transaction delegate responsibility proposing relaying contents transaction tx network node referenced public key tx sender transaction specify creator sender transaction xe2 x80 x99s sender creator creator transaction signs appends signature noncektx tagktx payload tx sender transaction signs appends signature entire contents tx excluding unique id 3 x0c2 1 creating transaction assume parties alice bob alice holds large virtual currency wants create transaction tx deducts money account adds money bob xe2 x80 x99s account alice pries view graph g selects parents transaction tx max num parents available transactions depth diff depths g xe2 x80 x99s frontier reference children transactions leaf nodes graph g definition 2 8 transaction depth selecting parents transaction tx depth transaction tx depth computed appended tx tx depth max parent depth parent xe2 x88 x88 tx parents 1 1 definition 2 9 transaction seed depth transaction computed denote unique checksum known seed transaction tx seed computed tx seed h tx senderktx parents 2 important remark id seed transaction tx simply stored memory trivially computed node network signing transaction tx alice excludes id seed transaction producing appending creator xe2 x80 x99s sender xe2 x80 x99s signatures tx 2 2 gossiping alice signs proceeds publish transaction tx network arbitrary eventuallyconsistent asynchronous gossiping protocol pgossip eventual period time xe2 x88 x86 exist publication new transactions nodes eventually contents graph g consistent transactions newly created relayed received gossiping process fully accepted network importance gossiping process ensure nodes eventually construct equivalent consistent view graphs g assumption overlay network protocol poverlay enforced allow nodes send eventually receive gossiped transactions presence adversary capable dropping reordering indefinitely delaying large percentage messages sent individual nodes definition 2 10 depth assertion receipt transaction tx node alice performs assertion appending tx view graph g depth parents transaction respect tx depth differ depth diff fixed system parameter depth diff restricts transactions able select parent transactions depth graph g definition 2 11 order assertion receipt transaction tx node alice performs assertion appending tx view graph g parents transaction tx parents lexicographically sorted ascending order definition 2 12 parent selection limit receipt transaction tx node alice performs assertion tx max num parents parents referenced appending tx view graph g 2 3 querying apart gossiping process process runs parallel node responsible ordering finalizing applying transactions nodes xe2 x80 x99 local state s querying process runs incrementally graph g gets built node finalizing batches 4 x0cof transactions root g frontier g specifically querying process xe2 x80 x99 objective divide graph g consistently node consensus rounds definition 2 13 consensus round consensus round rr non overlapping depth interval notated rr r txstart depth txend depth r xe2 x88 x88 0 xe2 x88 x9e txstart txend starting ending point transactions depth interval consensus round comprises starting ending points consensus round transactions marked critical definition 2 14 critical transaction transaction tx marked critical number prefixed zero bits seed tx seed xe2 x89 xa5 dr dr dynamic system parameter known difficulty parameter unique respect given consensus round r assume alice consensus round r0 gossiping process progresses builds g discovery critical transaction alice propose candidate ending point current round r0 starting point round r1 proposal r1 1 root depth txc depth root root transaction g txc critical transaction spotted alice alternatively apart alice proposing ending point round r0 alice learn peers existence alternative ending points r0 alice proceeds execute arbitrary byzantine fault tolerant binary consensus protocol pquery garner unbiased opinion network finalized contents consensus round r1 finality contents consensus round r1 breadth traversal performed find transactions paths g starting point root ending point txc0 txc0 finalized starting point r1 finalized ending point r0 order breadth traversal performed finalized ordering transactions applied locally nodes state s round r0 subset transactions traversed finalized consensus round r0 marked accepted transactions depth interval r0 marked failed definition 2 15 state assertion denote existing consensus rounds r equivalent indices r point time appended merkle roots xce xb4 computed applying accepted transactions ri xe2 x88 x88 r state s finality single consensus round ri xe2 x88 x88 r nodes apply accepted transactions ri state s recover merkle root xce xb4 0 nodes able assert integrity newly updated state s 0 respect finalized round ri asserting xce xb4 0 xce xb4 accepted transactions applied nodes state s application incrementing nonce transactions creator nodes repeat entire querying process searching ending point critical transaction consensus round r2 set root consensus round r1 txc0 querying process inductively proceeds forward consensus round onwards 2 4 partial synchrony crucial aspect protocol computing ideal value dynamically changing system parameter dr given consensus round r paint picture recall gossiping process results graph g eventually consistent nodes network larger n n number nodes network larger time upper bound xe2 x88 x86 having gossiping converge completing target objective having nodes consistent graphs g larger n implies larger transactions proposed second exists sources spawn distribute transactions network denote upper bound frequency single node ni able create gossip transactions second f maximum number transactions created instance time nf representative max possible load network moment time 5 x0cdenote time takes finalize single consensus round t0 number transactions encompassed non overlapping depth interval representative single consensus round given difficulty parameter dr f 0 conjecture 2 1 partial synchrony bounds denote total number transactions pending accepted g gpending total number transactions finalized g gfinalized g xe2 x88 x92 gpending given time t transaction g considered finalized depth equal depth ending point transaction recently finalized consensus round 0 0 d gpending xe2 x88 x92 gfinalized 0 conversely nf xe2 x89 xa4 ft0 node aware nf ft0 limt xe2 x86 x92 xe2 x88 x9e dt d gpending xe2 x88 x92 gfinalized 0 limt xe2 x86 x92 xe2 x88 x9e dt consequence conjecture 2 1 consensus rounds sufficiently finalize large depth intervals g time gpending strictly increasing time respect gfinalized represents consequence protocol exhibiting liveness fault misconfiguration difficulty parameter dr consensus rounds finalized fast exists pending transactions g avoid liveness fault adjust difficulty parameter dr correspondence frequency transactions created network given moment time requires verifiable deterministic mechanism allows nodes independently compute approximation total load network adjust interval span newly finalized consensus round propose novel method estimate network load factor logarithmically composited produce sufficient dr dynamically attunes network prevent liveness faults 2 5 approximating network load recall parent selection algorithm denoted section 2 1 denote honest nodes n1 n2 consider nodes n1 n2 entire network n nodes individually creating gossiping nearly f transactions second assuming n1 n2 given time t similarly composited graphs g resultant gossiping creation arbitrary transactions n1 n2 point time t comprise similarly selected sets parent transactions denote time interval xe2 x88 x86 strictly nodes n1 n2 creating gossiping 2f transactions second maximum number transactions coexist newly created graph depths transactions created nodes n1 n2 time interval xe2 x88 x86 2 inductively conjecture 2 2 network load phenomenon denote time interval xe2 x88 x86 honest nodes creating gossiping nearly transactions second maximum number transactions coexist newly created graph depths constructed time interval xe2 x88 x86 taking advantage phenomenon allows create deterministic verifiable heuristic allows nodes approximate load congestion residing network effectively definition 2 16 network load factor assuming conjecture 2 2 denote ancestor set transaction tx ancestors given transaction tx given consensus round rr r txstart depth txend depth approximate load factor lr depicting congestion nodes network n round r lr txend ancestors txend depth xe2 x88 x92 txstart depth 6 3 x0ctheorem 2 1 adversarial resistance assuming conjecture 2 2 denote adversary creates transactions arbitrary depths depth interval represented consensus round rr impossible adversary load factor lr decrease increase 1 single valid transaction parents arbitrarily chosen proof creation arbitrary transaction tx xe2 x80 x99 adversary increase height graph g 1 increase number transactions depth tx xe2 x80 x99 depth graph g 1 tx xe2 x80 x99 depth xe2 x89 xa4 txend depth case txend ancestors txend depth trivially increase exactly 1 leaves case allowing arbitrary increments lr result widening graph g recall parent selection algorithm definition 2 1 honest node build transactions reference parents leaf nodes follow case given network honest node adversary honest node build transactions reference transactions adversary follow case impossible load factor lr increase 1 single transaction cases allowing arbitrary decrement lr 2 6 adjusting difficulty recall condition marks transaction critical definition 2 14 trivially linearly adjusting value system parameter dr exponentially increases decreases frequency critical transaction created probability critical transaction created given bit length transactions seed h 2d1 r dr xe2 x89 xa4 h linearly adjust frequency critical transaction created logarithmically scale load factor lr system parameters min difficulty difficulty scale dr min difficulty difficulty scale xe2 x88 x97 log2 lr 4 logarithmically scaling lr allows linear amendments frequency critical transaction created given dr xe2 x80 x99s growth rate inversely proportional 2d1 r figure ideal fixed values min difficulty difficulty scale recall lower communication latency network larger networks maximum load capacity point time denote ideal network environment exists zero communication latency attune parameters optimization methodology environment th protocol exhibits5 minimal liveness faults newly derived parameter set allow network exists zero communication latency follow protocol minimal liveness faults parameters safely applied execution protocol practical network settings exists non zero communication latency practical networks comparison ideal zero latency network incapable exhibiting load zero latency network parameters properly attuned protocol execute worst case scenario environment 3 design definition 3 1 wavelet wavelet family consensus protocols individual variants wavelet denoted tuple w poverlay pgossip pquery practical step consider wavelet variant w pgossip s kademlia overlay network protocol 1 pgossip barebones gossiping protocol nodes spread information peers recorded individually maintained kademlia routing tables pquery snowball consensus protocol 12 7 x0c3 1 s kademlia choice s kademlia overlay network protocol formation de bruijn networking topology allows messages efficiently sent designated recipient o log n hops n number nodes network s kademlia xe2 x80 x99s static dynamic cryptographic puzzles enforce node identities uniformly dispersed enforces node xe2 x80 x99s individually maintained kademlia routing tables uniformly partitioned allow communication honest subset network persist spite adversarial model defined definition 1 1 dropping redirecting delaying delivery messages given uniformity node identities simple gossiping protocol additionally constructed s kademlia nodes simply gossip information neighbors inscribed individual routing tables assuming users aware honest bootstrapping node new users easily join membership network 3 2 snowball snowball consensus protocol inspired snowball sampling technique 7 guarantees strong safety liveness partially synchronous network exists adversary behavior defined definition 1 1 lemma 3 1 strong liveness snowball loop eventually terminate given set n processors t resilient t tolerable number faults individual processor handle single case termination snowball loop successfully sample color consecutively k peers xce xb2 number times given assumption 1 3rd processors faulty reformulate rigidness snowball xe2 x80 x99s liveness following denote random variable x arbitrary discrete distribution sample space comprises elements r b colors probabilities comprise zero measure prove infinitely sampling x eventually yield sequence xce xb2 exact element proof assume impossible snowball loop terminate given network n nodes t resilient recall results infinite monkey theorem 8 given infinite sequence infinite strings character string chosen uniformly random given finite string surely occurs prefix strings relax assumption characters sampled x follow uniform distribution long probability measures non zero sampling event independent based converse result second borel cantelli lemma 3 poses contradiction surely true infinitely sampling x yield string xce xb2 length comprises exact element assuming communication network partially synchronous case snowball loop eventually terminate lemma 3 2 strong safety termination snowball loop n processors guaranteed agree value preferred color c proof following lemma 3 1 assume preferred color c consistent nodes trivially preferred color c termination snowball loop maximum count colors poses contradiction case preferred color c consistent nodes following lemmas 3 1 3 2 case snowball able achieve binary consensus strong safety liveness partially synchronous network n nodes 8 x0cwe emphasize results lemma 3 1 prove snowball achieves strong liveness small practical number iterations denoted adversarial model nonetheless given snowball inherently sampling mechanism wide variety strategies bootstrapped snowball converge consensus small finite number iterations examples strategies include weighing node xe2 x80 x99s response based staking virtual currency detailed alongside dynamically attuning xce xb1 parameter presence adversaries 11 3 3 proof stake nodes stake amounts virtual currency order variably garner weight assisting settlement consensus round strategy trivially resistant safety faults stake independent node consistent rounds having mechanism place establishes resilience sybil eclipse attacks protocol denote discrete random variable rk xe2 x88 xbc b k p model responses randomly sampled peer k peers set k success probabilities p discrete random variable sk model distribution stakes k peers network given product distribution r0 sk rk declare sampling color successful e r0 xe2 x89 xa5 xce xb1 occur 3 4 transaction fees rewards node weight assisting settlement consensus round known validator naturally attracts attention honest adversarial nodes compensation circumstances fees deducted accepted transaction settled consensus round dispersed validators assisted development consensus round numerous problems arise rightfully match validators efforts settlement consensus round reward address issue incentive system devised rewards validators based stake activity appending new transactions graph g references ancestries possible verifiably random voting scheme illustrate system works denote transaction tx finalized 1 let eligible tx xe2 x80 x99 sender 6 tx sender tx xe2 x80 x99 xe2 x88 x88 tx ancestors eligible 0 terminate procedure 2 let validators tx xe2 x80 x99 sender tx xe2 x80 x99 xe2 x88 x88 eligible concatenate hash tx xe2 x80 x99 id tx xe2 x80 x99 xe2 x88 x88 eligible h construct checksum acts entropy source e 3 let x 0 threshold value 16 bits e denote random variable x models weighted uniform distribution set candidate validators select validator v xe2 x88 x88 validators weight x xe2 x89 xa5 x 0 transaction fee reward recipient 4 transfer transaction fees tx sender intended reward recipient v system incentivizes validators actively create broadcast new transactions large selection ancestries graph g non trivially system suffer stake problem given effort attain rewards requires validator assist validation large exponentially growing amounts transactions reward distribution scheme combined s kademlia overlay protocol poverlay naturally defers rich gets richer poor gets poorer dilemma favorably network topology discriminate peers interact high stake validators 9 x0c4 discussions discuss key concerns consider proposed protocol design described section 3 assuming communication network partially synchronous theorem 4 1 fork resilience consider nodes fork diverge nodes xe2 x80 x99 view contents round ri finalized point time equivalent given honest nodes n1 n2 network tolerable number adversarial nodes impossible nodes n1 n2 fork proof recall results theorem 2 1 honest nodes build transactions refrain referencing parent transactions intentionally increases number transactions depth d critical transaction proposed honest nodes end round ri reference parent transactions created honest nodes widen graph g converse critical transactions proposed adversarial nodes end round ri accepted honest nodes impossible adversarial nodes build transactions forking graphs g maintained honest nodes referenced ancestry ending transaction round ri consider fork resiliency activity honest nodes assume n1 n2 xe2 x80 x99s graphs g equivalent proposes critical transaction end round ri denote node propose critical transaction end round ri n10 node n20 recall definition 2 15 n10 fail reconstruct merkle root critical transaction proposed node n20 given non equivalent graphs n10 n20 xe2 x80 x99s graphs g similar n10 vote n20 xe2 x80 x99s proposed critical transaction end round ri snowball consensus protocol nodes fork require violation safety property snowball consensus protocol possible contents round ri diverge honest nodes given creation received transactions arbitrary nodes impossible nodes n1 n2 network tolerable number adversarial nodes fork consequence results theorem 4 1 possible virtuous transactions honest nodes finalized round created result transactions rejected signed submitted network newly picked parent transactions cumbersome left future work describing solution protocol resilient issue network wide incentives construction graph g expense virtual currency computational resources viable approaches tackling issue 5 results wavelet variant w described section 3 establishes following guarantees partially synchronous network definition 5 1 total ordering transactions nodes individually maintained graphs finalize apply set accepted transactions exact order definition 5 2 transaction irreversibility transactions depths equal finalized consensus rounds ending points depth marked accepted finalized acceptance finalization revoked protocol guarantees lend wavelet variant w interesting prospects features definition 5 3 succinct finalized transactions safely pruned finalized transactions irreversible protocol given payment transaction order bytes 10 x0centire graph transactions node maintains stored entirely memory allows fullyverifying wavelet node run hardware simply minimum 512mb dynamic memory spare smartphone definition 5 4 global scale liveness faults occur protocol naturally adjusts system parameters account load network prevent liveness faults occurring benchmarks report 5 second windowed moving average 31 240 transactions finalized second network comprised 240 nodes nodes utilize consumer grade hardware 2vcpus 4gb ram deployed kubernetes cluster digitalocean average communication latency 220 milliseconds alongside 2% packet loss simulated linux tool tc 1 individual node restricted hoist single wavelet instance contained kubernetes pod exert outbound traffic rate 890kb s wavelet instance contains snowball instance finalizing rounds parameterized k 10 xce xb1 0 8 xce xb2 150 cryptographic signature verification performed individual incoming transaction wavelet instance parameterized system parameters depth diff 10 max num parents 32 min difficulty 8 difficulty scale 0 5 benchmark task nodes create flood network batch transactions individually comprised 40 individual stake placement transactions consider latencies individual node faces maintaining state s running wavelet statistics collected warm period 25 minutes taken consideration benchmarks run network communication latency negligible sole purposes hosting private blockchain wavelet able sustain finalizing average 180 000 transactions second benchmark task definition 5 5 smart contracts given ordering application transactions consistent nodes turing complete smart contracts safely supported deterministically executed step webassembly smart contracts supported deterministic software emulated floating point deterministic control flow graph based gas counting invocation smart contract function snapshot memory interpreter stored memory invocation smart contract function difference post invocation interpreter xe2 x80 x99s memory pre invocation interpreter xe2 x80 x99s memory snapshot persisted ledger definition 5 6 proof stake recall snowball consensus protocol pquery proof stake mechanism denoted section 3 3 convolving rk sk weighs progress eventual termination pquery stakes virtual currency allowing wavelet variant w naturally establish sybil resilience definition 5 7 fair incentives recall reward distribution scheme denoted section 3 4 protocol naturally requires validators effort assisting settlement consensus rounds prevent stake problem defers rich gets richer poor gets poorer dilemma occurring definition 5 8 decentralized governance protocol forms network topology wealth evenly distributed nodes encourage decentralized form governance guaranteed irreversibility history allows establishment protocol wide events incremental protocol updates system parameter tuning 6 conclusion decade passed introduction bitcoin genesis springing forward evergrowing new technologies applications journey amend generalize framework bitcoin sits led authors paper introduce new practical family consensus protocols advance satoshi nakamoto xe2 x80 x99s vision decentralized future wavelet emphasizes minimal configuration minimal resource consumption minimal system requirements prohibit rich benefiting decentralized network emphasis allow large diversity decentralized applications built adopted explored 11 x0ca small set conjectures introduced reader paper exploration easily lends development promising exciting new mathematical toolings frameworks problem development general purpose ledger framework addressed trivial time node states s grow far large making disk space bottleneck authors like conclude solution problem thought introduced forthcoming paper titled perlin acknowledgements authors like acknowledge satoshi nakamoto work bitcoin heavily impacting authors lives early early 2000s authors like acknowledge dimitris papadopolous foteini baldimtsi josh lind valuable comments feedback references 1 ingmar baumgart sebastian mies s kademlia practicable approach secure key based routing 2007 international conference parallel distributed systems pages 1 xe2 x80 x938 ieee 2007 2 ethan buchman tendermint byzantine fault tolerance age blockchains phd thesis 2016 3 kai lai chung paul erdo xcc x88s application borel cantelli lemma transactions american mathematical society 72 1 179 xe2 x80 x93186 1952 4 pierre jacques courtois frans heymans david lorge parnas concurrent control readers writers communications acm 14 10 667 xe2 x80 x93668 1971 5 cynthia dwork nancy lynch larry stockmeyer consensus presence partial synchrony journal acm jacm 35 2 288 xe2 x80 x93323 1988 6 yossi gilad rotem hemo silvio micali georgios vlachos nickolai zeldovich algorand scaling byzantine agreements cryptocurrencies proceedings 26th symposium operating systems principles pages 51 xe2 x80 x9368 acm 2017 7 leo goodman snowball sampling annals mathematical statistics pages 148 xe2 x80 x93170 1961 8 richard isaac pleasures probability springer science business media 2013 9 dan larimer delegated proof stake consensus 2018 10 satoshi nakamoto et al bitcoin peer peer electronic cash system 2008 11 serguei popov fast probabilistic consensus byzantine setting 2019 12 team rocket snowflake avalanche novel metastable consensus protocol family cryptocurrencies 2018 12 x0c