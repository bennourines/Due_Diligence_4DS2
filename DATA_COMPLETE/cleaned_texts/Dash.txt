whitepaper nathan marley edited page 23 aug 2018 11 revisions dash payments focused cryptocurrency evan duffield evan dash org daniel diaz daniel dash org abstract cryptocurrency based bitcoin work satoshi nakamoto improvements tier incentivized network known masternode network included improvements privatesend increasing fungibility instantsend allows instant transaction confirmation centralized authority 1 introduction bitcoin 1 cryptocurrency emerged popular medium exchange digital currency attracted substantial number users 2 inception 2009 bitcoin rapidly growing mainstream adoption merchant usage 3 main issue acceptance bitcoin point sale pos situations time required wait network confirm transaction valid payment processors created methods allow vendors zero confirmation transactions solutions utilize trusted counterparty mediate transaction outside protocol bitcoin provides pseudonymous transactions public ledger relationship sender receiver provides permanent record transactions taken place network 5 bitcoin widely known academic circles provide low level privacy limitation people entrust financial history blockchain dash cryptocurrency based work satoshi nakamoto built privacy functions paper propose series improvements bitcoin resulting decentralized strongly anonymous cryptocurrency tamper proof instant transactions secondary peer peer p2p network incentivized provide services dash network 2 masternode network nodes servers running p2p network allow peers use receive updates events network nodes utilize significant amounts traffic resources incur substantial cost result steady decrease nodes observed time bitcoin network 7 result block propagation times upwards 40 seconds 14 solutions proposed new reward scheme microsoft research 4 bitnodes incentive program 6 figure 1 bitcoin nodes spring 2014 figure 1 bitcoin nodes spring 2014 nodes important health network provide clients ability synchronize facilitate quick propagation messages network propose adding secondary network known dash masternode network nodes high availability provide required level service network order masternode reward program 2 1 masternode reward program cost payments reason decrease nodes bitcoin network lack incentive run time cost running node increases network gets creating bandwidth costing operator money cost rises operators consolidate services cheaper run run light client help network masternodes nodes like bitcoin network provide level service network bond collateral participate collateral forfeit safe masternode operating permits masternode operators provide service network earn payment services reduce volatility currency run masternode operator demonstrate control 1 000 dash active masternodes provide services clients network return receive regular payment block reward like miners masternodes paid block reward 45% dedicated program fact masternode rewards program fixed percentage masternode network nodes fluctuating expected masternode rewards vary according current total count active masternodes payments standard day running masternode calculated following formula n t rba n number masternodes operator controls t total number masternodes r current block reward presently averaging 3 3 dash b blocks average day dash network usually 576 average masternode payment 45% average block reward cost associated running masternode creates hard soft limit active nodes network currently 8 2 million dash circulation 8 200 nodes possibly running network soft limit imposed price costs acquire node limited liquidity exchanges usage dash currency merely investment 2 2 deterministic ordering special deterministic algorithm create pseudo random ordering masternodes hash proof work block security functionality provided mining network pseudocode selecting masternode mastenode masternodes current score masternode calculatescore current score best score best score current score winning node masternode cmasternode calculatescore pow hash getproofofworkhash nblockheight hash block pow hash hash hash pow hash hash pow hash increase entropy difference abs pow hash hash masternode vin return difference example code extended provide rankings masternodes second fourth masternode list selected 2 3 trustless quorums currently dash network 4 800 active masternodes 8 requiring 1 000dash collateral active masternode create system control entire network masternodes example wanted control 50% masternode network buy 4 800 000 dash open market raise price substantially impossible acquire needed dash addition masternode network collateral requirements use secondary network highly sensitive tasks trustless way single entity control outcome selecting n pseudo random masternodes total pool perform task nodes act oracle having network task example implementation trustless quorum instantsend 9 uses quorums approve transactions lock inputs proof service implementation 10 example use trustless quorums include utilizing masternode network decentralized oracle financial markets making secure decentralized contracts possibility example contract apple stock aapl $300 dec 31 2018 pay public key pay public key b 2 4 roles proof service masternodes provide number extra services network proof concept implementation included privatesend instantsend utilizing proof service require nodes online responding correct block height bad actors run masternodes provide quality service required rest network reduce possibility people system advantage nodes ping rest network ensure remain active work masternode network selecting 2 quorums block quorum checks service quorum b block quorum closest nodes current block hash quorum b furthest nodes said hash masternode 1 checks masternode b rank 2300 masternode 2 checks masternode b rank 2299 masternode 3 checks masternode b rank 2298 work check network prove nodes active masternode network approximately 1% network checked block results entire network checked times day order system trustless select nodes randomly quorum system require minimum violations order deactivate node order trick system attacker need selected times row violations cancelled system nodes selected quorum system attacker controlled masternodes total masternodes required picked times row probability success n t r dash required 1 2300 6 6 75e 21 1 000dash 10 2300 6 6 75e 15 10 000dash 100 2300 6 6 75e 09 100 000dash 500 2300 6 0 01055% 500 000dash 1000 2300 6 0 6755% 1 000 000dash table 1 probability tricking system representing individual masternode failing proof service n total number nodes controlled attacker t total number masternodes network r depth chain selection masternodes pseudo random based quorum system 2 5 masternode protocol masternodes propagated network series protocol extensions including masternode announce message masternode ping message messages needed node active network messages executing proof service request privatesend instantsend masternodes originally formed sending 1 000 dash specific address wallet activate node making capable propagated network secondary private key created signing messages key allows wallet completely locked running standalone mode cold mode possible utilizing secondary private key separate machines primary hot client signs 1 000 dash input including secondary signing private key message soon cold client sees message including secondary key activates masternode allows hot client deactivated client turned leaves possibility attacker gaining access 1 000 dash gaining access masternode activation starting masternode sends masternode announce message network containing message 1k dash input reachable ip address signature signature time 1k dash public key secondary public key donation public key donation percentage 15 minutes ping message sent proving node alive message 1k dash input signature secondary key signature time stop time live expired network remove inactive node network causing node clients paid nodes ping network constantly ports open eventually flagged inactive paid 2 6 propagation masternode list new clients entering dash network aware currently active masternodes network able utilize services soon join mesh network command sent peers asking known list masternodes cache object clients record masternodes current status clients restart simply load file asking list masternodes 2 7 payments mining enforcement ensure masternode paid fair share block reward network enforce blocks pay correct masternode miner non compliant blocks rejected network cheating incentivized propose strategy masternodes form quorums select winning masternode broadcast message n messages broadcast select target payee consensus formed block question required pay masternode mining network pool software websites merge efforts individual miners use rpc api interface information block pay masternodes interface extended adding secondary payee getblocktemplate pools propagate successfully mined blocks split payment masternode 3 privatesend believe important standard trustless implementation improving privacy users reference client provides high degree privacy clients electrum android ios anonymity layer implemented directly utilize protocol extensions allows users common experience anonymizing funds understood system privatesend improved extended version coinjoin addition core concept coinjoin employ series improvements decentralization strong anonymity chaining approach denominations passive ahead time mixing greatest challenge improving privacy fungibility cryptocurrency way obscure entire blockchain bitcoin based crypto currencies tell outputs unspent commonly called utxo unspent transaction output results public ledger allows user act guarantor integrity transactions bitcoin protocol designed function participation trusted counterparties absence critical auditing capabilities remain readily accessible users public blockchain goal improve privacy fungibility losing key elements believe successful currency having decentralized mixing service currency gain ability currency perfectly fungible fungibility attribute money dictates units currency remain equal receive money currency come history previous users currency users easy way disassociate history keeping coins equal time user able act auditor guarantee financial integrity public ledger compromising privacy improve fungibility integrity public blockchain propose ahead time decentralized trustless mixing strategy effective keeping currency fungible service directly built currency easy use safe average user 3 1 tracing coinjoin amounts common strategy existing bitcoin implementations coinjoin simply merging transactions exposes users methods following users coins joined transaction figure 2 example coinjoin transaction 2 users 11 12 figure 2 example coinjoin transaction 2 users 11 12 transaction 0 05btc sent mixer identify source money simply add values right match values left breaking apart transaction 0 05 0 0499 0 0001 fee 0 10btc 0 0499 0 05940182 0 0001 fee 0 10940182btc gets exponentially difficult users added mixer sessions retroactively de anonymized point future 3 2 linking forward linking proposed implementations coinjoin possible user anonymizes money eventually sends change transaction exchange entity knows users identity breaks anonymity allows entity walk backwards users transactions type attack forward linking figure 3 forward change linking figure 3 forward change linking example alice anonymizes 1 2 btc goes outputs 1 btc 0 2 btc spends 0 7 btc 1 btc output receiving change 0 3 btc 0 3 btc goes identifiable source confirming alice spent 0 7 btc prior transaction identify sender anonymous transaction start exchange transaction backwards blockchain till alice sends 0 7 btc anonymously exchange know user recently bought anonymously breaking anonymity completely type attack change linking figure 4 change linking figure 4 change linking second example alice buys 1 2 btc coinbase anonymizes 1 btc output spends 1 btc receives change 0 3 btc combines 0 2 btc earlier change combining change anonymous transaction 0 3 btc change received coinjoin transaction link entire history completely breaking anonymity 3 3 improved privacy denial service dos resistance privatesend uses fact transaction formed multiple parties multiple parties merge funds way uncoupled given privatesend transactions setup users pay system highly secure theft users coins remain safe currently privatesend mixing requires participants figure 5 users submit denominated funds common transaction users pay form new outputs randomly ordered figure 5 users submit denominated funds common transaction users pay form new outputs randomly ordered improve privacy system propose common denominations 0 1dash 1dash 10dash 100dash mixing session users submit denominations inputs outputs addition denominations fees removed transactions charged bulk separate sporadic unlinkable transactions address possible dos attacks propose users submit transaction collateral pool joining transaction pay high fee miners case user submits request mixing pool provide collateral beginning exchange point user fails cooperate refusing sign example collateral transaction broadcast automatically expensive carry sustained attack privacy network 3 4 passive anonymization funds chaining privatesend limited 1 000dash session requires multiple sessions thoroughly anonymize significant amounts money user experience easy timing attacks difficult privatesend runs passive mode set intervals user s client request join clients masternode entry masternode queue object propagated network detailing denominations user looking anonymize information identify user privatesend session thought independent event increasing anonymity user s funds session limited clients observer chance able follow transaction increase quality anonymity provided chaining approach employed funds sent multiple masternodes depth chain possible users n r 2 9 4 81 8 6561 table 2 users possibly involved n mixing sessions 3 5 security considerations transactions merged masternodes possibly snoop users funds pass considered limitation requirement masternode s hold 1 000dash fact users utilize random masternodes select host joins probability following transaction chaining event calculated follows attacker controlled masternodes total masternodes depth chain probability success n t r dash required 10 1010 2 9 80e 05 10 000dash 10 1010 4 9 60e 09 10 000dash 10 1010 8 9 51e 11 10 000dash 100 1100 2 8 26e 03 100 000dash 100 1100 4 6 83e 05 100 000dash 100 1100 8 4 66e 09 100 000dash 1000 2000 2 25% 1 000 000dash 1000 2000 4 6 25% 1 000 000dash 1000 2000 8 0 39% 1 000 000dash 2000 3000 2 44 4% 2 000 000dash 2000 3000 4 19 75% 2 000 000dash 2000 3000 8 3 90% 2 000 000dash table 3 probability follow privatesend transaction network given attacker controls n nodes n total number nodes controlled attacker t total number masternodes network r depth chain selection masternodes random considering limited supply dash 8 2 million time writing august 2018 low liquidity available market impossibility attain large number masternodes succeed attack extending system blinding masternodes transactions taking place node greatly enhance security system 3 6 masternode blinding relay system section 3 4 describe probabilities following single transaction multiple sessions privatesend mixing addressed blinding masternodes inputs outputs belong users propose simple relay system users use protect identity instead user submitting inputs outputs directly pool pick random masternode network request relays inputs outputs signatures target masternode means masternode receive n sets inputs outputs n sets signatures set belongs users masternode t know belongs 4 instant transactions instantsend utilizing masternode quorums users able send receive instant irreversible transactions quorum formed inputs transaction locked spendable specific transaction transaction lock takes seconds set currently network consensus reached lock masternode network conflicting transactions conflicting blocks rejected matched exact transaction id lock place allow vendors use mobile devices place traditional pos systems real world commerce users quickly settle face face non commercial transactions traditional cash central authority extensive overview feature found instantsend white paper 9 5 additional improvements 5 1 x11 hashing algorithm x11 widely hashing algorithm takes different approach known algorithm chaining x11 consists 11 sha3 contestants 13 hash calculated submitted algorithm chain utilizing multiple algorithms likelihood asic created currency minimal later life cycle life cycle bitcoin mining began hobbyists central processing units cpus currency shortly graphics processing units gpus software created quickly replaced cpus years gpus cycle asics application specific integrated circuits created quickly replaced gpus complexity die size required create asic x11 expect considerably longer bitcoin allowing hobbyists mining longer period time believe highly important good distribution growth cryptocurrency benefit chaining hashing approach high end cpus average return similar gpus gpus reported run 30 50% cooler wattage scrypt algorithm current cryptocurrencies 5 2 mining supply different approach restricting inflation mining taken dash 7% reduction supply year opposed halving implemented currencies addition supply block directly tied miners network miners result lower mining rewards production dash scheduled carry century slowly grinding finally near year 2150 production cease figure 6 mining reward schedule figure 6 mining reward schedule 6 conclusion paper introduces concepts improve design bitcoin resulting improved privacy fungibility average user price volatility quicker message propagation network accomplished utilizing incentivized tier model existing single tier model cryptocurrencies bitcoin utilizing alternative network design possible add types services decentralized mixing coins instant transactions decentralized oracles masternode quorums references peer peer electronic cash system 2008 http eprints qut edu au 69169 1 boyen accepted draft pdf https www cryptocoinsnews com 3 solutions instant bitcoin confirmations http research microsoft com pubs 156072 bitcoin pdf http www0 cs ucl ac uk staff s meiklejohn files imc13 pdf https getaddr bitnodes io nodes incentive https medium com zapchain magazine don t people run bitcoin nodes anymore d4da0b45aae5 https dashninja pl https www dash org wp content uploads 2014 09 instanttx pdf https github com dashpay dash blob master src masternode pos cpp https blockchain info tx 4eb3b2f9fe597d0aef6e43b58bbaa7b8fb727e645fa89f922952f3e57ee6d603 https blockchain info tx 1694122b34c8543d01ad422ce600d59f8d8fde495ac9ddd894edc7139aed7617 http en wikipedia org wiki nist hash function competition finalists http www tik ee ethz ch file 49318d3f56c1d525aabf7fda78b23fc0 p2p2013 041 pdf