b x0cabstract flash implement new delegate based consensus model called flash consensus fc fc retains decentralized spirit cryptocurrency relying elected delegates rapidly reach blockchain consensus ensure security user able use flash coins cast votes delegates delegates vote network matters transaction fees miner selection delegates elect 25 miners create new blocks blockchain pos pow secure chain fc controls ordering block generation rights providing miner specific timeslot block miner creates block chain block serves vote indicating legitimacy new delegate model maintains network security simultaneously enabling high transaction throughput fc algorithm introduces concept called consensus height ch ch refers moment 50% elected miners created block given block chain happens consensus achieved block considered legitimate x0cnetwork entity types types entities flash xe2 x80 x99s new network 1 normal users 2 delegates elected delegates b permanent delegates 3 miners normal users flash address holding flash coin considered normal user purpose discussion like bitcoin chain user identifiers utxo xe2 x80 x99s controlled pseudo anonymous addresses elected delegates delegates elected normal users delegates run election staking minimum 1 000 000 flash providing information including delegate id users use coin control vote delegates office elected delegates vote matters relating flash network delegate places votes weighted based 1 flash xe2 x80 x99ve staked 2 votes xe2 x80 x99ve received 3 long xe2 x80 x99ve office seniority delegates elected period 30 days time votes delegates cast time evaluated 30 days election maximum 151 delegates total sum elected permanent delegates 101 nodes running election elected delegate 101 based criteria elected delegates stake coin begin running election coin remain staked entire election period parties stake coins given delegate staked coins locked entire election period term delegates remove running election cycle time coins remain staked current cycle delegates automatically removed office inactive x0cdelegates receive portion network transaction fees compensation duties permanent delegates 151 delegates 50 permanent delegates require voting elections permanent delegates elected delegates stake minimum 1 000 000 flash vote weight based factors miners compensated requirements difference minimum staking requirement 1 000 000 flash instead 2 000 000 flash required elected delegates permanent delegates run election permanent delegate positions held initially contributed strength flash ecosystem positions transferable permanent delegate stake required minimum 1 000 000 flash inactive maintain position permanent delegate act delegate good standing role transferred meets requirements miners delegates miners signaling wish miner gaining support fellow delegates form votes having staked minimum 2 000 000 flash minimum staking permanent delegates initially set 1 000 000 flash delegates responsible voting high quality trustworthy miners number miners kept low maximum 25 order support high block rates network high transaction throughput larger mining pool efficient flash xe2 x80 x99s limited miner count optimal balance security performance miners receive portion network transaction fees compensation duties x0ctransaction fees network bootstrapping default fee 0 001 flash kilobyte minimum fee 0 33 flash transaction fee rate minimum parameters delegates vote transaction fees collected block miners fees collected day distributed miners delegates staking mechanics order run election create flash address represent node candidate identified address actions signed associated private key enter election candidate use qt wallet create broadcast node xe2 x80 x99s registration form flash stake registrations stakes sent special election address network allow spending return staked coins sender sender xe2 x80 x99s request strict rules enforced acceptance return funds special election address delegates stake minimum 1 000 000 flash register election coin staked higher probability elected influence future votes rewards receive additional stake contributions delegate person time staked funds remain locked entire election campaign subsequent election term s assuming delegate elected voting mechanics transaction opportunity vote delegate prepending zero value transaction output transaction uses op return opcode followed new voting related opcodes data voting related op return tx outputs tx output sender transaction able use op return metadata specify delegates receive transaction xe2 x80 x99s voting power qt wallet managing user xe2 x80 x99s votes easy possible showing coins wallet voting delegates coins voting automatically managing casting votes according configuration specified user voting required transaction encouraged security network method sender sets voting metadata unfortunate effect user experience time person receives flash need send x0cthemselves vote want flash vote different way sender specified qt wallet configured automatically barely noticeable user annoyance generate redundant transactions users send funds recast votes method allows dramatically efficient accounting scaling voting system methods need resend transactions recast votes leveraged combine transactions reduce total utxo set voting delegates matters relating network handled differently user votes delegate votes send transaction special voting address data attached indicating voting vote flash coin need sent vote normal network transaction fees apply delegate xe2 x80 x99s vote come address vote data signed delegate xe2 x80 x99s private key mining mechanics miners elected delegates delegates elected permanent requisite minimum flash staked miner delegates vote miners vote weight derived coin stake user votes seniority spread vote weight miners like 25 miners scored accumulated vote weight ballots elected miners elected miner identified bad actor unreliable node delegates update votes remove bad miner 1 block miners maintain accurate system clock low latency highbandwidth network connection order effectively participate miner system tuned generate block 5 seconds network idle blocks need emitted clock skew block timestamp maximum allowance 4 seconds future block timestamp earlier block miner creates block place delegate id coinbase transaction identification purposes signature prove block reward miners claim block transaction fees claim incentive blocks fast possible block difficulty fixed low value hashpower arms race modern cpu hash block second secure blockchain strict rules enforced control order elected miners allowed create blocks elected miner assigned single 5 second window create block block needed miner x0cthe list gets 5 second window ordered timeslot assignment prevents conflicts block reducing bandwidth processing usually wasted high block rate networks conflicting chains passed evaluated timeslot assignment ensures elected miner fair chance create block assign timeslots miners function similar following javascript function function canitmine minerposition timestamp return timestamp % 25 minerposition list currently elected miners maintained node updated miners voted miner xe2 x80 x99s xe2 x80 x9cposition xe2 x80 x9d index elected miner array corresponds miner miner checking given moment passes position xe2 x80 x9ccanitmine xe2 x80 x9d function current system time unix format node evaluating block correctness acceptance passes position miner mined block function timestamp block block creation asserts creator believes chain blocks true accurate block mined effectively vote miner correct current chain given time consensus height block height consensus achieved 50% elected miners consensus height increases new blocks mined given block b 50% miners elected miner pool created block chain b consensus achieved b transactions block b guaranteed final consensus height b transactions included consensus height considered final transactions consensus height process finalized xe2 x80 x9cconfirmations xe2 x80 x9d longer measurement blocks built given transaction xe2 x80 x99s block instead xe2 x80 x9cconfirmations xe2 x80 x9d measure elected miners mined block transaction xe2 x80 x99s block divided miners needed achieve consensus xe2 x80 x9cconfirmations xe2 x80 x9d effectively percentage consensus given transaction block achieved given transaction t included block b 20 blocks built b 10 unique miners 25 miner pool elected miners t transactions b consensus percentage 10 miners xe2 x80 x99 blocks 25 pool 0 5 50% consensus 0 8 consensus 80 xe2 x80 x98confirmations xe2 x80 x99 x0conce transaction reached exceeded 100 xe2 x80 x9cconfirmations xe2 x80 x9d final risk rolled double spend calculations readouts xe2 x80 x9cconfirmations xe2 x80 x9d capped 100 reduce confusion long attacker able compromise 50% elected miner pool double spending given transaction impossible consensus height reached exceeded transaction xe2 x80 x99s block elected miner pool remains online mining blocks transactions finalized approximately 65 seconds 50% 25 miners 5 second blocks 65 valid transactions included blocks 10 seconds 5 second blocks 2 10 parties involved trustworthy transaction actionable recipient confirmation single miner 5s avg 10s max guaranteed finality dealing untrusted parties recipient wait 100 xe2 x80 x9cconfirmations xe2 x80 x9d 65 seconds comparison pure proof work proof stake systems provide guaranteed transaction finality centralized checkpointing blockchain fork resolution described consensus height ch increases new blocks mined node accepts blockchain fork goes deeper current ch ch effectively dynamic checkpoint voted existence miners competing forks ch fork unique miners xe2 x80 x99participation wins example fork f1 10 blocks long 2 unique miners 10 blocks fork f2 8 blocks long block mined unique miner 8 unique miners f2 wins forks number unique miners participating longer fork wins elected miner evaluating forks miner able new block fork prior comparing forks initial blockchain sync node poisoned malicious peer invalid blockchain rule states reorgs deeper current ch prevent node finding true blockchain happens node need connect node correct blockchain finds true ch node openly connect peer votes delegates counted transaction cast reached 100 confirmations consensus exception miner selection delegate changes vote miners votes counted instantly elected miner pool changed result change applies block x0cnetwork idling earlier years cryptocurrency network long periods zero transaction activity layer 2 adoption grows decrease level chain activity required layer 2 supporting networks order avoid senseless creation useless blocks new flash network supports idling incentives miners blocks fast possible removed nchainwork longer exists network simply stop creating blocks longer need good deal bandwidth index space saved idling keeps blockchain syncing efficient possible order network idle negatively affecting users miners continue mining blocks normal 5 second rate transactions consensus height network idle single transaction broadcasted miners begin mining blocks immediately continue approximately 13 blocks transaction reached consensus miners idle time valid transaction broadcasted miner delegate reward mechanics day start transaction distributes earnings miners delegates earnings derived network transaction fees fees day added split half 50% goes miners 50% goes delegates allocated described 50% delegates allocated based delegate xe2 x80 x99s vote weight time reward tx xe2 x80 x99s creation greater vote weight delegate greater share reward 50% miners allocated equally elected miners foundation rewards millennium foundation pledges donate 32 000 flash miners delegates day form transaction fees automated process send transaction day flash foundation xe2 x80 x99s wallet 32 000 transaction fee donations continue expiration date x0cvoting related opcodes voting system requires sending signed voting metadata blockchain users order maintain backwards compatibility tools built bitcoin metadata sent standard op return bitcoin opcode script zerovalue tx output bitcoin tools parse op return data data stored memory disk flash implements new voting opcodes op return opcode new opcodes tell parser interpret metadata provided list new opcodes xef x81 xac xef x81 xac xef x81 xac xef x81 xac xef x81 xac op reg dg delegate registration information updates op stake dg provide additional stake delegate op vote dg user vote delegate op dg vote delegate vote network related matter op dg sign coinbase tx prove block creator xe2 x80 x99s identity new opcodes zero value txout script immediately op return opcode zero value output txout position 0 transaction txout parsed voting opcodes txout starts op return special election address valid flash address special rules receiving sending transactions coins staked delegates sent address delegate registration information transactions address pay normal network transaction fees know private key address derived network allows coins controlled address returned specified return address original sender stolen receiving rules xef x81 xac tx inputs input return address specified voting metadata xef x81 xac op reg dg given delegateid send 1 000 000 flash address additional stake 100 000 flash xef x81 xac tx output op reg dg operation updating existing delegate x0c xef x81 xac tx outputs second send coins staked special election address output op stake dg operation adding existing delegate xe2 x80 x99s stake op reg dg operation registering new delegate operation specific metadata provided opcode sending rules xef x81 xac spend coins special election address xe2 x80 x99 privkey xef x81 xac transactions received address delegateid staked delegateid currently elected delegate coins staked delegate reclaimed delegate win election completed withdrawal office xef x81 xac tx input spent output address match return address input xe2 x80 x99s corresponding metadata provided output address match original sending address return sender special voting address valid flash address special rules receiving transactions rejects sending transactions delegate casts vote send transaction address vote data pay transaction fee sending tx coin deposited address simply easier account votes monitoring address effectively monitor votes delegates receiving rules xef x81 xac output tx uses op return opcode followed op dg vote opcode data xef x81 xac op dg vote data validate successfully sending rules xef x81 xac transactions sent address spent opcode op dg vote explained later section details relating delegate casts votes votes counted x0celection registration form register election delegate transaction 1 000 000 flash sent special election address op return txout opcode op reg dg includes hex encoded serialized json data like delegatepubkey pubkey infoversion number displayname string enabled boolean mining boolean auditurl url contacts optional type email chat irc url address address type email chat irc url address address website url optional registeredtime int timestamp registration registration json document 4kb encoded example script txout 0 registering delegate op return op reg dg regdata delegatesig delegate update form time simply providing new registration form updated data incremented xe2 x80 x98infoversion xe2 x80 x99 field additional stake required updates form long coin staked delegate meet minimum requirement 1 000 000 flash x0cexplanation fields xef x81 xac delegatepubkey pubkey identifies delegate future actions taken delegate signed pubkey xe2 x80 x99s corresponding private key xef x81 xac infoversion number incremented update delegate xe2 x80 x99s registration form ensure proper state delays tx replication chain reorgs cause older version overwrite newer version xef x81 xac displayname intended human readable string appear user interfaces identifying delegate addition delegateid xef x81 xac enabled set true delegateid eligible election set false elected delegate wishes withdraw duties set false await end current election term reclaim staked coin xef x81 xac mining set true delegate signalling want miner eligible election miner set false delegate eligible delegate elected miner set field false withdraw mining registering potential miner minimum 2 000 000 flash staked xef x81 xac auditurl url exposes delegate xe2 x80 x99s audit interface new api command queried returns information prove node alive measure certain performance characteristics recommended service like memcached hosting url shield node excessive queries auditing explained detail later section document xef x81 xac contacts json array contains list contact objects object specifies type contact address provided address intended provide way community contact owner delegate optional community unlikely vote delegate know xef x81 xac website url linking website represents delegate organization owns delegate optional community unlikely vote delegate know xef x81 xac delegatesig registration form sent address doesn xe2 x80 x99t delegate directly xe2 x80 x98regdata xe2 x80 x99 json object signed private key corresponding delegatepubkey signature placed field registration data received delegateid generated converting delegatepubkey flash address x0cstaking delegates address contribute stake delegate coins staked delegate registered registration include 1 000 000 flash stake registration stake included registration transaction stake contributions provided sending coins special election address op stake dg opcode staking transaction outputs second sending coin staked special election address minimum 100 000 flash output zero value use op return opcode followed op stake dg opcode followed delegateid staked optionally followed return address staked funds return address specified funds returned sender example op return op stake dg delegateid returnaddress noted staked coins able returned delegate staked withdrawn office ended current election term stake coins delegate surrender control long delegate running election serving term s voting delegates normal users vote delegates prepending zero value tx output transaction uses op return opcode followed op vote dg opcode followed list delegateid xe2 x80 x99s vote transaction output votes cast tx xe2 x80 x99s inputs destroyed votes created new tx outputs op vote dg opcode expects simple list delegateid xe2 x80 x99s txout counting txout contains metadata entirety tx output xe2 x80 x99s coin vote delegate described array example op return op vote dg delegateid1 delegateid2 delegateid3 delegateid op vote dg list receives vote txout 1 second delegateid list recieves vote txout 2 txouts delegateid xe2 x80 x99s provided txouts missing corresponding delegateid simply counted vote delegateid provided op vote dg list valid entire transaction rejected x0cvoting delegates delegates vote sending transaction special voting address use address makes easy account delegates vote address special rules described special voting address section transaction casting vote having single tx output uses op return opcode followed op dg vote opcode data describing vote votes described json object passed op dg vote opcode key votedata object represents ballot item value indicates vote value votedata json object maximum size limit 2kb entire votedata object max size limit 100kb given 900m coin supply 1m minimum delegate registration stake 900 delegates running mapdelegatestate variable holds voting information approximately 90mb practice ought order magnitude smaller opcode op dg vote expects arguments op return op dg vote delegateid votedata votesig xe2 x80 x98votesig xe2 x80 x99 argument signature xe2 x80 x98votedata xe2 x80 x99 argument signed private key corresponds delegateid xe2 x80 x98votedata xe2 x80 x99 argument hexencoded serialized json document follows voteheight 12527 mintxfee 30000000 satoshis txfeeperbyte 110 satoshis miners delegateid3 50 50% vote weight delegateid14 25 25% vote weight delegateid31 25 25% vote weight x0cexplanation keys values xef x81 xac key key json object represents ballot item vote cast time tx sent update votedata update considered incremental applied existing votedata delegate overwriting existing values given keys setting key xe2 x80 x99s value xe2 x80 x98null xe2 x80 x99 delete key value withdrawing vote xef x81 xac value value vote cast value 2kb size new values pre existing keys overwrite old value transaction op dg vote opcode json document differs format described violates constraints described considered invalid discarded limitations size vote data prevents dos spam attacks overall structure voting document allows great flexibility future ballot items op dg vote transactions pay byte transaction fee tx network special key xe2 x80 x98voteheight xe2 x80 x99 votedata incremented time delegate updates vote allows network apply vote updates mapdelegatestate correct order delegate attempts provide update voteheight 123 example previously providing update height 122 update 123 rejected second update 123 received rejected different txid claims update 123 included block reorg update 123 reversed second update 123 applied mapdelegatestate data kept sync validated votes blockchain vote accounting indexing voting system carefully designed efficient possible add little overhead blockchain node processing requirements possible order facilitate highest transactions second rate possible addition performance considerations ideal maintain compatibility bitcoin related tools voting system designed maintain backwards compatibility vote cast stake delegate registration performed tx output output position uses op return opcode followed new voting opcode unique flash followed voting metadata bitcoinbased script interpreter parse data following op return opcode flash script parser continue reading script voting opcode immediately op return opcode requiring voting metadata tx output position txout 0 assures efficient lookups discovering old votes x0cdestroyed new tx outputs increases op return script parsing skipping parsing op return data txout 0 position facilitate accounting indexing core code new variables structs created xef x81 xac xe2 x80 x98delegate xe2 x80 x99 class holds information delegate methods polling interacting delegates xef x81 xac xe2 x80 x98mapdelegatestate xe2 x80 x99 delegateid indexed map delegate objects xef x81 xac xe2 x80 x98votestate xe2 x80 x99 struct holds current ruleset result vote derived mapdelegatestate xef x81 xac xe2 x80 x98pendingvote xe2 x80 x99 struct struct contains information vote pending consensus counted attributes include blockheight txid interpreted vote data xef x81 xac xe2 x80 x98mappendingvotes xe2 x80 x99 txid indexed map pendingvote structs accessing pendingvotes txid tx removed chain reorg tx removed map multimap mentioned xef x81 xac xe2 x80 x98mmpendingvotesbyblock xe2 x80 x99 blockheight indexed multimap vectors txid xe2 x80 x99s consensus height updated multimap scanned find pendingvotes fully confirmed votes counted transactions discovered vector counted corresponding txid xe2 x80 x99s removed mappendingvotes vector removed mmpendingvotesbyblock given max coin supply 900m minimum delegate registration stake 1m 900 entries mapdelegatestate variable delegate reclaims stake entry mapdelegatestate deleted receiving valid delegate registration transaction node check new delegateid exists mapdelegatestate add new struct exist receiving valid registration updates node overwrite given delegateid xe2 x80 x99s entry mapdelegatestate new struct new struct higher infoversion number existing entry new block accepted blockchain transaction block checked voting metadata txout 0 present validated noted mappendingvotes mmpendingvotesbyblock votes counted consensus height reached surpassed transaction xe2 x80 x99s blockheight tx x0cinputs outputs votes previously cast inputs subtracted mapdelegatestate votes cast outputs added time consensus height changes happen new block mmpendingvotesbyblock iterated entry blockheight new consensus height processed removed multimap map processing mmpendingvotesbyblock means fetch transaction vector processed parse voting metadata update mapdelegatestate count new votes mapdelegatestate changed processing new consensus height changes votes mapdelegatestate counted global votestate struct updated index current active ruleset future blocks validated updated ruleset way running total maintained votes mapdelegatestate updated consensus height change result vote indexed structvotestate parameters easily efficiently looked note changes delegate xe2 x80 x99s miner vote processed instantly received node changes wait finalization allowing consensus height reach vote xe2 x80 x99s block calculating vote results keys votedata object arbitrary keys utilized default flash network launched keys ignored key votedata use different method determining outcome vote method hardcoded flash governance code explanations voting method votedata keys supported launch xef x81 xac voteheight number incremented time delegate updates vote sequentially ordering vote updates assures updates applied mapdelegatestate correct order xef x81 xac mintxfee minimum transaction fee allowed tx denominated satoshis outcome vote weighted median delegate votes weighted voteweight xef x81 xac txfeeperb tx fee byte transaction size denominated satoshis byte outcome vote weighted median delegate votes weighted voteweight x0c xef x81 xac miners outcome vote array 25 miner delegateid xe2 x80 x99s sorted cumulative voteweight delegate voteweight contribution delegate delegate xe2 x80 x99s total voteweight multiplied percentage delegate gave miner coinbase transaction delegate signatures block mined coinbase transaction 0 inputs similar bitcoinderived cryptocurrencies flash xe2 x80 x99s coinbase transaction zero value txout 0 uses op return op dg sign opcodes follows op return op dg sign delegateid delegatesigofblockhash txout 0 proof given delegateid creator block day coinbase transaction contain additional outputs distribute previous day xe2 x80 x99s rewards miners delegates rewards distributed described xe2 x80 x9cminer delegate reward mechanics xe2 x80 x9d section day progresses tx fees paid fees burned temporarily removed coin supply block day recreates burned coins distributes miners delegates audit interface url new api command called getauditpoint community verify delegate online blockchain sync command takes arguments users choosing delegate s vote list list ought sync state delegate user information inform vote response getauditpoint api follow standard bitcoin api format look like error null result auditpoint delegateid pubkey blockheight chain tip height blockhash chain tip blockhash mempoolsz number timestamp current time x0cdelegatesig base64 signature privkey id 0 api generate fresh signed message node xe2 x80 x99s current timestamp chain tip information delegates currently elected running election need information publicly accessible recommended use separate caching proxy api protect dos spam attacks hide delegate xe2 x80 x99s true ip public desired delegate info interface new api command called getdelegateinfo returns json object revealing information delegate elected running results api command dashboard displays community websites qt wallet command optional argument delegateid specifying delegateid filter results return voting status specified delegate data delegates returned data provided api command xe2 x80 x99s response derived mapdelegatestate variable information information delegates including delegates voting direction influence example error null result delegatecount 326 votescast 235486723 12345678 totalvotespossible 900000000 00000000 totalvoteweight 789437432323 12345678 delegates xe2 x80 x9csojgf3w40fsj9fw92jgfsmbzadqt2 xe2 x80 x9d key delegateid infoversion 123 displayname xe2 x80 x9cthis delegate xe2 x80 x9d enabled true mining true auditurl xe2 x80 x9chttp 1 2 3 4 80 audit xe2 x80 x9d contacts x0ctype xe2 x80 x9cemail xe2 x80 x9d address xe2 x80 x9ccontact delegate1 com xe2 x80 x9d website xe2 x80 x9chttp delegate1 com xe2 x80 x9d registeredtime 1567234635883 lastdgvotetime 164264529832 votesrcvd 1324523 stake 2000000 timeinoffice 1356542 voteweight 5673561 votedata mintxfee 33000000 satoshis txfeeperbyte 100 satoshis byte miners delegateid3 50 50% vote weight delegateid14 25 25% vote weight delegateid31 25 25% vote weight xe2 x80 x9cusgs39sdvnkdpa30sdmop353zvc4 xe2 x80 x9d key delegateid infoversion 234 displayname xe2 x80 x9canother delegate xe2 x80 x9d enabled true mining true auditurl xe2 x80 x9chttp 2 3 4 5 80 audit xe2 x80 x9d contacts type xe2 x80 x9cemail xe2 x80 x9d address xe2 x80 x9ccontact delegate2 com xe2 x80 x9d website xe2 x80 x9chttp delegate2 com xe2 x80 x9d registeredtime 165234635812 lastdgvotetime 164264523825 votesrcvd 526272 stake 1000000 timeinoffice 356548 voteweight 2673564 votedata x0cmintxfee 33000000 satoshis txfeeperbyte 100 satoshis byte miners delegateid4 20 20% vote weight delegateid63 65 65% vote weight delegateid17 15 15% vote weight id 0 vote state interface new api command called getvotestate returns json object revealing current state ballot items accounted structvotestate variable law current block example error null result mintxfee 33000000 txfeeperbyte 100 miners map elected miners delegateid4 true delegateid63 true delegateid17 true id 0 api command structvotestate intended result votes previous block xe2 x80 x99s closing makes results ruleset applied block generated details needed weights delegates getdelegateinfo api command instead x0cvoting user interface qt wallet cli provide interfaces voting wallets configuration parameters set control automated voting coins held wallet interfaces current state wallet xe2 x80 x99s voting power votes cast coins spent held automated voting allow user set threshold level coin wallet voting specified threshold exceeded automation send coin wallet correct voting preference set voting automation default combine transactions output resending self user opted tx combining miner delegate statistics data collected miners delegates published auditurl xe2 x80 x99s monitoring synced delegates miners rapidly sync current chain tip maintain roughly identical mempool tx count auditurl provides signed message showing information delegate miner additional miner statistics collected blockchain analyzing coinbase transaction identify miners participating properly elected miners miss block generation timeslot network idling miner misses high percentage timeslots replaced reliable miner gathering necessary information making accessible users possible community informed decisions delegate miner elections informed decisions lead optimally efficient network x0c