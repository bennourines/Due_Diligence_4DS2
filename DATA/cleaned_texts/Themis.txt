public chain digital asset escrow decentralized paypal whitepaper 2018 03 v3 https themis network 1 overview 1 2 fair exchange digital commerce 4 2 1 transactions different digital currencies 4 2 2 transactions digital currency physical goods 2 3 design objectives themis 6 3 architecture themis 8 3 1 themis blockchain 8 3 2 group escrow service protocol 3 3 disputes settlement 12 3 4 strategy election 13 3 5 security design 14 3 6 typical workflow 3 7 themis wallet 18 4 key technologies 4 1 fair exchange group escrow 20 4 2 anonymous reputation mechanism based verifiable shuffles linkable ring signatures 21 4 3 non interactive zero knowledge proof 23 4 4 digital signature algorithm high concurrency verification ability 5 scenarios 27 5 1 peer peer escrow payments 27 5 2 digital currencies exchange 28 5 3 accounts supervising security escrow 29 5 4 multi agent assets escrow 6 roadmap 32 1 overview blockchain based digital currencies radical importance today s trading activities result number digital currency exchanges founded usage exploding time rise tokenized economy countries japan germany australia accepting cryptocurrency payments huge potential market continue expand globally accept commercialization digital currency figure1 1 trend cryptocurrencies currently digital currency exchanges peer peer transaction providers focus ensuring security transactions pay little attention fairness example htlc hashed time lock contract widely atomic exchange technology vulnerable denial service dos attacks attackers launch dos attacks period time lock counterparty unable obtain refund specific time themis 1 figure1 2 requirements analysis process trading digital currency goods buyers prefer paying seller goods received seller opposite preference mind situation means transaction delivery unable place precise time difficult achieve atomic exchange guaranteed fairness common solution resorting trusted party achieve fairness solution entirely satisfactory previous failures bitcoin exchanges online markets mt gox coincheck attacked hackers decades fair exchange protocols extensively studied recent emergence blockchain takes fair exchange protocols renaissance themis 2 figure 1 3 trusted parties developed themis1 fair exchange system digital currencies based blockchain technology themis provides decentralized digital currency escrow service provide fair exchange services digital currencies digital assets physical goods themis leverages novel group escrow protocol threshold encryption anonymous reputation mechanisms non interactive zero knowledge proof high performance digital signature algorithms order provide atomic exchange guaranteed fairness themis able mitigate dos attacks provide privacy peers themis respected trusted wife zeus s goddess law justice creator guardian order themis 2 fair exchange digital commerce fairly exchanging digital content everyday problem fair exchange scenario commonly involves actors alice bob alice bob wants bob alice wants fair exchange protocol guarantees end obtains s wants digital commerce requirement include fair exchange parties digital currencies subject matter example transactions different digital currencies transactions digital currencies physical goods 2 1 transactions different digital currencies traditionally transactions digital currencies executed cryptocurrency exchanges exchanges achieve creating internal accounts called iou owe accounts mode easy achieve high transaction speed following issues security lack liquidity time lag transactions transaction time lag transaction results arent submitted blockchain timely manner result recorded immediately model decentralised exchanges built address inherent issues centralised exchanges decentralized exchanges based multi signature scheme hashed time lock contract htlc ensure atomic transactions multi signature schemes depends trusted party ttp themis 4 vulnerable collision attacks dos attacks htlc scheme attackers launch dos attacks result users unable refunds given moment 2 2 transactions digital currency physical goods current centralized coin exchanges decentralized coin exchanges focusing transactions digital currencies paying little attention satisfy requirements fair exchanges digital currencies physical goods transaction digital currencies physical goods hard achieve transaction delivery time fairness atomic exchanges face challenge buyer doesn t want pay assurance seller ship purchased goods seller doesn t want ship assurance payment traditionally trusted party required hosting transaction funds arbitration period transaction delivery party needs host buyers transaction funds satisfy fairness common solution party payment 2 3 multi signature scheme buyer seller party holds private key buyer sends money multi signature address party 2 private keys 3 unlock address money things buyer send private key seller seller money dispute arises party mediate resolve dispute send key winning party finish payment refund advantages escrow protocol firstly dispute buyers sellers close transaction consent party secondly party hosted funds party key hosted funds taken 2 keys 3 parties 5 themis protocol faces critical problems firstly collusion attacks hosting party easily contact specific buyer seller collusion escrow protocol meticulously designed secondly dos attacks parties cant hosted funds refuse arbitrating disputes lock hosted funds 2 3 design objectives themis themis decentralized system provides party escrow services dispute resolution services bring fairness exchanges parties digital currencies subject matter technically themis satisfy following requirements figure2 1 objectives themis fairness exchange seller buyer obtain goods digital currencies digital assets physical goods want obtain security parities transfer digital funds period exchange passivity dispute arises need thirdparty themis 6 correctness ensure transactions settlement disputes executed protocol agreed advance dependability mitigate single point failure dos attacks privacy case disputes party cant aware transaction completes related parties aware disputes arise themis 7 3 architecture themis 3 1 themis blockchain themis blockchain aka themischain designed provide party escrow service like role alipay plays online shopping themischain issues token named global escrow token themischain motivates blockchain peers incentive mechanism takes deposit reputation consideration peers active escrow arbitration obtain reward people use escrow services arbitration services provided themischain peers pay gets peers themischain peers participate arbitration earn gets themis makes peer peer fair exchange happen digital currencies digital assets physical assets escrow contract arbitration contract figure3 1 architecture themis themis 8 dposr consensus improve current dpos delegated proof stake algorithm present new consensus algorithm dposr deposit based proof stake reputation dposr consider key factors reputation dispute settling peers deposit peers peer wants act delegate pay deposit advance probability delegate depends deposit reputation deposit mechanism peer wants delegate pay deposit advance peer acts maliciously deposit confiscated themischain delegate rewarded keeping system running means share transaction fee delegates forms positive incentive peer encourages behave system running securely blocks signed delegates turn delegate misses signature offline face risk replaced encourages delegates ensure online time profits escrow peer motivation mechanism escrow peers provide secret shares generated shamir secret sharing protocol correctly reward according deposit paid offline lost secret shares wont reward provide manipulated wrong information secret shares lose rights escrow peers mechanism motivate peers providing correct secret shares keeping online storing shares securely reputation management mechanism hand peers themischain participate dispute resolution arbitration suggestions hand anonymous comments solutions users gave disputes continuously create practical anonymous themis 9 reputation mechanism update value reputation users rapidly privately reputation system collect users feedback arbitration suggestion correctly update reputation value rapidly value affects possibility delegate means higher level reputation value likely delegate common peers motivation mechanism peers equities themis opportunity escrow peers peers named common peers common peers cant participate process escrow transfer equities trusted escrow peers trusted peers verify fee earn transaction pay common peers quota escrow peers got punished common peers related bear loss mechanism ensures owners equities themis chain opportunity receive rewards motivates common peers entrust equities trusted escrow peers way improve stability security themis 3 2 group escrow service protocol protocol alice bob generate 2 2 shared threshold address escrow account address alice private key bob private key $ according thresh key gen protocol parties learn $ shared public key alice bob $ unlock public account alice bob send escrow request blockchain accept response odd mediators alice themis 10 bob interact mediators create shamir secret sharing $ 2 1 mediators 1 secret shares mediators sufficient recover secret $ mediators public key alice bob encrypt $ send generated 78 mediator gives ciphertexts party procedures order prevent fraud behavior use feldman vss2 scheme zero knowledge proof ensure truth shares alice sent bob means shares truly generated shamir secret sharing protocol alice gives bob ciphertext 78 alice additionally includes feldman vss value a8 zeroknowledge proof consistency values bob verify shamir secret share alice alice bob transfer digital currencies hosted address dispute buyer send key seller seller hosted fund keys disputes occur mediators activate arbitration service winning party transfer secret shares received party mediator half mediators work recover losing partys key send winning party winning party keys unlock fund hosted address feldman p practical scheme non interactive verifiable secret sharing 28th annual symposium foundations computer science 1987 pp 427 438 themis 3 3 disputes settlement disputes occurs alice bob refuse send private key party apply dispute settlement themis disputes occur according settlement rules agreed advance themis launch process arbitration arbitration launched participants need pay arbitration fee order reduce cost fair exchange lowest process launched disputes appear generally classify settlements classes generate arbitration result automatically smart contract second arbitrators vote arbitration result way smart contract oracle services automatically obtain external inputs run smart contract code generate arbitration result second way introduce crowdsourced arbitration service based reputation score crowdsourced arbitration crowdsourced arbitration service themis based reputation score help sellers buyers choose reliable arbitrators grading anonymous arbitrators arbitrators rewards blockchain themis uses opening censorship assess arbitrators reputation judgement arbitrators submitted distributed ledger audit anonymously processed themis list information dispute settlements including contract subjects cases judgements reason judgements blockchain distributed ledger technology users rate arbitrators judgements arbitrators reputation scores according judgement behavior behavior abusing power arbitration reflected reputation scores users lower scores lower possibility arbitrator themis 12 reputation management mechanism reputation system themis provide users feedbacks arbitration results reliably surrender personal information users rating details ensure reputation scores cant changed maliciously currently common reputation systems normally rely feedback users assess quality information motivate positive behaviors updating reputation scores algorithm data link reputation scores users long term identities identity linkage enables user tracking appears odds anonymity principle create practical anonymous reputation system update reputation scores huge crowd users rapidly whilst retaining privacy means reputation scheme themis doesnt need link reputation scores users long term identities oracle services oracle necessary mechanism discussing auditing materials transactions essence oracle information publishing real events real world data materials required arbitration determined oracle oracle services offer series ap themis determines arbitration result following procedures calling oracle api oracle centralized reality keys decentralized oracle chain 3 4 strategy election election depositary dposr consensus mechanism node wants right depositary pay deposit advance themis node malicious behavior deposit confiscated themis system nodes vote node depositary themis system select nodes votes computing themis 13 shares nodes system depositaries nodes charge generating blocks turn agreed advance selection mediators according escrow requests users sent themis system use consistent hashing algorithm select odd number nodes 2f 1 mediators selection arbitrators themis system use weighted random algorithm according reputation scores nodes compute odd number 2f 1 nodes arbitrators 3 5 security design scheme face kinds attacking threats dos attack means party denies settling disputes makes hosted funds locked collusion attack mediators arbitrators arbitrator tells alice bob win arbitration parties send secret shares mediators mediators recover 2 private keys hosted funds threat collusion attack dpos threat dpos attacked partners avoid kind attack themis uses theory incentives increase opportunity cost dos attack lead mediators honest civilized motivation market makes system complete escrow arbitration objectively motivation mechanism themis means encourage mediators providing effective services mediators good behaviors increase reputation scores risen recovery themis token mediators bad behaviors lose reputation scores deposit lodge system mechanism increases themis 14 cost bad behavior greatly mediators wont break ecosystem benefits way themis avoid attacks malicious mediators classified mediators 3 groups trusted committee mediators certificated agency mediators common mediators trusted committee mediators reliable downtime mediators maintained trusted organizations mediators guarantee arbitration executed dos attacks certificated agency mediators need transfer deposit themis system advance behaved maliciously deposit confiscated way avoid behaving maliciously avoid second kind attack upgrade 2 2 shared address 3 3 shared address key x c kept alice bob disclosed party mediators launch attacks obtain x x b cant hosted funds kind attack users use themis host funds arbitrate disputes value themis economically viable mediators act maliciously system secure attract users themis services beneficial circle loop themis nodes grow themis powerful 3 6 typical workflow example alice pays bitcoin bob toy giraffe following process fair exchanging themis agreement transaction alice bob require bitcoin escrow address themis 15 alice bob apply escrow request themis including disputes settlement smart contract service charge arbitration bonus themis runs escrow smart contract responds list mediators alice bob alice bob send secret shares mediator separately alice bob send secret shares funds hosting goods delivery alice transfer bitcoins escrow address alice bob party funds bob posts toy alice alice receives toy checking starts confirmation goods sends private key bob bob gets alices key transfer bitcoins escrow address address smart contract themis calculates distributes service charge mediators themis 16 figure 3 2 funds hosting goods delivery disputes settlement alice bob launch arbitration request themis arbitrators determine arbitration result according agreement prior transaction suppose alice wins bob loses alice sends secret shares bob mediators mediators recover key bob shares sends alice alice transfer bitcoins escrow address address keys smart contract themis calculates distributes bonus arbitrators smart contract themis calculates distributes service charge mediators figure 3 3 disputes settlement themis 17 3 7 themis wallet themis provides hierarchical wallet based new generation cryptography named themis wallet provide kind high efficiency low storage usage private keys address management service users achieve interaction themis blockchains automatically easier users use themis services typical use cases themis users need receive payments users frequently example e shops themis handle digital currency transactions need receive payments users transaction ensure privacy need generate addresses transaction store manage addresses related private keys linear dependence number transactions number addresses keys cost wallet system store manage addresses keys number transactions large normally wallets generate new addresses need save corresponding keys key storage area huge security risk visiting key storage area avoid visiting area frequently current wallets usually generate mass keys time save keys key storage area time order reduce frequency visit example bitcoin wallet default setting generate 100 keys addresses time users use way storing keys offline storage suck flash disk mobile hdd print paper store offline addresses generated stored wallet client online addresses wallet generate mass keys addresses themis 18 visit offline storage store keys method reduce frequency visiting key storage area degree idea reducing cost storage management themis wallet hierarchical wallet based new generation cryptography following improvements 1 api themis blockchain supported achieve interaction themis blockchain automatically easier users use themis services 2 generate number addresses users needs space key offline storage users use current offline storage schemes easily paperwallet print keys papers form qr code store keys hardware usb key private keys cryptographic currencies usually standard elliptic curve keys store keys scheme equipment supports elliptic curve digital signature algorithm 3 need users visit key storage area payment means keys absolutely stored offline scheme 4 space public key factor matrix users fixed wont grow number addresses 5 easier users manage addresses addresses generated payment information information doesnt need stored themis 19 4 key technologies 4 1 fair exchange group escrow problem fair exchange mutually distrusting parties jointly exchange digital commodities parties receive partys input fair exchange special case fair party computation parties wish jointly perform function private inputs parties receive output ornothing figure 4 1 fair exchange group escrow informal description fair exchange parties b electron exchanging term ix description dx situation x x b exists verifiable function f makes dx f ix protocol 2 states successful failing b verify state end themis 20 situation asynchronous network honest unit able judge unit b honest received expected electron term ib pay electron term ia conversly honest unit b comes trouble wants pay electron term result expected electron term eventually overcome situation effective solution parties send electron terms trusted party ttp ttp transit terms ttp arbitrate disputes appear themis mainly solved kinds problems firstly transactions line ttp mode online ttp mode models need lots ttps leads quality security ttps widely challenged themis comes optimistic fair exchange protocol ttps participate disputes appear secondly themis comes secure exchange protocol based group escrow avoid single point failure issue denial service issue 4 2 anonymous reputation mechanism based verifiable shuffles linkable ring signatures current motivation mechanism blockchain problems hand cant ensure anonymity observers easily find relation identities votes hand mechanism based digital tokens increase number tokens users ideas reducing number tokens malicious users tokens themis 21 cryptography mechanism restrict system taking users tokens cant reach goal punishing malicious behaviors solve problem reputation mechanism themis based verifiable shuffles linkable ring signatures finish calculation reputation anonymously revealing users identities motivations reward punishment figure4 2 anonymous reputation mechanism based verifiable shuffles linkable ring signatures reputation system themis operates series message feedback rounds beginning round servers maintain database containing clients long term identities respective encrypted reputation scores round servers successively run scheduling protocol based verifiable shuffles transforms reputation list anonymously permuted list consisting time pseudonym client associated plaintext reputation score scheduling protocol decentralized servers clients owner link time pseudonyms reputations long term identities clients post messages anonymously time pseudonyms servers associate messages corresponding reputation scores learning clients sensitive information client provide themis 22 feedback e g votes clients posted messages vote signed linkable ring signature enabling servers verify client votes revealing client submitted vote design enables servers tally positive negative feedback linking feedback long term identities finally servers tally feedback received time pseudonym update reputation score perform reverse scheduling transform time pseudonyms updated reputation scores original long term identities encrypted updated reputation scores 4 3 non interactive zero knowledge proof zero knowledge proof systems cryptographic protocol parties prover verifier birth 1983 amazing theory great influences computer science cryptology executing zero knowledge proof protocol assertion true prover able prove validity assertion verifier verifier verify quickly unable learn information validity assertion assertion false prover unbounded computation power able fool verifier accept false assertion negligible probability assertion like prover secret knowledge zero knowledge proof system specialize zero knowledge proof knowledge zkpok means prover prove verifier truly owns secret knowledge neednt reveal information secret knowledge zkpok interactive noninteractive according prover need interact verifier themis 23 nizkpok minimized round complexity akin communication cost applicable real world themis uses zero knowledge proof protocol solve 3 problems ensure secret shares offered mediators parties transactions group escrow protocol true second verifiable shuffles protocol observers verifiers use zero knowledge proof generated shuffle servers check shuffle servers executed random activities correctly reputation system clients generate zero knowledge proof reputation budget claim 1 actual reputation score lower expected value b 2 use b reputation score distribute messages figure 4 3 non interactive zero knowledge proof themis 24 4 4 digital signature algorithm highconcurrency verification ability transactions public chains calculation ability verification key factor transaction processing speed currently blockchains employ elliptic curve digital signature algorithm nists secp256k1 curve algorithm performs security efficiency poor mainstream cpus calculate 10 000 times second algorithm significant delay number transactions large allied chains private chains usually try avoid challenge involving trusted compute environment method involve complicated secure base difficult support security requirement public chains themis solves challenge involving new dsa algorithm high concurrency verification ability system supports variety digital signature schemes select corresponding scheme according requirements users applications situation needs time signature key select time signature algorithm based hash algorithm ensure high verification performance typical scenarios ensuring 256bits security level select specific elliptic curve verification algorithms time space tradeoff technology improve efficiency dramatically great improvement cpu gpu vector instructions set algorithm advantage transistors calculating ability optimization improved verification performance 2 orders magnitude typical calculation platform themis 25 figure4 4 new generation cryptographic algorithm blockchain themis 26 5 scenarios themis fair exchange system based blockchain technology provides escrow services decentralized digital currencies solves issues fair exchange digital currencies medium fair exchange digital currencies digital assets physical goods scenarios themis peer peer escrow payments exchanges digital currencies supervising accounts security escrow multi subject assets escrow 5 1 peer peer escrow payments themis provide escrow payments decentralized digital currencies peer peer online markets openbazaar possible parties exchange directly themis connect payments system e commerce platforms generate corresponding escrow accounts themis original chains provide decentralized escrow service digital currency transactions transactions buyers need transfer digital currencies escrow account sellers receive money delivery confirmed mechanism solve issue payments able effectively settle time deliveries actual e commerce activities themis provide advance compensation consumers example 7 days confirming receipt 5% sellers fund kept platform account smart contract deposit dispute occurs themis advance compensation buyer deposit themis themis 27 contact seller refund way improve buyers satisfaction sellers reputation figure5 1 peer peer escrow payments 5 2 digital currencies exchange themis fair exchange system based blockchain technology satisfy transactions digital currency physical goods transactions digital currencies provide fair guarantee transactions kinds centralized decentralized digital currencies themis supports otc transactions digital currencies provide secure escrow service cryptographic digital currencies based blockchain bitcoin ethereum generate corresponding escrow accounts themis original chains satisfy requirement digital currencies fair cross chain transactions themis 28 figure5 2 digital currencies exchange 5 3 accounts supervising security escrow escrow service important method traditional financial industry users assets secure example securities dealers need set trust accounts banks opening accounts peer peer lenders need open supervision accounts private equity funds crowdfundings ico investment funds investees investment proportion return investment transparent investors escrows use centralized party escrow mechanism group smart contracts scalacity themis provide api distributed ledger decentralized escrow service digital currency supervision accounts themis solve problems funds security project tracing rationalization distribution effectively digital financial market matures products themis 29 scenarios digital currencies future lenders digital currencies futures digital currencies etf funds digital currencies cross chain transactions digital currencies managed themis system ensure security figure5 3 accounts supervising security escrow 5 4 multi agent assets escrow transactions scf real estate large equipment transaction agents transaction links strong dependencies easy problems morality credibility occur themis host funds deposits initial payments service charges final payments multi subject transactions original chains form digital currency creating smart contracts based multi subject duties conditional instructions transaction comes corresponding link corresponding transaction subject trigger smart contract inputs achieve fair exchange protocol disputes arise dealers use group escrow protocol arbitration mechanism themis launch arbitration request themis 30 member group escrow party arbitrate vote disputes form arbitration result winning party right unlock account themis 31 6 roadmap jun 2017 started design fair exchange protocol based group escrow mechanism dec 2017 finished mvp minimum viable product version mar 2018 internal test decentralized escrow service test run themis otc platform jun 2018 launch themischain test net oct 2018 launch themischain main net themis 32