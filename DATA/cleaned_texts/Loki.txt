b loki private transactions decentralised communication kee jefferys simon harman johnathan ross paul mclean version 3 july 13th 2018 abstract hybrid proof work proof service system offers unique way financially incentivise operation nodes loki leverages incentivised nodes create secondary private routing layer minimum node functionality second layer monitored enforced novel method called swarm flagging loki based modified version monero source code assuring transactions achieve high degree privacy white paper outlines technology loki anticipate changes technology occur loki continues developed new versions white paper released reflect substantial future changes updates 1 introduction demand privacy digital communications transactions increasing user data collected processed traded unprecedented levels users browsing data email contents credit score spending habits gathered sold worlds largest corporations state level actors loki aims provide censorship resistant suite tools allow users transact communicate private bitcoin came promise privacy resulted traceability companies like chainalysis blockseer taken advantage bitcoin xe2 x80 x99s transparent blockchain architecture track follow specific transactions 1 loki built monero cryptocurrency established secure private transaction networks date 2 recognise monero inherent drawbacks monero transactions orders magnitude larger bitcoin transactions significant bandwidth processing disk space requirements network grows results large burden monero node operators offers incentive reward 1 x0ctheir contributions network makes running node costly thankless exercise introduction node reward scheme called service nodes mitigates providing economic incentives node operators service nodes provide range privacy centric functions properly incentivised primarily service node network allow users transmit receive data packets anonymously private communication facilitated service node acting relay novel sybil resistant mixnet having similar properties tor i2p 3 4 furthermore emergent communications network backbone decentralised end end encrypted messaging service called loki messenger allow users communicate directly relying trusted party requirement parties simultaneously online loki resilient medium private exchange platform decentralised anonymous internet services 2 basic parameters loki difficulty target blocktime difficulty algorithm hashing algorithm elliptic curve 3 120 seconds zawy lwma 5 cryptonight heavy curve25519 6 cryptonote elements node incentives scheme implemented cryptocurrency loki uses monero source code high level privacy affords transactions monero evolution cryptonote protocol uses ring signatures stealth addresses ringct giving users ability sign transactions obfuscate amounts maintaining plausible deniability 7 loki ecosystem maintain privacy important provide medium exchange underpins internal economy minimise risk temporal analysis interactions occur loki xe2 x80 x99s independent layers example engaging layer transactional services users lose privacy guarantees receive second layer vice versa 3 1 ring signatures ring signatures work constructing ring possible signers transaction signers actual sender loki makes use ring signatures obfuscate true history transaction outputs ring signatures mandatory loki transactions excluding block reward transactions uniquely fixed ring size enforced loki blockchain means input spend possible outputs including true output 6 3 2 x0c3 2 stealth addresses loki makes use stealth addresses ensure true public key receiver linked transaction time loki transaction sent time stealth address created funds sent address diffie hellman key exchange receiver transaction able calculate private spend key stealth address taking ownership funds having reveal true public address 8 stealth addresses provide protection receivers transactions core privacy feature loki 3 3 ringct ringct proposed monero research lab way obfuscate transaction amounts 9 current deployments ringct use range proofs leverage pedersen commitments prove transaction sent 0 264 range ensures non negative amounts currency sent revealing actual sent transaction recently number cryptocurrencies proposed implementing bulletproofs replacement traditional range proofs ringct significant reduction transaction size 10 loki utilise bulletproofs reducing information nodes required store relay improving scalability 4 service nodes loki implements novel changes cryptonote protocol 7 loki xe2 x80 x99s networking functionality scalability enabled set incentivised nodes called service nodes operate service node operator time locks significant loki provides minimum level bandwidth storage network return services loki service node operators receive portion block reward block resulting network provides market based resistance sybil attacks addressing range problems existing mixnets privacy centric services resistance based supply demand interactions help prevent single actors having large stake loki significant negative impact second layer privacy services loki provides dash theorised sybil attack resistant networks derived cryptoeconomics 11 attacker accumulates loki circulating supply decreases turn applying demand pressure driving price loki continues increasingly costly additional loki purchased making attack prohibitively expensive achieve economic protection loki encourages active suppression circulating supply particular emissions curve collateral requirements designed ensure circulating supply locked reasonable returns provided operators ensure sybil attack resistance 3 x0c4 1 block reward distribution block rewards loki conducted proof work robust wellstudied system creation blocks ordering transactions miners collect write transactions blocks collect fees consensus rule loki block contains multiple reward outputs goes miner mining reward collecting transactions fees 45% block reward awarded miner constructs block service node reward second output block 50% total reward goes service node service nodes relay selected 6 3 service nodes rewarded based time received reward time registered preference nodes waiting longer time service node registers network assumes position queue service node maintains good service ejected queue swarm flag 7 3 slowly migrates higher positions queue nodes near queue eligible reward awarded node drops position queue begins slowly working way governance reward final 5% portion block reward distributed governance operations 9 3 75% sent loki foundations address derived deterministically block remaining 1 25% reserved outputs funding block 9 2 3 4 2 verifiable collateralisation service nodes prove network holding required collateral privacy features inherent loki xe2 x80 x99s design difficult specifically inability audit public address balances use viewkeys outgoing transactions loki makes novel use time locked outputs allow loki coins time locked blockchain reaches defined block height defined height loki network invalidate attempts spend time locked outputs loki utilises process prove held specific service node preventing shuffling collateral register service node operator creates time locked output required unlocks minimum 21 600 blocks elapsed approximately 30 days extra field transaction service node operator includes loki address receive service node rewards address public key service node operations swarm voting wallets avoid service node registration transactions mixins true amounts destination disclosed useful providing extra anonymity transaction node joins service node network nodes individually validate said nodes collateral outlay matches required decreasing collateralisation requirement collateral transactions expire 30 days wallet opt automatic collateralisation feature 4 x0c5 lokinet onion routing protocols allow users form tunnels paths distributed network multiple nodes hops obfuscate destination origin data packets service nodes loki network operate low latency onion routing protocol forming fully decentralised overlay network called lokinet network rely trusted authorities state fully derived blockchain users connect individual service nodes create bidirectional paths packets routed network access internally hosted services called snapps 6 2 users utilise service node exit functionality browse external internet ip address exposed 6 3 5 1 low latency anonymous routing protocol llarp underlying applications service nodes anonymous routing protocol defines way service node communicates peers loki proposes new routing protocol called llarp 12 designed hybrid tor i2p provide additional desirable properties versus existing routing protocol llarp built specifically run loki service nodes network llarp optimisations consider architecture understand goals llarp best conduct analysis existing routing protocols consider llarp improves onion router tor recent years tor popular anonymous mixnet tor network maintains high level censorship resistance proved valuable tool preserving internet privacy tor decentralised network hierarchical tor reliant group directory authorities centralised servers operated group volunteers close tor foundation 13 directory authorities perform main functions firstly act trusted reporters state nodes network tor user relay connects network time connect hard coded directory authorities directory authorities provide user relay file called consensus file provides list relays guard nodes exit nodes currently operation excluding bridges tor network secondly directory authorities measure bandwidth relay provide network use information triage relays categories deciding nodes operate relays guard nodes exit nodes high level centralisation creates points failure leaves tor vulnerable 2014 tor received information credible threat directory authority servers 14 directory authorities united states germany netherlands shut shut directory authority servers result highly unstable tor network new relays greatly diminished ability interact network methods communication tor limited tor allows communication tcp ip tor possible lacks support udp based protocols voip 5 x0cinvisible internet project i2p i2p takes different approach mixnet architecture maintaining higher level trust agility referring distributed hashing table dht ascertain network state instead trusted directory authorities 15 i2p allows tcp udp traffic supporting larger scope protocol interactions i2p steady development process time accumulated technical debt specifically cryptography usage i2p uses 2048 bit elgamal makes encryption decryption slow contrast elliptic curve operations plans migrate away elgamal exist i2p roadmap progress slow additionally i2p lacks formal support exit nodes meaning majority traffic network accessing internally hosted websites called eepsites greatly reduced ability i2p network reach users main purpose anonymising networks access wider internet furthermore manner i2p built means majority users connect network routers problematic resulting network lacks sufficient bandwidth able build fast paths network speeds mixnets bottlenecked capable node circuit result low performance users relays i2p reduction overall performance seen finally i2p differs tor offers packet switched circuit switched network instead establishing single longer term tunnel traffic travels i2p establishes multiple paths packet communicated use use different route network gives i2p ability transparently route network congestion node failures i2p tor fully mitigated sybil attacks sufficiently motivated attacker time capital buy large amounts relays perform temporal analysis undermines user privacy effectiveness analysis increases exit nodes relays guard nodes attacker operates 16 tor i2p operated entirely volunteers donate time money operation nodes surmise network constructed financial incentives altruism achieve greater resilience attacks providing reliable service llarp llarp operates need use directory authorities instead relies dht built blockchain staking transactions allows service nodes act routers network bandwidth monitored recorded dht instead bandwidth measurement triage result swarms 6 1 1 assess node judgement nodes ability provide appropriate bandwidth network open systems interconnection model osi model llarp attempts provide anonymous network layer means supports larger range internet protocols minimises overhead storing file descriptors exit nodes pass user datagram protocol udp traffic 17 additionally llarp opts packetswitched based routing instead tunnel based routing allowing better load balancing redundancy network end users lokinet expected allowed route packets means lokinet exposes lower attack surface sybil attack significant capital outlay required begin service node operation 6 x0c6 loki services similar investment miners hardware service node operator freezes loki coins begin operate service node frozen capital serves purposes 1 service node operator sufficiently large stake success network service node operator provide poor performance network act dishonestly undermine risk devaluing stake network 2 provides opportunity aggressive enforcement network able effectively limit dishonest nodes receiving reward dishonest nodes bear opportunity cost reward loss remaining lockup time collateral points true enforce aggressive punishments poorly behaving nodes 7 3 create groups service nodes queried come consensus state blockchain enforce special chain node behaviour swarms 6 1 1 loki behaviour pertains networking storage activities chain activities combined end user facing applications leverage desirable properties called loki services 6 1 loki messenger loki service developed deployed loki network decentralised end end encrypted private messaging application called loki messenger end end encrypted messaging applications provide platform users send messages revealing contents exist rely centralised servers targeted blocked shut 18 19 centralised service models present high risk anonymity communicating parties require user register phone number identifying information connect directly ip address user information extracted servers data leaks legal processes user leveraging service node architecture loki network deliver service similar popular centralised encrypted messaging apps signal higher degree privacy censorship resistance 6 1 1 messenger routing message routing loki network changes depending receiving user online offline users online higher bandwidth communications place fact messages need stored service nodes loki public key acts long term encryption key routing address simple case key exchanged band ensure protection man middle attack exchange place person secure mode exchange 6 1 2 7 x0conline messaging alice knows bobs public key assumes online tries create path alice querying dht service node obtains introduction set corresponds bobs public key llarp introduction sets list introducers user maintains introducers paths established bobs introducer alice chooses random service nodes act intermediary hops origin destination bobs introducer path established alice bob transmit messages correctly authenticated otr 6 1 2 alice bob communicate maintaining high level privacy lokinet service nodes 2 3 introducer path alice 1 4 bob 3 1 2 figure 1 simplified version online routing alice communicates bob random service nodes establish path network offline messaging alice fails receive response bob initiate offline messaging process offline routing uses modified version postal services swarm pss 20 swarms logical groupings service nodes based public keys hash block staking transaction appeared swarm swarmid consists nodes send message bob alice use public key calculate swarm bob belongs information alice anonymously route message network random service node swarm service node receives unique message destined swarm distribute message nodes swarm nodes additionally required store messages allocated time live ttl 8 3 bob comes online query nodes swarm messages decrypt offline messaging protected spamming small proof work attached message 7 2 8 x0caa b ba cb b bb alice bob b ab ac bd bc figure 2 alice sends message bob bobs assigned swarm b bob comes online queries random node swarm receives alices message 6 1 2 messenger encryption authentication message chain established loki messenger enforces perfect forward secrecy pfs deniable authentication da pfs da key concepts record otr messaging protocol 21 centralised services signal whatsapp use encryption features maintain otr protections loki models otr implementation existing tox protocol distributed peer peer instant messaging protocol uses highly audited nacl library 22 pfs enables resistance attacks long term key exposed new shared encryption key session single session key revealed message chain compromised party wanted break encryption message chain need obtain keys individual session pfs ensures loki messenger extremely difficult compromise compared existing methods pretty good privacy pgp encryption long term key pair required compromise message chain da refers ability parties prove sender new message party ascertain true sender message da message authentication codes macs published session allowing parties plausibly create messages appear originate senders public address correctly implemented impossible party prove sender specific message actual sender user authentication authentication users important ensure protection man middle attacks example bob expecting message alice know public key party eve send message bob pretending alice users authenticate sharing personal information like pidgin otr messaging services loki messenger uses pre shared key psk authentication users multiple options establishment psk establish key band alternatively agree psk loki messenger 9 x0casking question party know answer loki implement psk authentication based modified version pidgin encryption authentication plugin 23 6 2 snapps service node applications function snapps similar called hidden services tor flourished provide users way interact fully mixnet environment providing higher degree anonymity achieved accessing externally hosted content snapps allow users setup host marketplaces forums whistle blowing websites social media internet applications machines servers maintaining server user anonymity greatly expands scope network allows users build meaningful communities lokinet snapp operators use traditional server client model key difference service nodes intermediaries users connection lokinet snapp wishes register network update dht descriptor descriptor contains introducers specific service nodes users contact form path snapp paths set users connect snapp party knowing located network 6 3 exit nodes exit nodes allow users requests wider internet return requests mixnet correctly exit nodes allow users browse internet privately users ip address exposed server operation exit nodes essential loki xe2 x80 x99s extended utility forcing service node operators act exit nodes detrimental acting exit node expose operator legal risks users exit node perform malicious activity whilst proxy exit nodes simply relay traffic internet end user exit nodes receive digital millennium copyright act dmca requests assumed source hacking attempts jurisdictions safe harboring laws protect exit node operators internet service providers carry service node traffic servers fear legal risks cut service exit node startup service node assigned relay flag restricted routing packets lokinet makes requests wider internet operator opt wish exit node demonstrate understanding additional risks submitting additional swarm tests 8 3 1 opting exit node affords operator double reward normal relay selected block reward incentive provided ensure exit node operators sufficient financial incentives operate exit nodes helping protect sybil attacks specifically targeted exit node network vulnerability tor suffers low ratio exit nodes relays 10 x0c6 4 remote nodes given cryptocurrency network storing copy blockchain possible practical users bitcoin ethereum users choose connect public node holds copy blockchain query submit transactions network works bitcoin ethereum nodes efficiently search blockchain transactions users public key target construction cryptonote currencies public nodes called remote nodes stress user connects remote node temporarily download block wallet creation checked block local machine check transaction public transaction key generated users private view key process cause significant performance impact remote nodes considering reward service dissuade users operating syncing services light clients cryptonote mobile wallets unreliable switch remote nodes multiple times establishing reliable connection scan blockchain submit transaction additionally malicious remote node operators running popular nodes record ip address users broadcast specific transactions information actual transaction revealed attack specific ip addresses linked transactions establish link real world identity compromising privacy loki circumvents issues requiring service node act remote node general users service nodes naturally lend work hold copy blockchain form widely distributed network high bandwidth nodes service nodes remote nodes inherent financial limitation remote node network given party data malicious node operator collect 6 5 blink typical blockchain system confirmation time given transaction time takes transaction included block competing miners withheld blocks finney attacks recipients usually require number additional blocks created block holds transaction considered complete 24 depending multitude factors specific blockchain process 10 60 minutes inconvenient merchants customers wait confirmations release goods commence services loki xe2 x80 x99s service node architecture near instant transactions possible blink enables transactions occur loki mainchain confirmed included block assuring sender receiver validity transaction protecting receiver double spend blink works similar fashion dash xe2 x80 x99s instantsend block service node swarm deterministically selected act set witnesses confirm transactions validity lock transaction spent twice instead unspent outputs transaction locked like dash key images locked key images unique keys attached unspent output ring signature provide immediate 11 x0cconfirmations blink gives authority selected swarm signal network key image associated output locked transaction included block double spend unspent output attempted identical key image produced rejected swarm network users ability pay higher fee send blink transaction confirm seconds minutes opens range new use cases loki face face payments increasingly practical online payments easier integrate privacy features inherent loki uncompromised process 7 cryptonote alterations cryptocurrency loki functionally similar fellow cryptonote coins key differences addition service nodes associated functionality comes 7 1 asic resistance application specific integrated circuit asic computer chip built specifically single function context mining asics compute specific hashing algorithms pose risk decentralisation outpace mining methods manufactured specific companies limited distribution channels specialised nature hardware require significant capital costs develop operate profitably potential benefits asics capital cost requirements miners undertake invest algorithm specific hardware makes likely behave manner undermines investment acting dishonestly distribution manufacture asic chips mature hashing algorithms centralised large companies companies refuse shipment certain areas decide regions customers best performing asics structure limited runs manipulate prices prevent asic miners monopolising network hashrate cryptocurrencies developed asic resistant hashing algorithms like scrypt ethash 25 26 recently monero cryptonight hashing algorithm requires large amounts l3 cache operate theory difficult produce asic chip large memory requirements 2018 bitmain released x3 cryptonight specific asic effectively times speed graphics processing unit gpu 27 hashing algorithms suffered similar fates scrypt ethash equihash mined asics combat use asics monero proposed strategy hard forking 3 6 months slightly change cryptonight hashing algorithm fork moving cryptonightv7 28 capital time required build asic significant highly specific hardware designs slight tweaks hashing algorithm invalidate chip design wasting time capital investment asic manufacturers approach introduces issues changes algorithm insufficient prevent asics reprogrammed network vulnerable hashrate centralisation hard fork possible field programmable gate arrays fpgas 12 x0cbe considered asic resistance strategies infrequent slight changes hashing algorithms easily reprogrammed fpgas concern regular changes core consensus mechanisms introduce chance unintended bugs generally centralise development changes core team developers number alternative proof work algorithms proposed combat need hard fork regularly including provably memory hard hashing algorithms like argon2 balloon hash polymorphic hashing algorithms like progpow randprog 29 30 31 32 loki team publishing additional research aforementioned algorithms develop long term solution asic resistance work undertaken loki incorporate version cryptonight called cryptonight heavy maintains asic resistance cryptonight asic miners cryptonight heavy differs cryptonight v7 number ways provides increase scratchpad size 4mb change way implodes explodes handled 33 changes differentiate largest target asic miners monero xe2 x80 x99s cryptonight v7 provide robust protection asic development permanent solution proposed 7 2 dynamic block size like cryptonote coins loki fixed block size instead block size changes time growing include transactions network reaches higher transaction throughput loki block size scales observing median block size 100 blocks slowly retargets maximum size new blocks accordingly long term concern cryptocurrencies large block sizes burden nodes store verify transactions block sizes grow nodes run lower grade hardware unable process propagate new blocks leading centralisation node network commercial interest maintaining nodes concerning distributing blockchain nodes allows state chain confirmed different parties adding validity censorship resistance loki portion block reward given service nodes process propagate blocks nodes service nodes insufficient bandwidth performance dropped service node network 7 3 reward pool self enforces minimum performance requirement incentive structure ensures node count remains high said nodes sufficient performance level successfully share blockchain data network irrespective large blockchain grows demanding bandwidth requirements transaction size optimisations required ensure network scales efficiently service node operating costs high node count sustained long term 13 x0c7 3 ring signature size ring signatures hide real outputs given transaction size ring signature refers mixins construct ring monero currently enforced minimum ring signature size seven mixins alongside real unspent output transaction effect larger ring sizes sparsely studied paper 0001 published monero research lab effect differing ring sizes analysed versus attacker owned large number outputs blockchain 34 found higher ring sizes reduce timeframe malicious attacker owned large number unspent outputs able perform effective analysis transactions mandating larger ring sizes protects theoretical attack known eabe knacc attack 35 party e exchange perform limited temporal analysis transactions users additionally monero maximum ring size enforced network consensus rules wallets like monero gui wallet cap ring size 26 user free manually create transaction ring size wish long ring size seven problematic wallets default ring size seven increasing transactions ring size seven makes stand figure 4 individuals transactions use non standard ring size monero example passive party analyse blockchain infer patterns temporal analysis transaction hash ring size tx size kb 3feaff3f48de0bc4c92ec027236165337b64df404aca098e212c1215e9456697 39d484f7c0a2e8f3823a514056d7cb0bf269171cb4582e05955d4c5ee995cad0 e08f5a937e725011bedd44075334ae98dcca32749da231c56da1278d49c0a231 ab35e69d9cca39219c90df8b2b7aab4a54c82127fb1fbaae65d76357f8f76387 7 7 7 7 10 13 47 13 47 13 50 13 50 13 87 6d8ccd56dc2d3eb7de03ba767f0dbf4d5f42ae91e67f4c28f16d6f8b0229c272 figure 3 xmrchain net monero block explorer showing non standard ring sizes stand loki improves problems statically enforcing ring sizes setting ring size statically setting maximum ring size protects users construct rings mixins setting ring size minimum effectively prevents attacker owns large number outputs discerning true outputs spent ring signature larger ring sizes increase default churning effectiveness non linearly effective ring sizes grow current transaction scheme increasing ring size 10 lead 2 6% increase size transaction bulletproofs implemented account 8 13% increase size transaction overall reduction transaction size caused bulletproofs increasing minimum ring size present problem network lacks architecture support larger sized transactions increased overhead loki burden carried service nodes incentivised operate provide sufficient bandwidth 14 x0c8 8 1 attack prevention ip packet blocking service node network central points failure significant censorship threats face network harvesting attacks deep packet inspection 36 37 harvesting attacks seek gather ip addresses operating service nodes network use isp level firewalls block connections particular addresses type censorship regularly performed tor network china 38 deep packet inspection dpi aims investigate structuring individual packet passes firewall selectively drop block packets appear relate particular service dpi extensively state level actors 39 work design systems evade dpi users leverage types pluggable transports alter signature packet aiming appear normal unblocked traffic ip blocking generally avoided running domain fronting bridges encrypt traffic https requests unblocked services like azure cloudflare reach unblocked service bridge forward request desired location case domain fronting difficult state level actor prevent flow traffic popular bridges causing significant disruption general usage internet governance mechanisms built loki 9 operate domain fronting bridges users access loki services countries large scale internet censorship policies play additionally obfs4 pluggable transport support bundled service node release loki wallet help protect dpi 40 8 2 denial service attacks users decentralised blockchains required provide digital physical identifiers beneficial users lack identity persecuted systems require identification render vulnerable sybil attacks malicious actor produces numerous false identities loki xe2 x80 x99s case numerous public private key pairs uses identities spam network requests cryptocurrencies struggled problem forced implement fee service model proof work model fee service models siacoin users pay services use siacoins case cost determined tb storage month 41 fee service models effective reducing sybil attacks drive users away system especially similar services available free google drive onedrive case siacoin proof work systems hashcash nano require users calculate small proofof work sending message transaction 42 43 small proof work systems arguably egalitarian fee service model fall prey attackers possess large amounts computing power loki proposes modified proof work scheme address largest sybil attack surfaces loki system offline messages path creation offline messages present potential target message stored swarm nodes potential abuse arise malicious user overloads particular swarm high volume 15 x0cmessages store path creation attacks attacker seeks engage path creation process nodes possible taking bandwidth resources denying service users create paths network legitimate purposes prevent attacks loki network requires short proof work attached messages paths created messages proof work calculated blake2b hash message path creation proof work sent request node included path building process ensure scalability accessibility mobile users proof work difficulty requirement fixed based time live ttl message path based global network activity 8 3 swarm flagging nodes operate trustless environment centralised leader enforcing overarching rules maintaining proper node behaviour network difficult service nodes loki hold correct collateral requirement choose route traffic store data memory pools option financially beneficial bandwidth cpu cycles storage system distributed flagging proposed remove underperforming nodes loki distributed flagging faces major implementation issues fundamentally service node financially incentivised flag service node bad actor service node flagged face removal staking pool increase flaggers chance winning reward potential method distributed flagging evidence provided flagging event occurs solution falls prey nodes fabricating evidence favour conversely flagging restrictions allows single nodes groups collaborating nodes intentionally flag honest nodes order improve chances winning block rewards circumvent issues loki proposes swarm flagging swarm flagging works existing swarms 6 1 1 choose members participate testing round service node holds copy blockchain block created miner deterministically select number test swarms block 1% networks swarms selected participation testing swarm calculate participating swarms hash previous blocks seed mersenne twister function selects swarms order position deterministic list testing swarm figure 4 testing swarm selected swarm 9 nodes 16 x0cwhen swarm selected participate node swarm expected conduct number tests node swarm active tests node stores historical information interactions node swarm information bandwidth message storage blockchain requests exit node functionality collected retained time new swarm entrants gather information query service nodes outside immediate swarm gather data service nodes test service node decides vote swarm members decision based aforementioned tests collects broadcasts votes swarm node swarm check votes members single node swarm 50% nodes voting swarm member required information construct deregistration transaction transaction validated included block service nodes update dht purging nodes voted figure 5 dishonest node tested node fails test node comes local understanding nodes failing passing tests 8 3 1 testing suite order allow network self enforce performance standards service nodes equipped required tools test service nodes tests cover scope functionality provided service nodes prevent lazy masternode attacks 44 initial design fundamental tests proposed tests added test suite function services nodes expands operator runs service node software file predetermined size allocated disk ensure space present tasks require storage simple bandwidth test conducted service node geographically distributed set testing servers run loki foundation checks optional service nodes allowed skip ignore fail join pool untrusted service nodes running passing tests provides good indicator service node operator risk locking collateral node meet minimum requirements service node joins untrusted service node pool collateral locked tested chosen swarm swarm tests enforced consensus new entrants service node network evade 17 x0ctests node passes swarm tests awarded trusted node flag begin routing packets failing removed network collateral remains locked 30 days bandwidth test bandwidth test forms backbone loki network test suite node passes test assumed honestly routing packets minimum threshold time node interacts service node retain record incoming bandwidth provided time nodes included thousands paths route millions messages interactions form basis nodes bandwidth tables table node respond bandwidth tests service nodes inside swarm nodes expected respond queries bandwidth tables nodes means nodes recently joined network query wider network information specific node swarm message storage test message storage essential offline messaging functionality users loki messenger service nodes tested ability cache messages serve users course message xe2 x80 x99s time live ttl users sending offline messages randomly select service node destination users swarm node distribute copy message rest swarm depending proof work attached header message service nodes receive copy store data ttl ttl original message reaches finality distributing node sends nonce members swarm swarm uses nonce adding message hashing result finally sending distributing node test ensures service nodes hold messages ttl finality face eviction unable produce correct message digest sampling distributing node random time service node able collect performance data swarm peers blockchain storage test service nodes expected hold copy loki blockchain holding copy blockchain service nodes perform number tasks essential users network including acting remote node validating transactions locking transactions blink honest nodes hold copy blockchain dishonest node avoid holding copy simply requesting blocks honest node tested avoid outcome blockchain storage test designed honest nodes hold copy blockchain pass test dishonest nodes achieve testing node requests tested node selection k random transactions history blockchain concatenated hashed hash returned testing node measuring latency request testing node compare latency expected return time t exact value t set accurately differentiate expected latency loading disk downloading blocks network attacker infeasible download hash k blocks t piggybacking attacks difficult 18 x0cexit node test service nodes opt act exit nodes receive additional rewards functional tests required ensure extra reward abused functional exit testing occur service node able emulate natural search behaviour human service node detect tested respond tests discard legitimate user requests emulating natural page request behaviour difficult exit tests designed way overhead sorting legitimate requests tests sufficiently difficult difference bandwidth cost running legitimate node malicious node negligible service nodes use list search engines held locally combined dictionary construct pseudorandom natural search terms search terms fed search engines web pages randomly chosen results service node build path random nodes acting relays node tested exit node exit service node requests webpage result generated pseudorandom search result returned exit node matches result generated service node exit node deemed passed test 9 governance funding voting governance essential cryptocurrency design supported protocol level risk weak informally defined governance studied extensively history blockchain technology bitcoin ethereum experienced contentious hard forks split focus efforts respective communities hard forks governance strategy considered resort solution contentious issue loki governance system designed resolve potential issues providing structured environment discourse representation source funding development loki reliance external influence altruism prevention hard forks governance structures create means internally fund new projects improve loki ecosystem internally funding projects prevent formation special interest groups necessarily motives line users miners service nodes seen bitcoin bitcoin forks formation profit companies blockstream bitcoin abc bitcoin unlimited frequently accused hiring developers protocol specific changes bitcoin bitcoin cash aimed business objectives follow specific ideology reason loki block 5% reward allocated purpose network governance provides steady flow loki distributed community projects software developers integration teams 5% block reward 3 75% controlled loki foundation 1 25% controlled service nodes loki funding system encourages fair representation service nodes allows community funding proposals occur outside direct control loki foundation 19 x0c9 1 loki foundation loki foundation registered non profit organisation based australia central legal entity exists allow loki project operate defined legal framework working project legal protections obligations loki foundation incorporated australia 2018 uses constitution example provided australian charities profits commission acnc 45 constitution gives foundation corporate governance structure non profit organisations company shareholders beneficiaries governing board members seats term limits conduct actions voting resolutions forward fellow members loki foundation structured achieve registered charity status australia organisation constitutionally bound spend income including governance block reward furthering project aligned initiatives externally audited organisation transparency critical maintaining registered charity status loki foundation receives assure general public loki foundation remains honest keeps spending reasonable bounds loki foundation accountable community auditors system ultimately fail serve loki surrounding projects hard protections exist hard fork network consensus arise exists opportunity remove replace loki foundation recipient block reward 9 2 loki funding system loki foundation diverse group individuals represent loki project foundation subject governing constitution laws australia prove limiting factor range decisions foundation loki funding system allows portion block reward acted purely vote service nodes service nodes represent entities world beholden input loki project team foundation allows reach new level autonomy decisions service nodes staked participants network financially incentivised decisions grow value loki 9 2 1 proposals proposal service nodes published loki blockchain given party wants present proposal service nodes party construct proposal transaction proposal transactions contents readable outputs burned forgo privacy features typical loki transactions funding blocks created 43 000 blocks approximately 60 days proposal leaders submit proposals time period considered closer submit beginning proposal phase time gain votes service node attached transaction extra field contains information service node needs understand vote proposal information includes 20 x0cproposal title url linking detailed explanation proposal loki proposal seeking payment address escrow agent chosen pending agreement loki foundation users proposals elect loki foundation party act escrow agent releasing funds milestones reached additionally encourage high standard proposals prevent spamming transactions proposal transaction burn non trivial loki 9 2 2 voting service node carries specific key voting key exported utilized vote behalf service node having login server hosted voting occur chain service node signals support dissent abstinence active proposal blockchain service nodes vote proposals soon committed blockchain bimonthly funding block shortly creation funding block swarm chosen collect tally votes cast tally submitted nodes mempool lives miner reaches funding block information construct block allocates reward winning proposals proposals passed result yes votes minus votes equal 15% node count service node network 9 2 3 funds distribution proceeds loki funding system paid funding blocks funding block rewards operate similarly traditional block rewards entirely non custodial way distribute loki 43 000 blocks approximately 60 days funding block constructed miners block contains 1 25% overall block reward entire funding block period construct valid funding block miners able assess proposals reached required percentage votes information service nodes commit blockchain contains addresses paid state votes service nodes validate miners funding block discard funding blocks pay invalid addresses sum loki required approved proposals exceed fall total built 60 day period total sum approved proposals exceed available funding block miner construct funding block prioritising proposals committed blockchain earlier remaining approved proposals remain committed blockchain funding block 21 x0cfunding block reward change rollover proposals funded change figure 6 funds left unused create change grows reward funding block 10 conclusion loki proposes model anonymous transactions decentralised communication built network economically incentivised nodes loki uses foundations cryptonote protocol ensure privacy implements collateralised node system enhance network resilience functionality additionally loki proposes improvements previous research open source projects presents new anonymous routing protocol offers significant advantages existing protocols combination unique architecture protocol design creates network market based sybil resistance decreasing efficacy temporal analysis providing users high degree digital privacy 22 x0creferences 1 mike orcutt criminals thought bitcoin perfect hiding place thought wrong september 11 2017 https www technologyreview com s 608763 criminals thought bitcoin perfect hiding place thought wrong 2 monero https getmonero org 3 tor project https www torproject org 4 i2p anonymous network https geti2p net en 5 lwma difficulty algorithm https github com zawy12 difficulty algorithms issues 3 6 daniel j bernstein peter birkner marc joye tanja lange christiane peters twisted edwards curves 2008 https eprint iacr org 2008 013 pdf 7 nicolas van saberhagen cryptonote v 2 0 2013 https cryptonote org whitepaper pdf 8 whitfield diffie martin e hellman new directions cryptography ieee trans information theory 22 1976 6 644 xe2 x80 x93654 mr0437208 9 shen noether adam mackenzie monero core team ring confidential transactions 2016 https lab getmonero org pubs mrl 0005 pdf 10 benedikt bu xcc x88nz jonathan bootle dan boneh andrew poelstra pieter wuille greg maxwell bulletproofs short proofs confidential transactions 2017 https eprint iacr org 2017 1066 pdf 11 evan duffield daniel diaz dash privacy centric crypto currency https github com dashpay dash wiki whitepaper 12 github loki project loki network https github com loki project loki network 13 tor project docs https www torproject org docs faq keymanagement 14 possible upcoming attempts disable tor network xe2 x80 x94 tor blog december 19 2014 https blog torproject org possible upcoming attempts disable tor network 15 petar maymounkov david mazie xcc x80res kademlia peer peer information system based xor metric https pdos csail mit edu petar papers maymounkov kademlia lncs pdf 16 philipp winter roya ensafi karsten loesing nick feamster identifying characterizing sybils tor network february 25 2016 https arxiv org abs 1602 07787 17 osi model wikipedia https en wikipedia org wiki osi model 18 farid farid signal eqypt blocks encrypted messaging app continues cyber crackdown december 26 2016 https techcrunch com 2016 12 26 1431709 19 matt burgess russia xe2 x80 x99s telegram block tests putin xe2 x80 x99s ability control web april 24 2018 http www wired co uk article russia google telegram ban blocks ip address 20 ethereum postal services swarm https github com ethersphere ethereum blob ddfc0a2a02ce574f4c252068ce81f0f5ada1c1ff swarm pss readme md 21 nikita borisov ian goldberg eric brewer record communication use pgp proceedings 2004 acm workshop privacy electronic society 2004 pp 77 xe2 x80 x9384 doi 10 1145 1029179 1029200 22 nacl networking cryptography library https nacl cr yp 23 pidgin encryption sourceforge http pidgin encrypt sourceforge net 24 irreversible transactions bitcoin wiki irreversible transactions march 15 2018 https en bitcoin wiki 25 scrypt litecoin wiki litecoin info february 12 2018 https litecoin info index php scrypt 26 ethash ethereum wiki wiki github https github com ethereum wiki wiki ethash 27 bitmain https shop bitmain com product detail pid 00020180314213415366s4au3xw306a4 23 x0c 28 monero cryptonight v7 github https github com monero project monero pull 3253 files e136bc6b8a480426f7565b721ca2ccf75547af62 29 alex biryukov daniel dinu dmitry khovratovich argon2 memory hard function password hashing applications december 26 2015 https password hashing net argon2 specs pdf 30 dan boneh henry corrigan gibbs stuart schechter balloon hashing memory hard function providing provable protection sequential attacks 2017 https eprint iacr org 2016 027 pdf 31 github programmatic proof work ethash https github com ifdefelse progpow 32 github hyc randprog randomly generate c javascript program https github com hyc randprog 33 github curie kief cryptonote heavy design cryptonote heavy deign essay https github com curie kief cryptonote heavy design 34 surae noether sarang noether adam mackenzie note chain reactions traceability cryptonote 2 0 2014 https lab getmonero org pubs mrl 0001 pdf 35 github comment eabe knacc attack https github com monero project monero issues 1673 issuecomment 312968452 36 i2p xe2 x80 x99s threat model i2p https geti2p net en docs threat model harvesting 37 deep packet inspection tec gov http tec gov pdf studypaper white%20paper%20on% 20dpi pdf 38 philipp winter stefan lindskog china blocking tor 2012 https arxiv org abs 1204 0447 39 egypt quietly blocks voip services skype whatsapp torguard october 26 2015 https torguard net blog egypt quietly blocks voip services skype whatsapp 40 github yawning obfs4 obfourscator development mirror https github com yawning obfs4 41 david vorick luke champine sia simple decentralized storage 2014 https sia tech whitepaper pdf 42 adam hashcash denial service counter measure 2002 http www hashcash org papers hashcash pdf 43 colin lemahieu raiblocks feeless distributed cryptocurrency network https raiblocks net media raiblocks whitepaper english pdf 44 lazy masternodes actually work paid vote https www reddit com r dashpay comments 5t6kvc lazy masternodes actually 45 acnc template constitution charitable company https acnc gov au cmdownload aspx contentkey 2efea0fa af4f 4231 88af 5cffc11df8b7 contentitemkey 6046cbc5 d7fd 4b6b 93ba c8e3114b07ba 24 x0c