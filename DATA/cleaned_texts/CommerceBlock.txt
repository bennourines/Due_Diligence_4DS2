b mainstay enabling trustless immutability federated sidechains tom trevethan nicholas gregory nikos kostoulas commerceblock tom commerceblock com abstract present mainstay system method enables sidechains employing federated consensus algorithms cryptographically bind immutable proof work mainchain way impossible sidechain fork simultaneously forking mainchain underlying construction method requires changes existing proof work system e g bitcoin space efficient censorship resistant use homomorphic commitments based pay contract protocol addition method implemented multisignature scheme maintain consistency security guarantees byzantine fault tolerance federated consensus protocols enable realisation highly efficient scalable interoperable sidechain systems incorporate advanced smart contracting privacy features simultaneously exploiting security immutability bitcoin blockchain secured proof work introduction invention bitcoin solved issue double spending fully decentralised digital payments system ensuring single replicated global ledger participants agree represents valid ordering transactions blockchain reaching consensus state global ledger achieved proof work adding blockchain requires expensive easily verifiable computations rewarded tokens derived transaction fees block rewards blockchain accumulated work considered valid history participants incentivised contribute computational work extending 1 use proof work 2 requires consumption real world resources e energy consensus mechanism means bitcoin completely permissionless permission required order add blockchain computational work 1 x0cwork required extend blockchain leads immutability attempt modify time order transactions blockchain requires computational power rest network combined 3 leads bitcoin blockchain unique global system consensus ordering time stamped events need trusted authority cryptocurrency projects launched bitcoin remains far secure accumulated work bitcoin network operated persistently 9 years holding hundreds billions dollars value resisted constant attack properties come cost scalability upgradability order maintain decentralisation security censorship resistance network block sizes remain relatively small limits transaction capacity 4 bitcoin process 3 6 transactions second leading unpredictable transaction fees confirmation times 5 addition reasons bitcoin secure difficult change protocol adding new features requires consent network participants extremely conservatively risk integrity system alternative consensus mechanisms separate blockchains improve scalability build advanced features protocol level 6 sidechains bitcoin secured federated consensus rules enable significantly better scalability faster regular block times 7 addition systems incorporate protocol level functionality including native smart contracts asset issuance cryptographic privacy anonymity features possible bitcoin 8 systems able achieve trustless immutability bitcoin permissionless proof work blockchains run static federated consensus mechanism require collective trust federation members federation members collude leak threshold secret keys conflicting forks blockchain created cost double spend attacks launched token holders 8 provide federated sidechains level trustless immutability bitcoin describe method involves cryptographically binding sidechains bitcoin mainchain way sidechain forked simultaneously forking bitcoin mainchain means fixed set federated block signers users sidechain need trust federation protect double spend attack consensus single unforked version federated sidechain enforced bitcoin xe2 x80 x99s proof work protocol mainstay employs underlying concept staychain linked transactions bitcoin mainchain transactions staychain enforced conform single output preventing branching possibility alternate staychain histories anchoring staychain transaction id genesis block sidechain committing state sidechain regular intervals staychain impossible roll write state sidechain rolling staychain effectively impossible bitcoin xe2 x80 x99s global proof x0cof work sidechain nodes validate commitments resulting immutability staychain lightweight spv1 proofs bitcoin nodes sidechain block committed bitcoin staychain block reinforced immutable bitcoin block depth minimise encumbrance mainstay bitcoin blockchain prevent potential miner censorship transactions containing op return outputs employ homomorphic commitment scheme based xe2 x80 x98pay contract xe2 x80 x99 bip175 protocol 9 approach commitments sidechain embedded single transaction output address staychain indistinguishable normal bitcoin payment transactions designed scheme compatible multisig p2sh2 single public key p2pkh addresses additional hosted data required order verify validity mainstay remainder paper organized follows section describes current state art relation blockchain attestation timestamping sections following describes proposed scheme starting core principles specifying details implementation federated consensus protocol attestation time stamping recognised early bitcoin xe2 x80 x99s history blockchain utilised timestamp arbitrary data completely trustless decentralised way 10 embedding cryptographic commitment piece data valid transaction mined blockchain possible prove data existed particular time 11 simplest implementation idea commitment cryptographic hash data directly payment address un spendable approach led unspendable addresses remaining utxo set indefinitely unnecessarily burdening fully validating nodes accomodate time stamping meta protocols efficient way new prunable transaction output type introduced new op code op return 12 allowed 40 80 bytes included output treated spendable output utxo3 set use op return significant downsides bloats transactions resulting higher transaction fees offers privacy data included plain text directly transaction transactions including rejected censored mining pools services employ op return outputs time stamp data bitcoin blockchain eternitywall 13 proof existence 14 blocknotary 15 protocols include extensive set data single commitment opentimestamps collects submitted commitments 1 simplified payment verification lightweight transaction confirmation protocol requiring block headers backed proof work 2 pay script hash 3 unspent transaction output x0ccalendar server compresses merkle tree time stamps merkle root transaction factom protocol time stamps state factom system including merkle roots transaction data bitcoin blockchain regular intervals value proposition 17 type time stamping fundamentally limited type immutability provide timestamp prove particular piece information existed certain point time information validity provenance timestamp prove commitment conflicting data simultaneously timestamped critical concept relation immutability proof existence act proof e g alternative ordering transactions exist figure 1 illustration conflicting forked sidechain blocks simultaneously attesting mainchain illustrate point consider sidechain alt chain state e chain tip block header periodically time stamped bitcoin blockchain lead immutability sidechain alternative conflicting states e forks time stamped simultaneously fig 1 property immutability ensure sidechain state linked specific commitment bitcoin mainchain trusted mechanism authority effectively operating sidechain responsible defining sequence timestamps correspond un forked sidechain relies integrity commitment mechanism multiple versions sidechain created multiple simultaneous timestamped commitments bitcoin execute double spend attack collusion block signing federation commitment authority x0cthe mainstay protocol designed eliminate requirement type trusted commitment mechanism provide cryptographic proof sidechain immutability initiating fan transaction staychain bitcoin blockchain uniquely committed genesis block sidechain described section protocol employ op return outputs providing additional privacy censorship resistance efficiency mainstay protocol aim mainstay protocol restrict sequence periodic commitments state sidechain un forkable staychain transactions bitcoin uniquely identify staychain linking directly sidechain define staychain sequence linked transactions single output transactions input fan maintaining single outputs means sequence commitments possible given initial transaction fig 2 unique transaction output represents single use seal 18 security proposition sidechain depends integrity mainstay mechanism propagating staychain robust immune attack staychain fails propagate corrupted e g having multiple outputs sidechain lose guarantee immutability describe mechanisms ensure integrity case federated sidechain consensus model section 3 1 following general description protocol assume single mainstay key signing entity protocol presented relation bitcoin proof work mainchain principle compatible pow blockchain figure 2 schematic fan chain linked transactions enforcing single outputs possible sequence transactions possible x0cinitialisation initial step protocol creation base transaction bitcoin performed initialisation sidechain 1 signing entity e generates secret key sk0 corresponding base public key pk0 sk0 xc3 x97 g xc3 x97g denotes multiplication generator point secp256k1 elliptic curve 19 4 public key create base address addr0 2 funds paid p2pkh5 base address entity e related party wallet bitcoin blockchain 1 transactions cover initial transaction fees 3 entity e creates transaction base transaction paying funds potentially consisting output addr0 single output p2pkh 4 transaction broadcast network confirmed6 bitcoin blockchain acquires unique transaction id pointer start staychain t xid0 transaction scriptsig contains base public key pk0 point sidechain initialised linked bitcoin staychain pointer t xid0 embedded directly genesis block sidechain defined location 4 private keys bitcoin 256 bit integers modulo order secp256k1 elliptic curve public keys x y coordinates curve 512 bit numbers 5 pay public key hash bitcoin output type payment 160 bit hash public key address 6 transaction id modified malicious party affecting validity transaction malleability confirmations blocks required txid considered final x0cfigure 3 schematic mainstay protocol dashed lines represent homomorphic commitments attestation frequency bitcoin attestations determined entity e sidechain generate blocks frequently attest bitcoin block average 10 minutes process attestation occur follows 1 interval j initially j 1 e retrieve sidechain best block hash hjb 2 base public key pk0 modified homomorphic commitment 7 elliptic curve point corresponding hjb pk0j pk0 hjb xc3 x97 g 3 entity e creates bitcoin transaction input spending single output t xidj xe2 x88 x921 initially base transaction t xid0 j 1 paying single p2pkh output address derived pk0j addrj 4 transaction signed corresponding private key t xidj xe2 x88 x921 output address addrj xe2 x88 x921 public key pk0j xe2 x88 x921 determined integer addition modulo order secp256k1 curve sk0j xe2 x88 x921 sk0 hj xe2 x88 x921 b j 1 sk00 sk0 private key validity result homomorphic properties elliptic curve point multiplication 20 x01 pk0j pk0 hjb xc3 x97 g sk0 xc3 x97 g hjb xc3 x97 g sk0 hjb xc3 x97 g 5 valid transaction broadcast bitcoin network confirmed block referenced transaction id t xidj mainstay confirmation block generated sidechain mainstay commitment known reinforced immutability guarantees confirmed bitcoin block client user confirm status sidechain block requires lightweight spv proofs 7 addition elliptic curve points x0cboth bitcoin sidechain nodes additional information included sidechain bitcoin blockchains required validate mainstay reinforcements8 confirmation functions follows 1 base transaction id t xid0 retrieved sidechain genesis block 2 t xid0 located mainchain bitcoin blockchain base public key pk0 retrieved scriptsig 3 staychain tracked9 unspent tip t xidt located confirming component transaction consists single output10 t xid0 xe2 x86 x92 t xid1 xe2 x86 x92 t xid2 xe2 x86 x92 t xid3 xe2 x86 x92 xe2 x86 x92 t xidt 4 single output p2pkh address t xidt retrieved addrt 5 starting tip recent confirmed block sidechain block height w block hash hw b addrt checked determine incorporates homomorphic commitment hw b addr pk0 hw b xc3 x97 g addrt 6 true sidechain block height decremented w xe2 x86 x90 w xe2 x88 x92 1 check repeated 7 evaluated true block w sidechain confirmed reinforced protocol need followed initial sync mainstay connected node staychain tip transaction t xidt located additional attestations confirmed monitoring t xidt removed bitcoin utxo set new tip t xidt 1 included recent bitcoin block staychain fees maintain persistent operation staychain continually funded pay mainchain bitcoin mining fees staychain funded substantial 8 transaction id staychain tip provided client substantially reduce time required verify staychain 9 requires use searching algorithm determines spending txid given output staychain tip txid cached retrieved party staychain verified tip faster 10 confirmations transaction come spv proofs case lightweight client x0camount bitcoin beginning e base transaction stage required xe2 x80 x98top xe2 x80 x99 funding later stage possible breaking immutability staychain required condition immutability output transaction chain staychain bifurcate inputs added additional funding added sighash anyonecanpay inputs base transaction define commitment sequence tip federated sidechains important property mainstay protocol require trust party including entity holding staychain base private key sk0 confirm given sidechain state immutable trust required entity ensure mainstay persistent system continues operate e commitments continue generated key stolen attacker steal bitcoin staychain tip output prevent confirmations remedy sidechain need hard forked reset mainstay e commit new base transaction sidechain sidechains operated federated consensus protocol fixed federation separate entities required cooperate generate new block add blockchain 7 typically implemented m distinct entities threshold n required add signature generate new valid block advantage scalable efficient retains level decentralisation requiring trust single entity case federated sidechain employing mainstay bitcoin operation mainstay achieve security properties guarantees federated block signing protocol case staychain controlled n m multisignature script n signers required cooperate operate mainstay m xe2 x88 x92 n keys lost compromised mainstay function requires modifications protocol described follows initialisation 1 signing node 1 m generates secret key ski corresponding public key pki ski xc3 x97 g 2 signing node publishes public mainstay key pki funds cover initial mining fees paid related entity wallet p2pkh 3 signing nodes cooperate create n m multisig redeem script x0cm total number signing nodes n number signatures required 11 containing m base public keys pki redeem script hashed12 create p2sh address 4 transaction created signing nodes p2sh address single output funded m inputs spending p2pkh outputs created step 2 transaction signed signing node turn corresponding ski turn sighash broadcast bitcoin network 5 confirmed m public keys pki revealed bitcoin blockchain scriptsig transaction inputs publicly verifiable redeem script hash corresponds published n m pki 1 m 6 txid transaction t xid0 retrieved committed genesis block sidechain mainstay attestation 1 attestation interval j initially j 1 mainstay signing nodes retrieve sidechain tip block hash hjb 2 m public keys pki tweaked hjb pkij pki hjb xc3 x97 g 1 m signing node 3 n m signing nodes create transaction spending single output t xidj xe2 x88 x921 paying single p2sh output n m multisig redeem script formed m tweaked public keys pkij 1 m order 4 n m signing nodes verify redeem script hash consists n m pkij 1 m order 5 transaction signed n subset m signing nodes turn private key skij xe2 x88 x921 corresponding tweaked public key pkij xe2 x88 x921 redeem script t xidj xe2 x88 x921 skij xe2 x88 x921 ski hj xe2 x88 x921 1 n b j 1 ski0 ski 6 transaction broadcast bitcoin network validated mined block generating t xidj 11 12 redeem script takes format op n pk1 pk2 pkm op m op checkmultisig hash160 x0cmainstay confirmation 1 base transaction id t xid0 retrieved sidechain genesis block 2 t xid0 located mainchain bitcoin blockchain m base public keys pki 1 m determined base redeem script 3 staychain tracked unspent tip t xidt located confirming consists single output transactions t xid0 xe2 x86 x92 t xid1 xe2 x86 x92 t xid2 xe2 x86 x92 t xid3 xe2 x86 x92 xe2 x86 x92 t xidt 4 t xidt utxo redeem script hash determined htr 5 starting tip best block sidechain block height w block hash hw b htr checked determine generated multisig ordered list base public keys redeem script homomorphic commitments hw b t w hash160 n pk1 hw b xc3 x97 g pkm hb xc3 x97 g m hr 6 true sidechain block height decremented w xe2 x86 x90 w xe2 x88 x92 1 check repeated 7 evaluated true block w sidechain confirmed reinforced conclusion described system enables blockchain sidechain secured federated consensus protocol gain level trustless decentralised immutability bitcoin requiring independent proof work leads advances federated sidechains provide higher transactional throughput lower latency bitcoin advanced tokenization privacy features employing mainstay sidechain retain properties gain unique immutability restricted terms block size time decentralised bitcoin achieve placing minimal burden bitcoin blockchain federated blockchain mainstay bitcoin remain centralised lack censorship resistance bitcoin blockchain advantage situations sidechain particular purpose issuing tokenized assets control transaction permissions desirable 1 nakamoto satoshi bitcoin peer peer electronic cash system 2008 2 hashcash denial service counter measure 2002 x0c 3 rosenfeld meni analysis hashrate based double spending arxiv preprint arxiv 1402 2009 2014 4 decker christian roger wattenhofer information propagation bitcoin network peer peer computing p2p 2013 ieee thirteenth international conference ieee 2013 5 croman kyle et al scaling decentralized blockchains international conference financial cryptography data security springer berlin heidelberg 2016 6 adam et al enabling blockchain innovations pegged sidechains url http www opensciencereview com papers 123 enablingblockchain innovations peggedsidechains 2014 7 dilley johnny et al strong federations interoperable blockchain solution centralized party risks arxiv preprint arxiv 1612 05491 2016 8 poelstra andrew et al confidential assets financial cryptography bitcoin workshop https blockstream com bitcoin17 final41 pdf 2017 9 shibli omar nicholas gregory xe2 x80 x9cbip 175 pay contract protocol xe2 x80 x9d https github com bitcoin bi 0175 mediawiki 2017 10 gipp bela norman meuschke andr xc3 xa9 gernandt decentralized trusted timestamping crypto currency bitcoin arxiv preprint arxiv 1502 04015 2015 11 clark jeremy aleksander essex commitcoin carbon dating commitments bitcoin international conference financial cryptography data security springer berlin heidelberg 2012 12 sward andrew ivy vecna forrest stonedahl data insertion bitcoin xe2 x80 x99s blockchain ledger 3 2018 13 https eternitywall 14 https proofofexistence com 15 https www blocknotary com 16 https github com opentimestamps 17 snow paul et al factom business processes secured immutable audit trails blockchain whitepaper factom november 2014 18 todd peter https petertodd org 2016 commitments single use seals 19 sec secg 2 recommended elliptic curve domain parameters standards efficient cryptography group certicom corp 2000 20 comandini leo xe2 x80 x9csign contract achieve digital notarization zero marginal x0ccost xe2 x80 x9d https github com leocomandini thesis x0c