b cutcoin privacy focused cryptocurrency based pos consensus algorithm cutcoin team july 15 2019 abstract cryptocurrencies known years successfully payments world permanently growing demand leads evolution technologies new coins come advanced functionality paper present cutcoin implemented private cryptocurrency proof stake pos consensus algorithm describe motivation development major features specific details realization different coins tokens xe2 x80 x9dprivate xe2 x80 x9d follow formal definition term introduce statement privacy cutcoin implementation pos protocol including block ordering validation doesn xe2 x80 x99t break important feature protocol block creation time significantly decreased compared pow based coins lowers transaction latency increases overall network throughput introduction establishment 2008 satoshi nakamoto published manifesto xe2 x80 x9dbitcoin peer peer electronic cash system xe2 x80 x9d 1 supposed kick modern cryptography based financial system paper gave short exhaustive recipe relatively simple technologies combined obtain qualitatively new phenomena called xe2 x80 x99bitcoin xe2 x80 x99 cryptocurrency include digital signatures distributed p2p database xe2 x80 x99blockchain xe2 x80 x99 concept xe2 x80 x99consensus xe2 x80 x99 agreement nodes 1 x0cp2p network set rules governance walk privacy aspects different coins consensus algorithms pros cons finally elaborate motivation new coin development privacy comparing fiat currencies bitcoin obvious advantages xe2 x80 x99s trusted party depends fast transparent transaction processing privacy privacy requirement personal reasons xe2 x80 x99s important modern world vast majority payments individuals companies processed electronic form corresponding information transactions involved parties confidential stored accumulated banks authorities financial institutions data attracts attackers globe unauthorised access use fraud fishing etc evolves financial reputational losses 2 3 traditionally financial institutions protect clients xe2 x80 x99 data restricting access informational systems xe2 x80 x99s alternative lies cryptocurrency digital currencies let person transferring funds stay anonymous furthermore guaranty provided algorithmic methods option looks tempting clients companies claim coin token private specifying exactly meant assume order achieve hard privacy 4 digital currency meet conditions anonymity means parties involved transaction don xe2 x80 x99t reveal data help identify ids number participants transferred amounts ii untraceability inability coins funds origin tracing iii unlinkability e 2 transactions issued sender received receiver associated linked observer iv implying iii fund transfers coinbase mining transactions transactions exchanges properties ii iii difficult achieve practice harder formally prove years passed moment 2 x0cwhen bitcoin appeared scene multiple cryptocurrencies developed attempts solve privacy problem different ways different degree comprehensiveness refer bitcoin approach user identifiers public keys k non symmetry key pairs k k k xe2 x88 x97g k scalar product elliptic curve 5 public keys called xe2 x80 x99addresses xe2 x80 x99 origin destination coin transfers instead real life person identifiers observer able funds transfer different public keys k 1 6 secret keys required subscribe transaction transferring funds public addresses traced blockchain payments single account easily linked approach implies list furthermore case person xe2 x80 x99s ip address associated corresponding k anonymity danger reason bitcoin fungible newly minted coins valuable history blockchain techniques overcome bitcoin protocol vulnerabilities centralized decentralized mixing transaction participants different realizations provide different levels privacy xe2 x80 x99s worth noticing built xe2 x80 x99s user xe2 x80 x99s obligation use cryptonote cn family coins monero bytecoin smarter algorithms provide higher level privacy 7 8 cn 5 user sets private public keys k v k v k s k s k v called xe2 x80 x99view key xe2 x80 x99 determine coins addressed specific user k s xe2 x80 x99spend key xe2 x80 x99 required send transaction imagine situation alice willing transfer bob knows public keys address generates time public key k 0 random value r cryptographically secure hash function h v s k 0 h rkb g kb 1 alice uses k 0 receiver address sending addition rg payment transaction bob receives transaction calculate v rg rk v note know k v figure kb b b recipient payment check fit 1 transaction amounts hidden ring confidential transaction technique 5 exact values visible sender 3 x0cand receiver users verify sum input equal sum output amounts xe2 x80 x99s possible special commitment xe2 x80 x99s included transaction sender let verify coins don xe2 x80 x99t appear thin air example conclude users anonymous identifiers coins untraceable ii transactions single address unlinkable iii slightly bigger actions required transaction completed xe2 x80 x93 price users pay privacy monero bytecoin use proof work pow algorithm consensus zerocoin family approach differs lot cryptonote zerocoin actually series extensions zerocash protocol existing bitcoin blockchain independent platform 9 transfer alice sender mint specific zerocoins generating random coin serial number s creates pedersen commitment c s random value r 10 technical point view looks like valid bitcoin transaction containing bitcoins xe2 x80 x99pay xe2 x80 x99 commitment means s revealed knowing r alice adds token c blockchain participant alice creates non interactive zero knowledge proof xcf x80 statements knows commitment c xe2 x88 x88 c1 cn ii knows r c opens s note doesn xe2 x80 x99t reveal exactly commitment knows proof reveals information alice let verify correctness finally alice publishes transaction containing xcf x80 s bob xe2 x80 x99s address destination sender address verification bitcoin equal zerocoin denomination transferred zerocoin escrow pool c1 cn instead sending coins bob alice redeem zerocoin laundry service zerocoin establishes high level privacy transactions chain xe2 x80 x99sender xe2 x86 x92 receiver xe2 x80 x99 addresses untraceable suffers issues peculiar proof work backed currencies conclude mixing sender receiver addresses splitting public private key pairs sets zero knowledge proofs special escrow accounts useful techniques 4 x0cemployed cryptocurrencies provide high level privacy correctness proved mathematical point view effectiveness proved massive practical usage consensus algorithms absence single trusted party definitely strong cryptocurrencies instead trusting somebody participants achieve consensus history operations system don xe2 x80 x99t discuss mechanisms details generally follow analysis 11 cryptocurrencies bitcoin rely proof work pow algorithm node miner wants add new block blockchain need solve difficult resource consuming task creates block publish receives reward network participants receive block accept easily check certain work situation different blocks come different nodes blockchain height alternative versions blockchain appear rule allows solve problem node accepts longest alternative blockchain true version cases rounds adding new blocks nodes select alternatives network requirement xe2 x80 x99work xe2 x80 x99 protects blockchain attackers suppose pow based coin current blockchain height hc attacker wants reorganise blockchain height hr hc need redo work prove blocks hr hc plus block hc shown 1 probability reorganization high case attacker took control 50% network xe2 x80 x99s computational power mining hashrate called xe2 x80 x9951% attack xe2 x80 x99 known cases successfully performed 12 result transactions reversed coins spent times xe2 x80 x99s intrinsic behaviour decentralized pow coins partially result nature chance block proportional computational power weakness pow based coins root high volatility miner xe2 x80 x99s profit strongly depends coin xe2 x80 x99s market price block reward decreases time prices electricity mining equipment thought constant price coin vary goes miners switch computational resources profitable coins 51% attack likely place 5 x0cpronounced bear market 2018 19 bitcoin xe2 x80 x99s coins xe2 x80 x99 market price felt mining close unprofitable miners left area situation block rewards unfair difference computation power common cpu gpu specialized mining device huge ordinary miners find blocks quit mining computational power tend concentrate big pools managed companies making blockchain vulnerable 11 reasons switch pow discussed recent years new consensus algorithms developed 13 14 good candidate substitute pow proof stake algorithm uses stake determine participate creation block stake means commitment participants staker coins create new block pos employs deterministic solution define new block creator chance account chosen depends stake size pos blocks said minted forged mined motivation lots cryptocurrencies claim xe2 x80 x99private xe2 x80 x99 privacy proved cryptographic apparatus conduct transactions monero coin looks solid chose base cutcoin monero miners new blocks expensive equipment following mining algorithm updates spending electricity idea pos consensus algorithm transactions looks promising said cutcoin private cryptocurrency proof stake consensus algorithm challenging problem stake verification preserving privacy time successfully solved provide technical details ii cutcoin description definitions process forging new blocks called staking block bi basic element cutcoin blockchain height regard subject area widely use established monero terminology unspent output output transaction 6 x0cyet input transaction unspent output subscribe forged block called pos output op unspent outputs contain key image 256 bit value validate transaction prevent doublespending output o intrinsic coins pair o pos hash hpi h opi hpi xe2 x88 x921 h keccak 256 hashing function 15 crypto hash hci h bi entire block hash difficulty d proportional total coins currently stake merkle root root hash transactions merkle tree 5 block single pos transaction ptx xe2 x80 x99s special transaction provide participants information required proving block creation correctness block forging process block creation pos systems cases use index numerate blocks j outputs blockchain structure cutcoin blockchain structure similar cn coins 5 blockchain starts block b0 genesis transaction following blocks linked b0 chain figure 1 fragment cutcoin blockchain presented block bi consists header body header contains meta information including pos hash hpi crypto hash hci linked bi xe2 x88 x921 hci f hci xe2 x88 x921 hpi f hpi xe2 x88 x921 2 hci f hpi hpi 6 f hci 3 note pos hash bi doesn xe2 x80 x99t depend content previous block xe2 x80 x99s hp unspent output block signer intentionally designed way malicious users xe2 x80 x99mine transactions xe2 x80 x99 increase chances forge block technical point view user signs bi block wallet generates special kind transaction called xe2 x80 x99pos transaction xe2 x80 x99 contains signer xe2 x80 x99s unspent output persists block transactions participates generation cryptographic block hash 7 x0cfigure 1 fragment cutcoin blockchain structure corresponding chain hashes b changes block lead change cryptographic hash hc 2 causes change hashes hpi i0 require rebuilding blocks following bi resigning signers distributed independent randomly chosen probability reorganization negligible protects cutcoin blockchain double spend attacks transaction seamlessly modified mentioned pos transaction contains unspent output signing block contains daemon traverse blockchain verify pos hash block generated unspent output pos transaction cutcoin pos model cutcoin pos protocol based known reliable nxt proof stake protocol 16 discussed vitalik buterin xe2 x80 x99s papers dedi8 x0ccated pos pros cons 17 main concern consensus algorithms blockchain resistance kind attackers describes major types denial service ii strategies increase chances specific miner blocks iii medium length forks etc feasibility depends prediction th block miner determinism forging process manipulated reasonable solution case introducing randomness choosing account forge block unspent outputs sign blocks pseudorandom values appear result cutcoin transactions choice forging unspent output deterministic person knows unspent outputs cutcoin network previous block pos hash known output forge block easily determined reality user sees outputs thanks privacy protection mechanisms developed monero xe2 x80 x99s means obtain complete information owns outputs currently stake single user xe2 x80 x99s point view outputs sign blocks chosen pseudo deterministically approach provide good resistance different types attacks 19 resolves concerns listed 17 requirement fair distribution rewards e xe2 x80 x9drich richer xe2 x80 x9d 18 randomness choosing output sign block regularised reward strictly proportional funds stake block forged signed single op belonging user stakes receives corresponding reward let xe2 x80 x99s formalize considerations discussed introduce target function minima different time different stakers 1 h xcf x80 xe2 x88 x92 arctg t0 xe2 x88 x92 t 4 xcf x80 2 t o hp stands target value tij oj hpi xe2 x88 x921 target value specific oj hpi xe2 x88 x921 f t o t o ho xe2 x88 x92 atb t t rand o hp 5 tb ks d base target derived current network difficulty ks scaling factor t time block created t0 average time sequential block creations state bi forged staker xe2 x80 x99s output 9 x0cfij t opj 0 xe2 x88 xaa t min tj 6 j 1 n words output provide f 0 equality sign bi block let xe2 x80 x99s extract time dependency 4 h xcf x80 f t t xe2 x88 x92 arctg t0 xe2 x88 x92 t 7 2 linear nonlinear components linear provides stable growth probability block mined nonlinear concentrate probability area t0 figure 3 form provides guarantee point time block definitely created spite pos participants information mush coins currently staked 7 f t op t op xe2 x88 x92 atb f t 8 note probability bi forged grows linearly selected oj lemma 0 fn t 1 kn f t 9 normalized cumulative distribution function cdf block forging normalization coefficient kn 0 xe2 x89 xa4 1 kn f t xe2 x89 xa4 1 figure 3 blue curve x14 x15 dfn t 1 1 t pf t xe2 x88 x92 arctg t0 xe2 x88 x92 t dt kn 2 xcf x80 t0 xe2 x88 x92 t 2 1 10 probability function block bi forged time t block bi xe2 x88 x921 creation figure 3 red curve lemma 1 outputs oj aj equal aj equal probability forge bi assume n outputs oj aj stake don xe2 x80 x99t bother users belong aj const j 1 n think t oj uniformly distributed random value r xe2 x88 x88 z xe2 x88 x80r 0 xe2 x89 xa4 r xe2 x89 xa4 264 statement 4 interpreted oj time point p t 6 satisfied bi forged 10 x0cany output chances create new block bi xe2 x84 xa6i r1 r2 rn 11 aj tb f t const t tp j 1 n 4 th block created provides oij t oij min t oj 12 xe2 x84 xa6 11 events equal probability realization p opij 1 n 13 j 1 n lemma p 2 user u m outputs stake om m 1 m aj m 6 const m 1 m probability forge bi output p opij aj xce xa3 equal probability p forging single output oj aj xce xa3 n j 1 aj sample space t o xe2 x84 xa664 0 1 2 264 t oj d random values correspond outputs held stake users network belong narrower sample space xe2 x84 xa6n r1 r2 rn xe2 x8a x86 xe2 x84 xa664 realization xj rj probabilities realization 1 14 n consider moment time tp bi forged specific aj random value independent t oj 8 time dependant fp const tp reorganize forging condition p x1 p x2 p xn rj 1 r0 rp0 rk k tb fp tb fp 15 k scaling factor depending difficulty network probability realization output network n1 probability user xe2 x80 x99s u block m n probability r0 xe2 x89 xa4 z 0 p r xe2 x89 xa4 pc x dx 16 0 p x constant corresponding range equal 0 p r0 xe2 x89 xa4 apc let xe2 x80 x99s calculate instance p r0 xe2 x89 xa4 a0 a0 2a xe2 x80 x99s obviously 11 x0cp r0 xe2 x89 xa4 a0 2apc 17 probability p r10 xe2 x89 xa4 p r20 xe2 x89 xa4 equal p r10 xe2 x89 xa4 xe2 x88 xaa r20 xe2 x89 xa4 2apc finally 18 p r0 xe2 x89 xa4 a0 p r10 xe2 x89 xa4 xe2 x88 xaa r20 xe2 x89 xa4 19 general case m outputs p r0 xe2 x89 xa4 ma p xe2 x88 xaa r0 xe2 x89 xa4 m 20 lemma 3 output oj aj stake probability forge p bi equal aj xce xa3 xce xa3 n j 1 aj total funds stake network statement proved similarly lemma 2 result simulation presented figure 2 illustrates lemma 3 model cutcoin network 1000 staking unspent outputs enumerated o1 o2 o1000 output different denomination coins unspent output contains grows linearly starting 100 coins o1 maximal 100000 coins o1000 process simulation 1 0e6 blocks forged scatter plot represents times output forge block expected value fluctuates randomness peculiar process overall dependency explicitly linear properties target function allow persons flexibly stake funds guarantee fair distribution rewards proportional stake difficulty function 4 t0 average time bi creation figure 3 probability distribution function maxima area value constant time provide reliability accessibility transactions number users coins stake changes time time xce xa3 6 const t parameter compensate changes value called base target inversely proportional difficulty difficulty evaluated block weighted smoothing 12 x0cfigure 2 number forged blocks single unspent output output xe2 x80 x99s linearly grows figure 3 cumulative probability function f t probability distribution p t block forged pm kdi xe2 x88 x92m k di pmk 1 k 1 kt0 xe2 x88 x92m k 21 form smoothing provides reasonable combination compensating behaviour case t0 starts change rapidly history accumulation use m 90 blocks c presents results simulation cutcoin network behaviour rapid stake growth drops case increase supply stake monitor difficulty changes second decrease network remains 13 x0cstable changes 10 times original value figure 4 simulation block generation process difficulty change rapid stake growth drop b change happens 499 th 500 th blocks realization details forging algorithm single node point view forging mentioned major challenge private pos coin providing mechanism prove forging correctness revealing private information participants cutcoin solved elegant manner suppose person n outputs oj aj j 1 n different amounts aj stake time person xe2 x80 x99s wallet receives message 14 x0cdaemon notification previous block bi xe2 x88 x921 created message wallet receives hpi xe2 x88 x921 use calculate tij oj hpi xe2 x88 x921 output find output provide minimal time tp min tk k 1 n output best try wallet forge bi wallet builds including pos transaction serving purposes let participants prove oj exist blockchain spent blocked ii let participants prove oj aj aj ap sufficient forging bi tp special rule aimed avoid attacks pos hashes chain unspent output oj 800 block confirmations checked pos transaction simple thing transfers aj account zero fee transaction verified node xe2 x80 x99s daemon commitment range proof 4 normal monero transaction exactly input outputs actual dummy artificially generated privacy reasons having zero don xe2 x80 x99t consideration following parts equal x xe2 x88 x97 g ain xe2 x88 x97 h y xe2 x88 x97 g aout xe2 x88 x97 h 22 h hp g ain unspent output aout output x y blinding factors masks pos transaction reveal x xe2 x88 x97 g participant verify unspent output oj ain sign block distribution block creation time probability mentioned 7 nonlinear component cumulative distribution function looks similar normal distribution xe2 x80 x99s x14 x12 x13 x15 1 x xe2 x88 x92 xc2 xb5 xe2 x88 x9a 23 1 erf 2 xcf x83 2 derivative probability function p t looks similar normal distribution reasonable question use 7 normal distribution linear growth factor x14 x15 xe2 x88 x92 t xe2 x88 x92 xc2 xb5 2 p 2 f t o t o h xe2 x88 x92 atb t e 2 xcf x83 24 15 x0cthe answer related specifics realization node network able verify legitimacy block creation correctly identically evaluate forging time 4 hand different hardware platforms different floating point arithmetic realizations reasons house 128 bit fixed point arithmetic library error function 23 represented exponents kind functions rounding errors prone good approximation arctangent fixed point arithmetic chosen cumulative distribution function average block creation time 7 average block creation time easily changed tuning t0 value figure 5 pow consensus algorithms need value big let miners work expensive potential attacker reorganize blockchain opposite pos blockchain sustainability doesn xe2 x80 x99t suffer case relatively small t0 protected random choice unspent outputs sign blocks looks like big advantage lets process transactions time unit decrease blatancies figure 5 simulation block generation process block creation respecting different target times t0 10s t0 60s t0 120s iii conclusion paper presented new private coin based proof stake consensus algorithm pos coins sustainable types attacks 16 x0cand provide larger functionality traditional pow ones proposed randomisation mechanism choice block miner achieved randomness regularised probability proportional account xe2 x80 x99s balance means block rewards fair distribution users advantage possibility xe2 x80 x99fast forging xe2 x80 x99 means block generation time tens seconds instead minutes tens minutes typical pow algorithms proposed pos algorithm elements randomness choose block forger protect blockchain types attacks including 51% attack typical pow consensus algorithms system successfully implemented available users cutcoin expect future cutcoin network enable applications services run common layer privacy references 1 satoshi nakamoto 2008 bitcoin peer peer electronic cash system 2 nikki fiorentino kelly dwyer alex hamilton karen barney megan dwoskin eugenia buggs laurel laluk 2018 impact cybersecurity incidents financial institutions https www idtheftcenter org 3 threat analysis www mwrinfosecurity com assets swiftwhitepaper mwr swift payment systems v2 pdf 4 mina deng kim wuyts riccardo scandariato bart preneel wouter joosen 2011 privacy threat analysis framework supporting elicitation fulfillment privacy requirements requirements engineering 6 1 pp 3 32 5 kurt m alonso 2018 zero monero 6 wai wuv brett falk 2018 limitations privacy guarantees cryptocurrency 7 nicolas van saberhagen 2013 cryptonote v 2 0 8 daniel genkin dimitrios papadopoulos charalampos papamanthou 2018 privacy decentralized cryptocurrencies communications acm vol 61 6 pages 78 88 17 x0c 9 ian miers christina garman matthew green aviel d rubin 2013 zerocoin anonymous distributed e cash bitcoin conference paper 10 alex vazquez 2019 zeroct improving zerocoin confidential transactions 11 earls j missing explanation proof stake version 3 2017 http earlz net view 2017 07 27 1904 missing explanation ofproof stake version 12 congcong ye guoqiang li hongming cai yonggen gu akira fukuda analysis security blockchain case study 51% attack detecting 2018 5th international conference dependable systems applications dsa 13 giang truong nguyen kyungbaek kim 2018 survey consensus algorithms blockchai jips volume 14 1 page 101 128 14 peter urban andre schiper 2004 comparing distributed consensus algorithms 15 guido bertoni joan daemen micha el peeters gilles van assche 2008 keccak specifications 16 nxt white paper https nxtwiki org wiki whitepaper nxt 17 https vitalik files randomness html 18 giulia fanti leonid kogan sewoong oh kathleen ruan pramod viswanath gerui wang 2018 compounding wealth proof ofstake cryptocurrencies 19 serguei popov 2016 probabilistic analysis nxt forging algorithm 18 x0c