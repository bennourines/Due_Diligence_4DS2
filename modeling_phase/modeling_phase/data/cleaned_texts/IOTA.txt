b tangle serguei popov xe2 x88 x97 april 30 2018 version 1 4 3 abstract paper analyze mathematical foundations iota cryptocurrency internet things iot industry main feature novel cryptocurrency tangle directed acyclic graph dag storing transactions tangle naturally succeeds blockchain evolutionary step offers features required establish machineto machine micropayment system essential contribution paper family markov chain monte carlo mcmc algorithms algorithms select attachment sites tangle transaction arrived 1 introduction description system rise success bitcoin years proved blockchain technology real world value technology number drawbacks prevent generic platform cryptocurrencies globe notable drawback concept transaction fee transactions value importance micropayments increase rapidly developing iot industry paying fee larger value transferred logical furthermore easy rid fees blockchain infrastructure serve incentive creators blocks leads issue existing cryptocurrency technology heterogeneous nature system distinct types participants system issue transactions approve transactions design system creates unavoidable discrimination participants turn creates xe2 x88 x97 k mthcl author xe2 x80 x99s contact information serguei popov iota org 1 x0cconflicts elements spend resources conflict resolution aforementioned issues justify search solutions essentially different blockchain technology basis bitcoin cryptocurrencies paper discuss innovative approach incorporate blockchain technology approach currently implemented cryptocurrency called iota 1 designed specifically iot industry purpose paper focus general features tangle discuss problems arise attempts rid blockchain maintain distributed ledger concrete implementation iota protocol discussed general tangle based cryptocurrency works following way instead global blockchain dag tangle transactions issued nodes constitute site set tangle graph ledger storing transactions edge set tangle obtained following way new transaction arrives approve two1 previous transactions approvals represented directed edges shown figure 12 directed edge transaction transaction b directed path length b indirectly approves b xe2 x80 x9cgenesis xe2 x80 x9d transaction approved directly indirectly transactions figure 2 genesis described following way beginning tangle address balance contained tokens genesis transaction sent tokens xe2 x80 x9cfounder xe2 x80 x9d addresses let stress tokens created genesis transaction tokens created future mining sense miners receive monetary rewards xe2 x80 x9cout thin air xe2 x80 x9d quick note terminology sites transactions represented tangle graph network composed nodes nodes entities issue validate transactions main idea tangle following issue transaction users work approve transactions users issue transaction contributing network xe2 x80 x99s security assumed nodes check approved transactions conflicting node finds transaction conflict tangle history node approve conflicting transaction direct indirect manner3 1 simplest approach study similar systems transactions approve k transactions general k xe2 x89 xa5 2 entirely different set rules 2 time increases left right figure 3 node issues new transaction approves conflicting transactions risks nodes approve new transaction fall oblivion 2 x0cas transaction receives additional approvals accepted system higher level confidence words difficult system accept double spending transaction important observe impose rules choosing transactions node approve instead argue large number nodes follow xe2 x80 x9creference xe2 x80 x9d rule fixed node better stick rule kind4 reasonable assumption especially context iot nodes specialized chips pre installed firmware order issue transaction node following xe2 x80 xa2 node chooses transactions approve according algorithm general transactions coincide xe2 x80 xa2 node checks transactions conflicting approve conflicting transactions xe2 x80 xa2 node issue valid transaction node solve cryptographic puzzle similar bitcoin blockchain achieved finding nonce hash nonce concatenated data approved transaction particular form case bitcoin protocol hash predefined number leading zeros important observe iota network asynchronous general nodes necessarily set transactions noted tangle contain conflicting transactions nodes achieve consensus valid5 transactions right ledger meaning tangle case conflicting transactions nodes need decide transactions orphaned6 main rule nodes use deciding conflicting transactions following node runs tip selection algorithm7 cf section 4 1 times sees transactions likely indirectly approved selected tip example transaction selected 97 times 100 runs tip selection algorithm confirmed 97% confidence let comment following question cf 4 motivates nodes propagate transactions node calculates statistics 4 comment end section 4 1 transactions issued according protocol 6 orphaned transactions indirectly approved incoming transactions anymore 7 mentioned good reason assume nodes follow algorithm tip selection 5 3 x0chow new transactions received neighbor particular node xe2 x80 x9ctoo lazy xe2 x80 x9d dropped neighbors node issue transactions direct incentive share new transactions approve transaction incentive participate introducing notation section 2 discuss algorithms choosing transactions approve rules measuring transaction xe2 x80 x99s overall approval section 3 especially section 3 1 possible attack scenarios section 4 unlikely event reader scared formulas jump directly xe2 x80 x9cconclusions xe2 x80 x9d end section noted idea dags cryptocurrency space time 3 6 7 9 12 specifically 7 introduces ghost protocol proposes modification bitcoin protocol making main ledger tree instead blockchain shown modification reduces confirmation times improves overall security network 9 authors consider dag based cryptocurrency model model different model following reasons sites dag blocks instead individual transactions miners system compete transaction fees new tokens created block miners observe solution somewhat similar proposed 6 discuss particular tip approval strategies version paper published works aim create dag based distributed ledger appeared e g 8 reference approach 2 10 aims bitcoin micropayments possible establishing peer peer payment channels 2 weights section define weight transaction related concepts weight transaction proportional work issuing node invested current implementation iota weight assume values 3n n positive integer belongs nonempty interval acceptable values8 fact irrelevant know weight obtained practice important transaction positive integer weight attached general idea transaction larger weight xe2 x80 x9cimportant xe2 x80 x9d transaction smaller weight avoid spamming attack styles assumed entity generate abundance transactions xe2 x80 x9cacceptable xe2 x80 x9d weights short period time 8 interval finite xe2 x80 x94 xe2 x80 x9clarge weight attack xe2 x80 x9d section 4 4 x0cone notions need cumulative weight transaction defined weight particular transaction plus sum weights transactions directly indirectly approve transaction algorithm cumulative weight calculation illustrated figure 1 boxes represent transactions small number se corner box denotes weight bold number denotes cumulative weight example transaction f directly indirectly approved transactions b c e cumulative weight f 9 3 1 3 1 1 sum weight f weights b c e let define xe2 x80 x9ctips xe2 x80 x9d unapproved transactions tangle graph tangle snapshot figure 1 tips c new transaction x arrives approves c tangle snapshot x tip cumulative weight transactions increases 3 weight x need introduce additional variables discussion approval algorithms transaction site tangle introduce xe2 x80 xa2 height length longest oriented path genesis xe2 x80 xa2 depth length longest reverse oriented path tip example g height 1 depth 4 figure 2 reverse path f d b d height 3 depth 2 let introduce notion score definition score transaction sum weights transactions approved transaction plus weight transaction figure 2 tips c transaction directly indirectly approves transactions b d f g score 1 3 1 3 1 9 analogously score c 1 1 1 3 1 7 order understand arguments presented paper safely assume transactions weight equal 1 stick assumption assumption cumulative weight transaction x 1 plus number transactions directly indirectly approve x score 1 plus number transactions directly indirectly approved x let note defined section cumulative weight far important metric height depth score briefly enter discussions 5 x0cd 6 11 1 1 1 13 1 f 1 9 4 3 3 b 10 1 2 1 1 1 e c 9 14 1 4 1 1 16 1 12 7 3 3 13 x 3 3 1 5 4 1 1 figure 1 dag weight assignments newly issued transaction x boxes represent transactions small number se corner box denotes weight bold number denotes cumulative weight 6 x0cd genesis 9 1 1 3 3 b f 1 7 g 1 e 1 c figure 2 dag weights assigned site scores calculated sites c 3 stability system cutsets let l t total number tips system time t expects stochastic process l t remains stable 9 precisely expects process positive recurrent sections 4 4 6 5 11 formal definitions particular positive recurrence implies limit p l t k t xe2 x86 x92 xe2 x88 x9e exist positive k xe2 x89 xa5 1 intuitively expect l t fluctuate constant value escape infinity l t escape infinity unapproved transactions left analyze stability properties l t need assumptions assumption transactions issued large number roughly independent entities process incoming transactions modeled poisson point process cf e g section 5 3 11 let xce xbb rate poisson process simplicity let assume rate remains constant time assume devices approximately computing power let h average time device needs perform calculations required issue transaction let assume nodes behave following way issue transaction node chooses tips random approves observed general good idea xe2 x80 x9chonest nodes xe2 x80 x9d adopt strategy number practical disadvantages particular offer protection xe2 x80 x9clazy xe2 x80 x9d malicious nodes section 4 1 hand consider model simple analyze provide insight system xe2 x80 x99s behavior complicated tip selection strategies 9 additional assumption process time homogeneous 7 x0cnext simplifying assumption node moment issues transaction observes actual state tangle exactly h time units ago means particular transaction attached tangle time t visible network time t h assume number tips remains roughly stationary time concentrated number l0 0 following calculate l0 function xce xbb h observe given time t roughly xce xbbh xe2 x80 x9chidden tips xe2 x80 x9d attached time interval t xe2 x88 x92 h t visible network assume typically r xe2 x80 x9crevealed tips xe2 x80 x9d attached time t xe2 x88 x92 h remain tips time t l0 r xce xbbh stationarity assume time t xce xbbh sites tips time t xe2 x88 x92 h tips anymore think new transaction comes moment transaction chooses approve tip probability r r xce xbbh r tips known node issued transaction xce xbbh transactions tips anymore node thinks mean number chosen tips 2r r xce xbbh key observation stationary regime mean number chosen tips equal 1 average newcoming transaction change number tips solving equation 2r r xce xbbh 1 respect r obtain r xce xbbh l0 2 xce xbbh 1 note rule new transaction references k transactions instead 2 similar calculation gives k l0 k xce xbbh k xe2 x88 x921 2 k course consistent fact l0 tend xce xbbh k xe2 x86 x92 xe2 x88 x9e basically tips unknown network return case transactions approve expected time transaction approved time approximately h l0 2 xce xbb 2h assumption h units time transaction approved poisson flow approvals rate approximately 2 xce xbb l0 recall proposition 5 3 11 says independently classify event poisson process according list possible subtypes processes events subtype independent poisson processes observe that10 fixed time t set transactions tips 10 case nodes try approve tips 8 x0cmoment s xe2 x88 x88 t t h l0 n typically constitutes cutset path transaction issued time t0 t genesis pass set important size new cutset tangle occasionally small use small cutsets checkpoints possible dag pruning tasks important observe xe2 x80 x9cpurely random xe2 x80 x9d approval strategy good practice encourage approving tips xe2 x80 x9clazy xe2 x80 x9d user approve fixed pair old transactions contributing approval recent transactions punished behavior11 malicious entity artificially inflate number tips issuing transactions approve fixed pair transactions possible future transactions select tips high probability effectively abandoning tips belonging xe2 x80 x9chonest xe2 x80 x9d nodes avoid issues sort adopt strategy biased xe2 x80 x9cbetter xe2 x80 x9d tips example strategy presented section 4 1 starting discussion expected time transaction receive approval note distinguish regimes figure 3 xe2 x80 xa2 low load typical number tips small frequently 1 happen flow transactions small probable different transactions approve tip network latency low devices compute fast unlikely tips appear holds true case flow transactions reasonably large assume attackers try artificially inflate number tips xe2 x80 xa2 high load typical number tips large happen flow transactions large computational delays network latency likely different transactions approve tip division informal clear borderline regimes find instructive consider different extremes situation low load regime relatively simple approval happens average timescale order xce xbb xe2 x88 x921 incoming transactions approve given tip let consider high load regime case l0 large mentioned assume poisson flows approvals different tips 11 remind reader try enforce particular tip selection strategy attacker choose tips way find convenient 9 x0cfigure 3 low load high load regimes incoming transaction flow white squares represent verified sites gray squares represent tips independent approximate rate 2 xce xbb l0 expected time transaction receive approval l0 2 xce xbb h recall 1 worth noting elaborate approval strategies12 good idea passively wait long time transaction approved fact xe2 x80 x9cbetter xe2 x80 x9d tips appearing preferred approval case transaction waiting approval time interval larger l0 2 xce xbb good strategy promote latent transaction additional transaction13 words node issue transaction approves previous transaction xe2 x80 x9cbetter xe2 x80 x9d tips increase probability transaction receives approval turns approval strategies based heights scores vulnerable specific type attacks section 4 1 discuss elaborate strategies14 defend attacks section meantime 12 favor xe2 x80 x9cbetter xe2 x80 x9d quality tips future implementations iota transaction transaction involve token transfer approve transactions noted generating transaction contributes network xe2 x80 x99s security 14 fact author xe2 x80 x99s feeling tip approval strategy important ingredient constructing tangle based cryptocurrency attack vectors hiding usually way enforce particular tip approval strategy nodes voluntarily choose follow knowing good proportion nodes 13 10 x0cworth considering simple tip selection strategy incoming transaction approves random tips strategy easiest analyze provide insight qualitative quantitative behavior tangle conclusions 1 distinguish regimes low load high load figure 3 2 tips low load regime tip gets approved time xce x98 xce xbb xe2 x88 x921 time units xce xbb rate incoming flow transactions 3 high load regime typical number tips depends tip approval strategy employed new transaction 4 transaction uses strategy approving random tips typical number tips given 1 shown strategy optimal respect typical number tips practical adopt strategy encourage approving tips 5 elaborate strategies needed handle attacks network issues family strategies discussed section 4 1 6 typical time tip approved xce x98 h high load regime h average computation propagation time node approval occur time interval good idea issuer receiver promote transaction additional transaction 3 1 fast cumulative weight typically grow assume network low load regime transaction gets approved times cumulative weight grow speed xce xbb new transactions indirectly reference transaction15 case network high load regime old transaction large cumulative weight experience weight growth speed xce xbb essentially new transactions indirectly reference transaction 15 recall assumed weights transactions equal 1 cumulative weight number transactions directly indirectly reference transaction plus 1 11 x0cis added tangle wait time approved time interval transaction xe2 x80 x99s cumulative weight behaves random fashion characterize speed cumulative weight grows transaction receives approvals let define h t expected cumulative weight time t simplicity start counting time moment transaction revealed network e h time units created k t expected number tips approve transaction time t let abbreviate h h l0 n simplifying assumption number tips remains roughly constant value l0 time work xe2 x80 x9capprove random tips xe2 x80 x9d strategy section expected qualitative behavior roughly reasonable strategies recall transaction entering network time t typically chooses tips approve based state system time t xe2 x88 x92 h node calculations verifications actually issuing transaction difficult assuming k xc2 xb7 actual number tips expected number probability transaction approving x012 x0116 k t xe2 x88 x92h 2 xe2 x88 x92 k t xe2 x88 x92h analogous xe2 x80 x9cour xe2 x80 x9d tips tangle 1 xe2 x88 x92 1 xe2 x88 x92 k t xe2 x88 x92h l0 l0 l0 example 6 4 11 write small xce xb4 0 k t xe2 x88 x92 h x11 k t xe2 x88 x92 h x10 2 xe2 x88 x92 o xce xb4 h t xce xb4 h t xce xbb xce xb4 l0 l0 deduce following differential equation k t xe2 x88 x92 h x10 k t xe2 x88 x92 h x11 dh t xce xbb 2 xe2 x88 x92 dt l0 l0 3 order able use 3 need calculate k t trivial task tip time t xe2 x88 x92 h tip time t overall number tips approving original transaction increases 1 case incoming transaction approves tip crucial observation probability tip time t xe2 x88 x92 h remains tip time t approximately 1 2 verify recall discussion section 3 typical number tips 2 xce xbbh interval length h new xce xbbh tips substitute half old ones time t approximately half k t xe2 x88 x92 h tips remain unconfirmed tip state half received approval let denote set k t xe2 x88 x92 h 2 tips time t xe2 x88 x92 h tips time t let b denote 16 expression left hand 1 minus probability approved tips 12 x0cremaining set k t xe2 x88 x92 h 2 tips approved time t let p1 probability new transaction approves 1 transaction b approve transactions furthermore let p2 probability approved transactions belong words p1 p2 probabilities current number xe2 x80 x9cour xe2 x80 x9d tips increases decreases 1 arrival new transaction x10 k t xe2 x88 x92 h x112 k t xe2 x88 x92 h x11 k t xe2 x88 x92 h x10 p1 1 xe2 x88 x92 2 xc3 x97 2l0 2l0 l0 x10 k t xe2 x88 x92 h x112 p2 2l0 obtain expression observe p1 equals probability approved tips belong b plus twice probability tip belongs b second tip belong xe2 x88 xaa b analogous 3 differential equation k t k t xe2 x88 x92 h x10 k t xe2 x88 x92 h x11 dk t p1 xe2 x88 x92 p2 xce xbb xce xbb 1 xe2 x88 x92 4 dt l0 l0 difficult solve 4 exactly simplifying assumptions observe time k t reaches level xce xb5l0 fixed xce xb5 0 grow quickly 1 xe2 x88 x92 xce xb5 l0 k t small respect l0 drop factor right hand 4 17 obtain simplified version 4 recalling l xce xbbh0 12 dk t 1 xe2 x89 x88 k t xe2 x88 x92 h dt 2h 5 boundary condition k 0 1 look solution form k t exp c ht substituting 5 obtain x10 t x11 x10 t x11 c 1 exp c xe2 x89 x88 exp c xe2 x88 x92 c h h 2h h x10 x10 x01t x11 t x11 k t exp w 12 xe2 x89 x88 exp 0 352 6 h h approximate solution w xc2 xb7 called lambert w function 18 taking logarithm sides 6 find time k t reaches xce xb5l0 constant close 1 right hand equivalent xce xbb k t xe2 x88 x92h l0 18 known omega function product logarithm x xe2 x88 x88 0 xe2 x88 x9e characterized relation x w x exp w x 17 13 x0ccumulative weight xce xb2 tan xce xb2 xce xbb time 0 adaptation period figure 4 plot cumulative weight vs time high load regime roughly t0 xe2 x89 x88 h w x01 xe2 x88 x921 x01 xc3 x97 ln l xe2 x88 x92 ln xce xb5 2 84 xc2 xb7 h ln l0 0 1 7 2 returning 3 dropping term right hand obtain xe2 x80 x9cadaptation period xe2 x80 x9d e t xe2 x89 xa4 t0 t0 7 holds 2 xce xbb dh t xe2 x89 x88 k t xe2 x88 x92 h dt l0 x10 x01 x11 1 1 t x01 xe2 x89 x88 exp w 2 h h exp w 21 x01 1 x10 x11 x01t 2w 2 exp w 12 h h x10 x01t x11 t x11 xe2 x89 x88 2 exp 0 352 8 h h let remind reader adaptation period cumulative weight h t grows linearly speed xce xbb stress xe2 x80 x9cexponential growth xe2 x80 x9d 8 mean cumulative weight grows xe2 x80 x9cvery quickly xe2 x80 x9d adaptation period behavior depicted figure 4 x10 h t xe2 x89 x88 2 exp w 1 2 14 x0cconclusions 1 transaction gets approved multiple times low load regime cumulative weight grow speed xce xbbw w mean weight generic transaction 2 high load regime distinct growth phases transaction xe2 x80 x99s cumulative weight h t grows increasing speed adaptation period according 8 adaptation period cumulative weight grows speed xce xbbw figure 4 fact reasonable strategy cumulative weight grow speed end adaptation period incoming transactions indirectly approve transaction interest 3 think adaptation period transaction time current tips indirectly approve transaction typical length adaptation period given 7 4 possible attack scenarios start discussing attack scenario attacker tries xe2 x80 x9coutpace xe2 x80 x9d network 1 attacker sends payment merchant receives goods merchant decides transaction sufficiently large cumulative weight 2 attacker issues double spending transaction 3 attacker uses computing power issue small transactions approve double spending transaction approve original transaction sent merchant directly indirectly 4 possible attacker plethora sybil identities required approve tips 5 alternative method item 3 attacker issue big doublespending transaction computing power transaction large weight19 approve transactions prior legitimate transaction pay merchant 19 assume weight transaction vary clear discussion good idea let weight vary 15 x0clegitimate transaction double spending figure 5 xe2 x80 x9clarge weight xe2 x80 x9d attack 6 attacker hopes dishonest subtangle outpaces honest subtangle happens main tangle continues growing doublespending transaction legitimate branch original payment merchant orphaned figure 5 fact shown strategy large double spending transaction increases attacker xe2 x80 x99s chances successful xe2 x80 x9cideal xe2 x80 x9d situation mathematical model attack succeeds let w n time needed obtain nonce gives double spending transaction weight 3n assume w n exponentially distributed random variable parameter20 xc2 xb53 xe2 x88 x92n xc2 xb5 represents computing power attacker assume merchant accepts legitimate transaction cumulative weight w0 happens t0 time units original transaction reasonable expect cumulative weight grows linear speed xce xbbw xce xbb overall arrival rate transactions issued network honest nodes w mean weight generic transaction typical total weight legitimate branch time w1 xce xbbwt0 x07 x06 let dxe smallest integer greater equal x define n0 lnlnw31 3n0 xe2 x89 xa5 w1 21 attacker managed obtain nonce gives doublespending transaction weight 3n0 time interval length t0 attack succeeds probability event t0 xc2 xb5 p w n0 t0 1 xe2 x88 x92 exp xe2 x88 x92t0 xc2 xb53 xe2 x88 x92n0 xe2 x89 x88 1 xe2 x88 x92 exp xe2 x88 x92t0 xc2 xb5w1 xe2 x88 x921 xe2 x89 x88 w1 20 21 expectation xc2 xb5 xe2 x88 x921 3n fact 3n0 xe2 x89 x88 w1 w1 large 16 x0cthis approximation true case tw0 1 xc2 xb5 small reasonable assumption xe2 x80 x9cimmediate xe2 x80 x9d attack succeed attacker continue look nonce gives weight 3n n n0 hope moment find total weight legitimate branch smaller 3n probability event occurring x01 xc2 xb5 p xce xbbww n 3n 1 xe2 x88 x92 exp xe2 x88 x92 xc2 xb53 xe2 x88 x92n0 xc3 x97 3n0 xce xbbw 1 xe2 x88 x92 exp xe2 x88 x92 xc2 xb5 xce xbbw xe2 x89 x88 xce xbbw xc2 xb5 xce xbbw typically small number xe2 x80 x9clevel xe2 x80 x9d n attack succeeds constant probability s succeed typical xce xbbw time succeeds roughly 3 xc2 xb5 quantity large probability xe2 x80 x9cfirst xe2 x80 x9d22 attack succeeds negligible need countermeasures countermeasure limiting weight setting constant value mentioned section 3 best solution offer protection spam let discuss situation maximum weight capped value 1 estimate probability attack succeeds assume given transaction gained cumulative weight w0 t0 time units moment issued adaptation period transaction situation transaction xe2 x80 x99s cumulative weight increases linearly speed xce xbb imagine attacker wants double spend transaction attacker secretly prepares double spending transaction starts generating nonsense transactions approve double spending transaction time23 original transaction issued merchant attacker xe2 x80 x99s subtangle outpaces legitimate subtangle moment merchant decides accept legitimate transaction double spending attack successful happen double spending transaction approved legitimate transaction acquire cumulative weight essentially new tips indirectly approve double spending transaction orphaned scenario let xc2 xb5 stand computing power attacker simplifying assumption transactions propagate instantly let g1 g2 g3 denote d exponential random variables parameter xc2 xb524 define vk xc2 xb5gk k xe2 x89 xa5 1 follows v1 v2 v3 d exponential random variables parameter 1 22 time t0 discuss case later 24 expected value 1 xc2 xb5 23 17 x0csuppose time t0 merchant decides accept transaction cumulative weight w0 let estimate probability attacker successfully double spends let m xce xb8 1 xe2 x88 x92 xce xb8 xe2 x88 x921 moment generating function exponential distribution parameter 1 section 7 7 14 known25 xce xb1 xe2 x88 x88 0 1 holds p n hx x01 vk xe2 x89 xa4 xce xb1n xe2 x89 x88 exp xe2 x88 x92 n xcf x95 xce xb1 9 k 1 xcf x95 xce xb1 xe2 x88 x92 ln xce xb1 xce xb1 xe2 x88 x92 1 legendre transform ln m xce xb8 general fact holds xcf x95 xce xb1 0 xce xb1 xe2 x88 x88 0 1 recall expectation exponential random variable parameter 1 equals 1 0 1 probability attacker xe2 x80 x99s subtangle evenassume xc2 xb5t w0 tually outpaces legitimate subtangle close 1 outweigh w0 time t0 attacker needs able issue w0 transactions maximum weight m time t0 9 find probability double spending transaction cumulative weight time t0 roughly p 0 m h wx gk t0 p k 1 w0 hx k 1 w0 hx vk xc2 xb5t0 xc2 xb5t0 w0 k 1 x01 x01 0 xe2 x89 x88 exp xe2 x88 x92 w0 xcf x95 xc2 xb5t w0 p vk w0 xc3 x97 10 x01 0 probability small wm0 needs large xcf x95 xc2 xb5t w0 small note time t xe2 x89 xa5 t0 cumulative weight legitimate transaction roughly w0 xce xbb t xe2 x88 x92 t0 assumed adaptation period cumulative weight grows speed xce xbb analogous 10 finds probability double spending transaction cumulative weight time t xe2 x89 xa5 t0 roughly x01 x01 xc2 xb5t 11 exp xe2 x88 x92 w0 xce xbb t xe2 x88 x92 t0 xcf x95 w0 xce xbb t xe2 x88 x92t 0 0 true xc2 xb5t xe2 x89 xa5 xc2 xb5 xce xbb cumulative weight grows w0 speed xce xbb adaptation period shown probability 25 consequence called large deviation principle general book 13 proposition 5 2 section 8 5 14 simple instructive derivation upper bound section 1 9 5 simple derivation lower bound 18 x0cof achieving successful double spend order x01 x01 0 xc2 xb5 exp xe2 x88 x92 w0 xcf x95 max xc2 xb5t w0 xce xbb 12 example let xc2 xb5 2 xce xbb 3 attacker xe2 x80 x99s power bit rest network assume x01 transaction cumulative weight 0 xc2 xb5 32 time 12 max xc2 xb5t 34 xcf x95 43 xe2 x89 x88 0 03768 12 gives w0 xce xbb upper bound approximately 0 29 assumes xc2 xb5 1 keeps pa x01 xc2 xb5t0 xc2 xb5 3 3 rameters intact max w0 xce xbb 8 xcf x95 8 xe2 x89 x88 0 3558 12 gives approximately 0 00001135 drastic change discussion important recognize inequality xce xbb xc2 xb5 true system secure words input flow xe2 x80 x9chonest xe2 x80 x9d transactions large compared attacker xe2 x80 x99s computational power estimate 12 useless indicates need additional security measures checkpoints early days tangle based system choosing strategy deciding conflicting transactions valid careful cumulative weight decision metric fact cumulative weight subject attack similar described section 4 1 attacker prepare doublespending transaction advance build secret subtangle referencing broadcast subtangle merchant accepts legitimate transaction better method deciding conflicting transactions described section run tip selection algorithm transactions indirectly approved selected tip 4 1 parasite chain attack new tip selection algorithm consider following attack figure 6 attacker secretly builds subtangle occasionally references main tangle gain higher score note score honest tips roughly sum weights main tangle score attacker xe2 x80 x99s tips contains sum weights parasite chain network latency issue attacker builds subtangle alone26 able height parasite tips use computer sufficiently strong attacker artificially increase tip count moment attack broadcasting new transactions 26 fact attacker approve transactions relying information rest network 19 x0cthat approve transactions issued earlier parasite chain figure 6 attacker advantage case honest nodes use selection strategy involves simple choice available tips defend attack style going use fact main tangle supposed active hashing power attacker main tangle able produce larger increases cumulative weight transactions attacker idea use mcmc algorithm select tips reference let hx current cumulative weight site recall assumed weights equal 1 cumulative weight tip 1 cumulative weight sites 2 idea place particles k random walkers sites tangle let walk tips random27 way tips xe2 x80 x9cchosen xe2 x80 x9d walks candidates approval algorithm described following way 1 consider sites interval w 2w w reasonably large28 2 independently place n particles sites interval29 3 let particles perform independent discrete time random walks xe2 x80 x9ctowards tips xe2 x80 x9d meaning transition x y possible y approves x 4 random walkers reach tip set sit tips approved wise modify rule following way discard random walkers reached tips fast ended xe2 x80 x9clazy tips xe2 x80 x9d 5 transition probabilities walkers defined following way y approves x y x transition probability pxy proportional 27 xe2 x80 x9ccanonical xe2 x80 x9d source randomness nodes use pseudo random number generators simulate random walks 28 idea place particle xe2 x80 x9cdeep xe2 x80 x9d tangle arrive tip straight away particle placed xe2 x80 x9ctoo deep xe2 x80 x9d needs find tip reasonable time interval w 2w arbitrary chose w 5w etc ways select walkers xe2 x80 x99 starting points example node simply random transaction received t0 2t0 time units past t0 fixed time point 29 choice largely arbitrary use particles instead additional security idea particle accidentally jump attacker xe2 x80 x99s chain supposed long spend lot time tips chosen 20 x0clazy tips main tangle good tips parasite chain figure 6 visual representation tip selection algorithm honest tips parasite chain red circles indicate attempted double spend attacker x01 exp xe2 x88 x92 xce xb1 hx xe2 x88 x92 hy x01 x10 x x01 x11 xe2 x88 x921 pxy exp xe2 x88 x92 xce xb1 hx xe2 x88 x92 hy exp xe2 x88 x92 xce xb1 hx xe2 x88 x92 hz z z 13 x xce xb1 0 parameter chosen30 note algorithm xe2 x80 x9clocal xe2 x80 x9d meaning need traverse tangle genesis perform relevant calculations particular observe need calculate cumulative weights tangle needs calculate cumulative weights sites indirectly approve starting point walker check algorithm works intended consider xe2 x80 x9clazy tips xe2 x80 x9d tips intentionally approve old transactions avoid verification work figure 6 particle site approved lazy tip probable lazy tip selected difference cumulative weights large pxy small consider alternate attack style attacker secretly builds chain containing transaction empties account balance account control indicated leftmost red circle figure 6 attacker issues transaction main tangle represented rightmost red circle waits merchant accept parasite chain occasionally references main 30 start xce xb1 1 21 x0ctangle cumulative weight large parasite chain noted parasite chain reference main tangle merchant xe2 x80 x99s transaction furthermore attacker try artificially inflate number tips parasite chain moment attack figure 6 attacker xe2 x80 x99s idea nodes issuing new transactions reference parasite chain honest branch tangle orphaned easy mcmc selection algorithm select attacker xe2 x80 x99s tips high probability reasoning identical lazy tip scenario sites parasite chain cumulative weight smaller sites reference main tangle probable random walker jump parasite chain begins event probable main tangle contains sites additional protecting measure run random walk large xce xb1 fact xe2 x80 x9calmost deterministic xe2 x80 x9d choose xe2 x80 x9cmodel tip xe2 x80 x9d use random walks small xce xb1 actual tip selection verify indirectly referenced transactions consistent model tip observe random walk moves tips simple rapid calculate exit probability distribution straightforward recursion want nodes possible modify approach following way step random walk backtrack e 1 step away tips probability 31 divide remaining 23 walk reach tips quickly drift tips easy calculate exit measure let comment nodes follow algorithm recall section 1 reasonable assume xe2 x80 x9cgood xe2 x80 x9d proportion nodes follow reference algorithm computational network delays tip selection algorithm work past snapshot tangle respect moment transaction issued good idea intentionally snapshot time point past31 reference algorithm reasons explain sequel imagine xe2 x80 x9cselfish xe2 x80 x9d node wants maximize chances transaction approved quickly mcmc algorithm section adopted considerable proportion nodes defines probability distribution set tips clear 31 random walker finds tip respect snapshot continues walk xe2 x80 x9cactual xe2 x80 x9d tips current tangle 22 x0ca natural choice selfish node choose tips maximum distribution attained nodes behave selfish way use strategy reasonable assumption lose new transactions approve tips roughly time generating competition subsequent approval clear nodes immediately xe2 x80 x9cfeel xe2 x80 x9d cumulative weight increase caused mass approval tips nodes past snapshot reason selfish node use random tip approval algorithm32 probability distribution tip selection close default probability distribution produced reference tip selection algorithm claim xe2 x80 x9caggregated xe2 x80 x9d probability distribution equal default probability distribution presence selfish nodes argument shows close means probability nodes attempting verify xe2 x80 x9cbad xe2 x80 x9d tips remain small case large incentive nodes selfish possible gains slight decrease confirmation time inherently different decentralized constructs bitcoin important fact nodes reasons abandon mcmc tip selection algorithm like mention definition transition probabilities given 13 set stone instead exponent use different function decreases rapidly f s s xe2 x88 x923 freedom choosing w n point time unclear theoretical arguments exactly way parameters chosen sum feel main contribution section idea mcmc tip selection 4 2 splitting attack aviv zohar suggested following attack scheme proposed mcmc algorithm high load regime attacker try split tangle branches maintain balance allow branches continue grow attacker place conflicting transactions 32 noticed backtracking walk easy way discover tips better likely selected xe2 x80 x9chonest xe2 x80 x9d nodes running mcmc times running mcmc times requires time resources spends time state tangle change possibly start anew explains nodes reasons abandon mcmc tips selection strategy favor assume considerable proportion nodes follow default tips selection strategy 23 x0cat beginning split prevent honest node effectively joining branches referencing simultaneously attacker hopes roughly half network contribute branch able xe2 x80 x9ccompensate xe2 x80 x9d random fluctuations relatively small personal computing power technique works attacker able spend funds branches defend attack needs use xe2 x80 x9csharp threshold xe2 x80 x9d rule makes hard maintain balance branches example rule selecting longest chain bitcoin network let translate concept tangle undergoing splitting attack assume branch total weight 537 second branch total weight 528 honest node selects branch probability close 1 2 attacker probably able maintain balance branches honest node selects branch probability larger 1 2 attacker probably unable maintain balance inability maintain balance branches case fact inevitable random fluctuation network quickly choose branches abandon order mcmc algorithm behave way choose rapidly decaying function f initiate random walk node large depth highly probable walk starts branch bifurcation case random walk choose xe2 x80 x9cheavier xe2 x80 x9d branch high probability difference cumulative weight competing branches small worth noting attacker xe2 x80 x99s task difficult network synchronization issues aware large number recently issued transactions33 effective method defending splitting attack sufficiently powerful entity instantaneously publish large number transactions branch rapidly changing power balance making difficult attacker deal change attacker manages maintain split recent transactions 50% confirmation confidence section 1 branches grow scenario xe2 x80 x9chonest xe2 x80 x9d nodes decide start selectively giving approval transactions occurred bifurcation bypassing opportunity approve conflicting transactions split branches consider versions tip selection algorithm example node sees big subtangles chooses larger sum 33 xe2 x80 x9creal xe2 x80 x9d cumulative weights different believe 24 x0cweights performing mcmc tip selection algorithm outlined following idea worth considering future implementations transition probabilities defined 13 depend hx xe2 x88 x92 hy hx way step markov chain deterministic walker deep tangle random walker close tips help avoid entering weaker branch assuring sufficient randomness choosing tips approve conclusions 1 considered attack strategies attacker tries double spend xe2 x80 x9coutpacing xe2 x80 x9d system 2 xe2 x80 x9clarge weight xe2 x80 x9d attack means order double spend attacker tries large weight double spending transaction outweigh legitimate subtangle strategy menace network case allowed weight unbounded solution limit weight transaction set constant value 3 situation maximal weight transaction m best attack strategy generate transactions weight m reference double spending transaction input flow xe2 x80 x9chonest xe2 x80 x9d transactions large compared attacker xe2 x80 x99s computational power probability double spending transaction larger cumulative weight estimated formula 12 examples 12 4 attack method building xe2 x80 x9cparasite chain xe2 x80 x9d makes approval strategies based height score obsolete attacker xe2 x80 x99s sites higher values metrics compared legitimate tangle hand mcmc tip selection algorithm described section 4 1 provide protection kind attack 5 mcmc tip selection algorithm offers protection lazy nodes bonus 25 x0c5 resistance quantum computations known sufficiently large quantum computer34 efficient handling problems rely trial error find solution process finding nonce order generate bitcoin block good example problem today check average 268 nonces find suitable hash allows new block xe2 x88 x9abe generated known e g 15 quantum computer need xce x98 n operations solve problem analogous bitcoin puzzle stated problem need xce x98 n operations classical xe2 x88 x9a 34 68 computer quantum computer 2 2 xe2 x89 x88 17 billion times efficient mining bitcoin blockchain classical computer worth noting blockchain increase difficulty response increased hashing power increased rate orphaned blocks reason xe2 x80 x9clarge weight xe2 x80 x9d attack efficient quantum computer capping weight suggested section 4 effectively prevent quantum computer attack evident iota number nonces needs check order find suitable hash issuing transaction unreasonably large average 38 gain efficiency xe2 x80 x9cideal xe2 x80 x9d quantum computer order 34 81 acceptable35 importantly algorithm iota implementation structured time find nonce larger time needed tasks necessary issue transaction resistant quantum computing gives tangle protection adversary quantum computer compared bitcoin blockchain acknowledgements author thanks bartosz kusmierz cyril gru xcc x88nspan olivia saa razvan savu samuel reid toru kazama rafael kallis rodrigo bueno pointed errors earlier drafts james brogan contributions making paper readable 34 35 hypothetical construct today xe2 x88 x9a xe2 x88 x9a note xce x98 n easily mean 10 n 26 x0creferences 1 iota cryptocurrency internet things http www iotatoken com https bitcointalk org index php topic 1216479 0 2 bitcoinj working micropayment channels https bitcoinj github io working micropayments 3 people nxtforum org 2014 dag generalized blockchain https nxtforum org proof stake algorithm dag generalized blockchain registration nxtforum org required 4 moshe babaioff shahar dobzinski sigal oren aviv zohar 2012 bitcoin red balloons proc 13th acm conf electronic commerce 56 xe2 x80 x9373 5 richard durrett 2004 probability xe2 x80 x93 theory examples duxbury advanced series 6 sergio demian lerner 2015 dagcoin cryptocurrency blocks https bitslog wordpress com 2015 09 11 dagcoin 7 yonatan sompolinsky aviv zohar 2013 accelerating bitcoin xe2 x80 x99s transaction processing fast money grows trees chains https eprint iacr org 2013 881 pdf 8 yonatan sompolinsky yoad lewenberg aviv zohar 2016 spectre serialization proof work events confirming transactions recursive elections https eprint iacr org 2016 1159 pdf 9 yoad lewenberg yonatan sompolinsky aviv zohar 2015 inclusive block chain protocols http www cs huji ac il avivz pubs 15 inclusive btc pdf 10 joseph poon thaddeus dryja 2016 bitcoin lightning network scalable chain instant payments https lightning network lightning network paper pdf 11 sheldon m ross 2012 introduction probability models 10th ed 12 david vorick 2015 getting rid blocks slides com davidvorick braids 27 x0c 13 amir dembo ofer zeitouni 2010 large deviations techniques applications springer 14 sheldon m ross 2009 course probability 8th ed 15 gilles brassard peter hyer alain tapp 1998 quantum cryptanalysis hash claw free functions lecture notes computer science 1380 163 xe2 x80 x93 169 28 x0c