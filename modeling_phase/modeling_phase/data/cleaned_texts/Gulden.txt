b gulden 2 0 improving blockchain malcolm j macleod mmacleod webmail co za gordons bay south africa abstract xe2 x80 x9cgreat engineering art intelligent compromise xe2 x80 x9d dan watts release bitcoin blockchain technology powers ushered exciting new era digital currencies distributed computing seemingly bringing existence thought impossible trustless decentralised currency like great inventions past progress achieved breaking rules nature limitations people imagined stood way taking long hard look requirements coming clever new compromise inventions significance contain compromises bitcoin exception groundbreaking new systems naive unrealistic expect iteration 100% right stands reason room improvement 8 years bitcoin burst scene numerous competitors come gone bringing minor improvements table overall little meaningful progress achieved core areas belief sober proper reflection current shortcomings real solutions necessary promising new technology easily falter infancy article attempts pinpoint believe shortfalls compromises current blockchain technology analyse search ways improve system goal implementing improvements virtual currency gulden keywords blockchain gulden bitcoin distributed consensus hashcash proof stake proof work pow xc2 xb2 1 introduction blockchain blockchain represents date best partial solution complex problem known computer science trustless distributed consensus perfect trustless distributed consensus ability multiple computers agree record order events information manner permanent tampered forged fact x0c2 having central authority system decides controls order peers system essentially equal special control system blockchain perfect trustless distributed system trustless distributed system achieves compromise relaxing criteria slightly instead history 100% incorruptible unforgeable settles instead history incredibly difficult tamper forge assumption applied monetary system requirement sufficient touch later paper want focus great benefits allows 1 centralized point failure single piece infrastructure taken cause interruption service loss history traditional alternatives susceptible seen numerous cases history banks losing peoples transaction history e g visa network going temporarily unusable 2 centralized control control network tell play rules eliminated possibility corruption embezzlement plagued banking industry past 3 oversight required xe2 x80 x93 countries today possible open new bank payment service complying mountains legal requirements oversight government good reason oversight central authority easily xe2 x80 x99s money1 1 2 blockchain based service bypasses need legislation allowing services rolled internationally faster cheaper blockchains certainly limited payment systems currencies late attempts use concept numerous use cases paper written perspective gulden digital currency follows specific context decentralised virtual currencies specifically gulden read 2 problems unfortunately2 current blockchain implementations fall short ideal people like expectations people currency expect currency offer problems 1 uncommon thing looks instance pension funds oversight problem 2 new technologies incarnations established technologies x0c2 1 double spends 3 visible obvious public larger currencies like bitcoin obvious later date3 problems inherent effect distributed nature blockchain best mitigated limitations initial implementations potentially overcome step course identify problems comprehensive list possible problems list problems gulden team considers important look point time 2 1 double spends simplified description works 1 attacker creates transaction t1 sends funds recipient r1 xe2 x80 x99target xe2 x80 x99 attack 2 creates second transaction t2 sends funds different recipient r2 4 3 t1 revealed network recipient aware transaction acts receipt assuming attacker payment order 4 t2 revealed network attacker 5 network accept t1 t2 valid ensuring network accepts t2 5 instead t1 attacker effectively stolen original recipient ideal payment system possible unfortunately effects decentralized nature blockchain brings depth analysis subject found rosenfeld 13 2 1 1 zero conf double spend zero conf double spend easiest way perform double spend easiest cheapest attack perform terms technology hardest terms finding victim victim know relatively soon6 potentially ripped attacker attacker exercise caution attack7 order able escape captured 3 number users grow blockchain transaction numbers grow scaling problems obvious end users 4 likely necessarily address control 5 exact mechanisms play differ slightly depending attacking 0 conf transaction entered blockchain information methods subsections follow 6 straight block mined soon conflicting transaction reaches 7 online targets like exchanges ideal targets foolish accept 0 conf x0c2 1 double spends 4 essentially relies finding merchant accepts transactions entered block blockchain possible double spend simply mining block b convincing miner block include second malicious transaction instead transaction xe2 x80 x93 paying miner putting higher fee malicious transaction luck means reality zero conf transactions completely unsafe use cases exception cases merchant capable physically tracking double spenders prosecuting xe2 x80 x93 instance general reaction place blame merchants claim education solve issue valid extent reality merchants continue accept zero conf educated business model simply xe2 x80 x99t tolerate waiting long periods time single conf inevitable losses businesses somebody manages rip harmful ecosystem ideally need stopped 2 1 2 short chain double spend feasible attack attacker funds terms finding victims etc attacker makes payment waits included block immediately begins mining private chain second conflicting transaction instead carries mining faster rate main network ahead main network received goods merchant confident escape point unleashes longer chain merchant accepts 1 conf attacker needs 2 blocks row pull 2 conf 3 blocks etc recommended people wait 7 confirmations xe2 x80 x93 makes attack 30% hash rate unlikely xe2 x80 x93 usually require 50% 7 confirmations long time period discussed huge problem merchants reality vast majority merchants working 1 conf chances success determined hash power attacker blocks needs element luck obtaining 50% hash rate 50% attack guaranteed success attacks lower hash rate particularly large problem newer coins especially infancy xe2 x80 x93 don xe2 x80 x99t luxury share hashing algorithm larger coin 50% attack feasible xe2 x80 x98good xe2 x80 x99 algorithm choice taken interest sector picking creating new algorithm automatically protect bitcoin early coins infancy essentially relied benefitted fact actually wanted attack point time helped defend weakness new virtual currencies enjoy attention face competition slower growth x0c2 2 50% attacks 5 luxury younger virtual currencies like gulden viable solution needed pretend okay hope grow past point issue 2 1 3 long chain double spend expensive easiest defend won xe2 x80 x99t deal paper essentially short chain spend longer period time day month way start coin long periods time involved costly pull completely devastating coin question happen fortunately relatively easy defend notably exceptions bitcoin team conceded decentralization good having checkpoints basically snapshots blockchain built wallet release certain blocks expected present hard coded prevents attack checkpoint defenses possible downsides e g 3 7 2 2 50% attacks largest attack vector blockchain 50% attack attacker gain 50% networks hash rate gives capabilities brief description discussed detail section xe2 x80 xa2 censorship attacker deny specific transactions access blockchain mining acknowledging blocks contain transaction xe2 x80 xa2 denial service attacker blocks 2 7 2 denying service network xe2 x80 xa2 double spend attacker network relative ease execute double spends 2 1 relied times obtaining 50% more8 hash rate difficult impossible achieve bitcoin famous largest blockchain based currency easy achieve newer coins difficult 2 3 selfish mining miner mines block generally assumed immediately broadcast network honest nodes operate isn xe2 x80 x99t restriction delay broadcasting network 8 actually 30% problem factors like selfish mining taken account x0c2 4 chains 6 long wishes9 immediately start mining second block refers currently found block broadcast process known selfish mining simplest cases large miner gain slight advantage delaying broadcast blocks found seconds miner increases chances finding blocks compared rest network abused sinister ways10 xe2 x80 x93 miner approximately 33% hash rate engaging selfish mining theory bit luck obtain advantage execute 50% attack e 50% attack necessarily actually require 50% hash rate eyal sirer 9 garay et al 10 2 4 chains related possible miner multiple blocks secret sharing network work attack private risk exposed attack fail chain successful chain11 shared network point late characteristic utilised wishing perform double spends 2 5 centralisation mining real world experience shown time mining blocks concentrates small number individuals pools weakens parts system making easier attack examples include 1 ddos larger mining pools order gain temporary 50% advantage execute double spend simply cause problems coin 2 malicious pools xe2 x80 x93 blocks discussed denial service aid people double spends cause problems network 3 jump pools xe2 x80 x93 discussed detail erratic block times 2 6 erratic block times 2 6 1 block target reasons12 block intervals erratic ideally block meant come 2 5 minutes13 reality come quicker slower unusual smaller coins blocks come space seconds block 9 restriction somebody block xe2 x80 x99side chain xe2 x80 x99 purposes 50% attack way specialised form selfish mining 11 larger main chain 12 brief details subsections 13 gulden 2 5 minutes 10 minutes bitcoin 10 x0c2 7 transaction capacity limitation 7 20 minutes hour best major inconvenience new users huge cause support queries worse stopper merchants accept currency waiting long safe transfer funds won xe2 x80 x99t work absolute worst case incentive merchants turn accepting 0 conf transactions 14 2 6 2 inaccurate block times result decentralisation real way enforce accurate times blocks xe2 x80 x99s possible restrict blocks coming future15 reverse possible restrict blocks timestamp past hard limit restriction median timestamp 11 blocks increment allows lot room miners mess timestamp mining block reasons xe2 x80 xa2 machine genuinely wrong time xe2 x80 xa2 hopes gaining money tricking targeting algorithm yielding easier blocks xe2 x80 xa2 malicious attack system example time warp attack allows miner abnormally large blocks abnormally short time tampering timestamps xe2 x80 xa2 result miner engaging selfish mining possible tighten forward drift allowance bit gulden 16 ultimately limits inaccuracy timestamps little bit doesn xe2 x80 x99t solve problem 2 6 3 xe2 x80 x99jump xe2 x80 x99 pools newer coins starting unique hashing algorithm17 added problem lot miners constantly switch miners coins maximise mining profit lead situations hash rate suddenly spikes drops drastically block18 longer time come result 2 7 transaction capacity limitation 2 7 1 block size limit system inherent limit transactions process block allowed certain size19 difficulty adjusted 14 provably unsafe ultimately sad story waiting happen clients reject blocks timestamp 2 hours future 16 timestamp limited 1 minute future median 3 blocks 17 brings unique problems discuss later paper 18 blocks difficulty algorithm slow adjust 19 gulden bitcoin 1mb 15 bitcoin x0c2 8 sybil attack 8 come fixed interval20 21 leading overall limit transactions actually fit blockchain given time period limit exceeded transactions long enter blockchain lead difficulties users lot press coverage years bitcoin regular occurrence fighting controversy bitcoinwiki 3 target interval block size limit adjusted extent hard limit imposed infrastructure network operates exceeded attempting allow larger blocks limit catastrophic network decker wattenhofer 7 2 7 2 denial service blocks factor strangely overlooked debates fact minimum block size miners block block single transaction thousands hundreds thousands xe2 x80 x99uncleared xe2 x80 x99 transactions waiting system enter block implementation detail system works setting minimum number transactions block properly enforced miners generate transactions meet minimum reasons miners blocks xe2 x80 xa2 attack system hold ransom political statement xe2 x80 xa2 gain mining advantage 22 worst points 170 000 unconfirmed transactions pending network miners mining completely blocks blockchain info 4 5 long miners possibility service denied simply mining blocks arguments past network refuse blocks instance reality problematic opens possible ways attack network certain coin scale larger succeed long term needs address design flaw 2 8 sybil attack attacker surround target node nodes controls prevent target node seeing true blockchain feed blockchain target 20 average impossible course actually come fixed interval gulden 2 5 minutes bitcoin 10 minutes 22 small negligible speed resource advantage miners add transactions blocks 21 x0c2 9 stalled blockchain 9 people implement blockchain based systems aware underlying issue blockchains depth information concept obtained following paper douceur 8 2 9 stalled blockchain exists possibility blockchain stall difficulty driven high followed sudden absence miners existing miners struggle completely fail find new blocks effect range major inconvenience best case death spiral currency worst case 3 tried far failed attempts23 virtual currencies attempt solve problems time space necessarily productive enumerate talk ones consider relevant briefly discussed note intentionally kept brief lot details simplified intentionally left deemed relevant paper comprehensive read 3 1 alternative hashing algorithms relatively common idea virtual currency world24 use different new hashing algorithm 25 idea having unique algorithm virtual currency longer susceptible 2 6 3 hash rate algorithm pointed coin26 50% attacks harder execute large surplus hash rate easily rented bought course hold true extent seen litecoin initially introduced scrypt algorithm multiple coins released use scrypt managed retain dominance scrypt hash rate 50% attack would27 incredibly expensive pull exception prove rule litecoin earliest virtual currencies fork bitcoin managed gain large market share value hash rate virtual currencies known researched 23 better thought implemented said based wishful thinking sound reasoning 24 easy easy market people little understanding big change 25 pool suitable hashing algorithms computing world small means inventing new algorithm process difficult correctly 26 people like think 27 bitcoin x0c3 2 alteration block target 10 litecoin infancy fewer people knowledge required execute 50% attack financial motivation lot capital thrown xe2 x80 x99early mover xe2 x80 x99 advantage means xe2 x80 x99t necessarily work virtual currencies real world experience shown doesn xe2 x80 x99t problems new algorithm brings need considered xe2 x80 xa2 pool existing hashing algorithms verified randomly distributed secure small coins xe2 x80 xa2 picking existing hashing algorithm existing computer science literature hashcash 1 based virtual currencies28 impossible know sure existing hash power virtual currency 1000 users mining cpus gpus users belief funds secure attacker secretly obtained asic fgpa botnet ease perform multiple attacks way ensure happen develop asics especially virtual currency rapidly possible xe2 x80 x93 huge expense impractical coins xe2 x80 xa2 inventing brand new algorithm new algorithm flaws exploited hash completely randomly evenly distributed example attacker manipulate input blocks gain advantage flaw found attacker exploit hash significantly faster rate new hashing algorithm proven reasonably secure randomly distributed proper way huge undertaking usually involved multiple experts large period time29 reach virtual currencies terms budget practicality 3 2 alteration block target common idea seen virtual currencies idea faster block target bitcoin 10 minutes main arguments usually given 1 assuming block size limit transactions second processed blocks occur frequently allegedly solving 2 7 2 average time user wait transaction confirmed lower blocks come frequently 28 skeincoin 29 usually qubitcoin etc competition format involving peer reviews multiple experts x0c3 2 alteration block target 11 arguments hold true extent faster user xe2 x80 x99s transaction enters block likely users merchants resort trusting 0 conf transactions 1 mb block 2 5 minutes instead 10 minutes imply times transaction capacity limit limitations far pushed 1 mb block takes certain time propagate nodes network based latency nodes time takes verify block passed time takes transfer 1 mb data time fluctuates depending cpu speed nodes bandwidth nodes number nodes network factors depth analysis decker wattenhofer 7 long block propagation times negative consequences network best case lead higher orphan fork rate turn lead centralisation mining likelihood increasing propagation time rises worst case propagation time start exceed block target point entire decentralised network begin splinter consensus breaks comfortable margin allowed occasions network operates slower normal problems occur result frequent blocks mean lower difficulty target block lower security block combined increase forking means number confirms users wait recommended 530 users usually wait bitcoin transaction effect faster block times increased overhead extra header data sounds like small thing size million headers quickly starts add bloats blockchain size negative impact mobile spv wallet users fetch headers impact people trying use nodes hard drive space required longer chain download inevitably means nodes available turn detrimental effects network sadly virtual currency authors31 opted faster block targets makes good story sell good press currency claims xe2 x80 x9cwe handle transactions second visa xe2 x80 x9d adds problem problems immediately obvious users long network receives small transactions block32 propagation times remain fast appear works fine later currencies life transaction volume grows revealed claims essentially bogus 10 minutes optimal time room changes gulden operates 2 5 minute target 30 7 depending ask lack deep understanding problems involved nefarious reasons deception 32 case virtual currencies bitcoin 31 x0c3 3 proof stake 12 good compromise 2 5 minutes gives faster 1 conf regular confirms massively increasing number confirms user wait leaving room propagation times issue margin error bitcoin belief room lot lower 2 minutes okay starts head dangerous territory cases network operates slower normal 1 minute disaster waiting happen block target faster 2 5 minutes come technological advances improve propagation time order sustainable 2 5 minutes propagation improvements definitely agenda future gulden development 3 3 proof stake popular solution virtual currencies switched proof stake proof stake similar 3 1 replaces hash algorithm different goes step instead relying solely raw compute power instead involves unspent outputs hashing process e order miner needs certain coins currency question chances successfully mining block altered way quantity coins factors 33 surface sounds like fantastic solution supposed benefits xe2 x80 xa2 attacker need 50% staking coins instead 50% computing power perform attack xe2 x80 xa2 attacker disincentivised attacking attack coin hold significant stake xe2 x80 xa2 energy efficient xe2 x80 xa2 currency controlled people vested interest xe2 x80 x99s health instead miners want profit closer inspection apparent good sounds claimed benefits hold scrutiny pos suffers new problems major ones addressed 3 3 1 xe2 x80 x99unlocked wallet xe2 x80 x99 problem problem pos implementations face order stake private key needed majority pos wallets allow require user leave wallet unlocked state private keys sitting unencrypted memory makes users pos coins susceptible attack theft coins remote exploit34 trojans malware etc 33 34 ssl age coins commonly plays role heartbleed style attack instance x0c3 3 proof stake 13 3 3 2 xe2 x80 x98nothing stake xe2 x80 x99 problem pos potential flaw described xe2 x80 x99nothing stake xe2 x80 x99 problem commonly misunderstood think myth sadly true essence problem follows xe2 x80 xa2 distributed consensus real concept xe2 x80 x99the present xe2 x80 x99 chain constantly moves forwards new block representing step forward time relies concept work chain forward manner emulates time unlike real world virtual blockchain world possible xe2 x80 x99past xe2 x80 x99 rewrite history creating new different chain consists work original xe2 x80 xa2 ignoring possible flaws attacks35 works miners use real world36 resources order build chain build new attack chain require real world resources attack succeed miners built chain lose value earned exchange resources expended xe2 x80 xa2 pos hand makes use virtual resources secure chain building second chain37 exact resources built chain second chain succeeds miners mined chain stand lose profit resources expended phrase xe2 x80 x9cnothing stake xe2 x80 x9d comes xe2 x80 xa2 little incentive stop honest miners mining multiple chains attackers incentive course greater 3 3 3 bribing 3 3 2 possible38 attacker bribe xe2 x80 x99honest xe2 x80 x99 miners participate attacks paying miners slightly higher fee earn 3 3 4 stake grinding different ways implement pos39 thing common needs selection process competition process person people xe2 x80 x99mining xe2 x80 x99 block selected process needs place deterministic distributed way draw blockchain history way determine common implementation methods 35 discuss e g 50% attack time travel possible 37 multitude chains 38 theory hurdles practice 39 frustratingly complex making difficult properly analyse amounts xe2 x80 x99security obscurity xe2 x80 x99 36 x0c3 3 proof stake 14 1 select eligible miners deterministic xe2 x80 x99lottery xe2 x80 x99 like algorithm blockchain acts xe2 x80 x99random xe2 x80 x99 entropy winner winners selected algorithm based entropy 2 let eligible miners compete hash block regular pow like manner stake giving xe2 x80 x99discount xe2 x80 x99 difficulty hash need find process obvious point attacker try find exploit advantage stake grinding flaw works follows attacker uses processing power repeatedly alter generate vast xe2 x80 x99alternate xe2 x80 x99 histories going blocks finds stake win attacker generate multiple alternate chains manner xe2 x80 x99free xe2 x80 x99 limited processing power worst party allows party potential gain huge advantage attack chain desires best miners pos essentially degenerated somewhat difficult use erratic pow best xe2 x80 x99as good xe2 x80 x99 pow realistically worse designed operate manner 3 3 5 quantity staking coins attacker needs 50% currently staking coins 50% coins network impossible tell coins actually available staking impossible tell hard 50% 3 3 1 users don xe2 x80 x99t stake stake erratically reducing overall security coin 3 3 6 use old private keys related 3 3 2 problem40 private keys wallets hold value wallet emptied use example assume private key address x 1000000 coins address leave weeks send exchange swap euros assumption point account longer stake coins longer belong recipient transaction unfortunately half true present account past attacker selling coins euros rewind chain point owned coins proceed try stake new longer chain sale coins takes place attacker use 3 3 3 3 3 4 aid chance success case worst need attackers coins example people tend careless security 40 revolving time important difficult issue distributed computing x0c3 3 proof stake 15 things longer unlikely understand care accounts value attacker unlikely maintain proper security erase old wallet copies held money past attacker gain access wallet41 use perform attack expending upfront resources 3 3 7 stake build attack pos algorithms implement concept called xe2 x80 x99coin age xe2 x80 x99 longer output gone unspent larger staking weight reason usually 1 claim solves 3 3 2 xe2 x80 x99coin age xe2 x80 x99 xe2 x80 x99something stake xe2 x80 x99 claims dubious 2 claim makes mining fair people fewer coins larger chance eventually staking allegedly avoiding situation xe2 x80 x99centralisation xe2 x80 x99 xe2 x80 x99rich xe2 x80 x99 generate income staking eventually come dominate coins result 3 users log occasionally stake instead trying work constantly working problem described 3 3 1 unfortunately xe2 x80 x99coin age xe2 x80 x99 sounds like nice idea stated benefits nice introduces unexpected flaw system worth remembering order perform 50% attack attacker need system constant basis period time long carry attack attacker ordinarily 10% hash temporarily gain larger weight perform attack regardless coin age unfortunately allows exactly carefully creating addresses leaving coins build weight attacker slowly xe2 x80 x99build xe2 x80 x99 attack capacity wait right moment attack second possible problem coin age42 users deterred money lose coin age stake argued leads situation users pos coin xe2 x80 x99hoard xe2 x80 x99 coins leading poor liquidity poor distribution ultimately undesirable currency 3 3 8 problems spv wallets relatively large problem pos possible verify validity block chain history chain history required stakers signature actually valid eligible 41 worst case old wallet large exchange instance specifically technical problem economic case blockchains overlap 42 x0c3 4 combined pos pow 16 winning effect spv wallets wallet implementation lightweight mobile wallets conjunction pos order functioning mobile wallets pos based coin necessary use 3 7 potentially desirable trade offs 3 4 combined pos pow coins like peercoin xe2 x80 x93 combine pos pow xe2 x80 x93 theory makes coin twice secure reality doesn xe2 x80 x99t hold true problem pow pos miners competing generate blocks 43 turn means orphans fewer profits miners means reduced hash rate best means gains expected worst means actually makes security worse multiple pos blocks row common sight pos required perform attack vice versa multiple pow blocks row common sight pow required perform attack short instead strong instead strong weakest opening coin attacks44 3 5 multi algorithm concept implemented coins use multiple hashing algorithms instead miners different algorithms compete blocks difficulty algorithm adjusted independently blocks found attempt balance things way algorithm finds blocks real papers provide thorough analysis supposed benefits claimed benefits proponents tend follows xe2 x80 xa2 improves decentralisation xe2 x80 xa2 reduces impact xe2 x80 x99jump xe2 x80 x99 pools block times xe2 x80 xa2 improve blockchain security overall hashing power available algorithms times hashing power xe2 x80 xa2 claims outlandish sounds good paper examined closer claims don xe2 x80 x99t hold non exhaustive list problems 43 taking quick look block explorer peercoin shows cases 7 pos blocks mined 1 pow 44 new pos attacks like grinding possible combination normal pow attack x0c3 5 multi algorithm 17 xe2 x80 xa2 overall hashing doesn xe2 x80 x99t actually increase reason follows incentive miners coin financial gain usually external currency e g selling mined coin immediately market usd 1 algorithm consider hash power reach equilibrium based price x people willing pay mining profitable miners stop mining introduce algorithms example introducing 4 algorithms 5 total price people willing pay going magically increase result algorithm price people willing pay x 5 miners original single algorithm earning 1 5th earned meaning likelihood 1 5th hash rate remain rest stop mining likewise new algorithms attract 1 5th hash rate coin algorithm leading situation equivalent hash rate algorithm 45 xe2 x80 xa2 difficulties xe2 x80 x99balancing xe2 x80 x99 algorithms people mistake assuming quantity hash mining blockchain measure secures understandable mistake half true hash course secure truth bit complicated true measure blockchains security lines xe2 x80 x99network hash rate hash algorithm total worldwide available hash rate algorithm xe2 x80 x99 e network mined 50 000 hashes second makes big difference exists world capability 60 000 hashes second exists capability 60 000 000 hashes second secure xe2 x80 x99normal xe2 x80 x99 single algorithm coin like bitcoin distinction important matters network hash possible hash secure network accepts block adds work chain introduce multiple algorithms a1 a2 a3 distinction important network needs able deterministically pick blocks mined different miners required decide beneficial chain a1 block mined 50 000 hashes second a2 block mined 1000 hashes second a3 block mined 500 000 hashes second algorithms different performance characteristics longer simply pick xe2 x80 x99largest xe2 x80 x99 hash instead optimal way decide a2 a3 a1 t otglobalhashrate a2 t otglobalhashrate a3 46 sadly max t otglobalhashrate a1 impossible human determine given point 45 increased orphaning loses explained following points actually lead loss hash rate 46 totglobalhashrate total hash rate exists algorithm x0c3 6 master nodes 18 time mind deterministically reproducible way world constantly changing compromise static weighting assigned code a2 a3 algorithm max staticwa1 a1 staticw a2 staticw a3 decide unfortunately depending accurate weightings best leads inefficiencies system47 worst opens system easier attack 48 users tend perceive blocks going algorithm xe2 x80 x99imbalance xe2 x80 x99 developers tend try weight selection way algorithms xe2 x80 x99fair xe2 x80 x99 share blocks unfortunately weakens security system selection criteria blocks matter xe2 x80 x99perceived fairness xe2 x80 x99 opposed xe2 x80 x99which block actually secures system attack xe2 x80 x99 xe2 x80 xa2 attack vectors algorithm added attack vectors code times hashing algorithms find weakness complex difficulty adjustment code find weakness etc 3 6 master nodes dash introduced xe2 x80 x98instant payment xe2 x80 x99 supposedly secure uses system xe2 x80 x98master nodes xe2 x80 x99 handle instant payment xe2 x80 x99master nodes xe2 x80 x99 act extra control layer network communicating problem order function xe2 x80 x99master nodes xe2 x80 x99 act centralised way solve problems blockchain necessary place follows reason speculated likely variety ways system attacked find proper analysis showing details necessary determine sake brevity won xe2 x80 x99t detail concept lack proof master nodes fact function claimed rule solution gulden perspective 3 7 checkpoint server coins xe2 x80 x93 included resorted checkpoint server help prevent double spends extremely effective method having checkpoint server run set depth49 possible prevent 50% attacks transaction block depth checkpoint making transactions safe double spend downsides system world universe 47 picking best block obtaining optimal network security 48 weightings incorrect attacker gain huge advantage focusing attack mainly algorithm 49 3 blocks instance x0c3 8 difficulty adjustment algorithms 19 1 checkpoint server compromised person running ill intentions checkpoint system misused help perform double spends attacks essentially cost attacker malicious uses like transaction censoring exist 2 concerns government authority force developers censor transactions 3 centralized nature use checkpoint server render coin illegal subject regulation jurisdictions 4 checkpoint server centralized point failure attacked brought disrupt network works solution 3 conf more50 ensure larger targets like exchanges operated safely 50% attack provide solution regular users need faster confirmations users don xe2 x80 x99t understand risks involved despite downsides running checkpoint server absolute necessity smaller virtual currency point small virtual currency acting responsibly putting users large risk hope remove checkpoint server near future primary purposes paper 3 8 difficulty adjustment algorithms coins xe2 x80 x93 included resorted increasingly advanced difficulty algorithms try block times stable face jump pools great progress difficulty adjustment algorithm51 brought block times previously erratic stable controlled state 52 algorithm incorporates heuristics help improve prediction capabilities fallback mechanism detects block taking long lowers target difficulty reducing effects 2 9 53 despite success stable like ultimately limitations achieved difficulty adjustment algorithm attempts predict future based information imperfect wrong instances seen fact occasional block ends taking 17 20 minutes instead 50 assuming willing accept decentralised aspect depending depth checkpoint 51 code delta statistics improvements seen nlgstats nl 12 52 coins like litecoin far hash power disposal struggle block times stable blocks day wildly swinging 400 800 cryptoid info 6 53 difficulty drop careful manner cognisant maximum block drift time allowed avoid consensus issues x0c20 2 5 minute target 54 complete accuracy obviously possible statistical nature process larger problem imperfect55 timestamp information blocks self reported miners 2 6 2 subject fairly large allowance adjustment forwards backward time leaves little room improvement huge usability problem 4 proposed solution problems consideration issues trial error come consider viable ideal solution issues issues possible belief represents giant leap forward area decentralised virtual currencies solution implemented gulden release56 shortly paper solutions presented paper trialed 4 1 pow xc2 xb2 improved successor pow 4 1 1 naive basic concept despite problems listed pos 3 3 combined pos pow 3 4 core idea pos57 interesting enticing surprise captivated people current ideas implementations involving flawed ways doesn xe2 x80 x99t mean idea good needs applied differently thought issues involved xe2 x80 x99ve come alternative way use idea different way brings benefits fewer problems pow xc2 xb2 works follows xe2 x80 xa2 distinct class miners network pow miners pos miners referred witnesses 58 xe2 x80 xa2 mining blocks pow miners usual manner pow systems xe2 x80 xa2 miner finds block submitted network xe2 x80 xa2 nodes validate accept relay block usual added tip chain 54 drastic improvement times 7 hour blocks instance means perfect 55 best times utterly wrong 56 code prime awaiting 57 involving stake users system process securing system 58 order better emphasize role play system x0c4 1 pow xc2 xb2 improved successor pow 21 xe2 x80 xa2 block point pre witnessed state 59 xe2 x80 xa2 receiving pre witnessed block eligible witness sign block private key converting witnessed block 60 xe2 x80 xa2 step witnessing involves adding additional data block includes witness timestamp61 additional transactions62 subject existing block size limit transaction pay witness fee 63 xe2 x80 xa2 witness attempts sign block 64 xe2 x80 xa2 soon valid witnessed block created rebroadcast network 65 xe2 x80 xa2 peers receive witnessed block add tip chain usual proceeds normal pow miners attempt new block new tip chain cycle repeats relatively simple change things work currently larger important impact think read key impacts system xe2 x80 xa2 witnesses add transactions non blocks fees unlike pow miners witnesses actively hold portion currency result vested interest healthy network acts additional incentive witnesses honest witnesses highly incentivised add transactions blocks witness possible means network able operate efficiency terms transaction capacity throughput hampered blocks 2 7 cases transactions waiting added blocks 66 xe2 x80 xa2 witnessing block pow miner longer immediately second block follows necessary witnessed 59 like unprocessed iron ore pulled ground near instant process near instant possible 61 allowing massive improvement 2 6 2 62 acting countermeasure 2 7 2 63 includes transaction fee transactions added witness 64 manner best compared similar existing pos systems witness selection system unique properties including minimal delay 65 note isn xe2 x80 x99t necessary rebroadcast pow block peers additional witness portion needs broadcast additional overhead block doesn xe2 x80 x99t sent peers twice 66 true blocks possible require miner witness participate adding transactions chance manage block conspiracy huge majority miners witnesses probability incredibly small 60 x0c4 1 pow xc2 xb2 improved successor pow 22 result selfish mining 2 3 longer feasibly possible controlling substantial percentage hash rate coins circulation 67 xe2 x80 xa2 provides good resistance private chains 2 4 68 xe2 x80 xa2 50% attack 2 2 pow miners incredibly difficult achieve 50% probability controlling specific block regular pow coin xe2 x80 x99merely xe2 x80 x99 requires 50% hash rate 69 formula p x xe2 x88 xa9 y p x xc3 x97 p y 70 pow xc2 xb2 achieve 50% chance controlling specific block approximately 71% hash rate 71% coin supply p 0 71 xe2 x88 xa9 0 71 0 504 90% hash rate 56% coin supply p 0 90 xe2 x88 xa9 0 56 0 504 95% coin supply 53% hash rate p 0 95 xe2 x88 xa9 0 53 0 5035 required substantial increase overall network security factoring likely drop pow hash rate reward witnesses appendixb page 35 analysis xe2 x80 xa2 point question self interest relevant e somebody 53% 71% coin supply going attack network hold large stake attackers likely disincentivised attacking coin extent xe2 x80 xa2 practical implication that71 transaction 1 confirmation pow xc2 xb2 coin treated relatively secure72 2 3 confirmations incredibly secure vs standard pow coin 6 7 confirmations generally considered desirable level security displayed appendixb page 35 produced modified source code taken satoshi whitepaper nakamoto 11 source code displayed appendixe page 39 course perfect system especially naive implementation comes sides case pow xc2 xb2 xe2 x80 xa2 complex code base extra code implement pow xc2 xb2 introduce extra complexity system extra complexity means room error 67 order block witnessed miner need broadcast network point know true miner theoretically witness blocks detail later realistically possible 68 reason caveat 69 actually little 33% 70 intersection disjoint probabilities x y equal probability x multiplied probability y 71 assuming distributed coin coin holders willing participate witnessing process things guarded proper client implementation connected peers spoofed instance 72 helping reduce instances 2 1 1 x0c4 1 pow xc2 xb2 improved successor pow 23 added complexity great functioning system simple elegant properly reasoned evaluated feel like cause concern unlike instance pos solutions xe2 x80 xa2 extra chance blockchain stalling having types miners involved system means points failure blockchain stall lack witnesses lack pow miners long conscious possibility difficult design system way mitigate risk xe2 x80 xa2 security risks wallets staking pos implementations 3 3 1 witnesses need private key order sign security issue adequately addressed addressed xe2 x80 xa2 difficulties spv wallets pos implementations difficulty spv mode mobile wallets 3 3 8 pow xc2 xb2 partially inherits unlike pos prevent spv implementation spv nodes capable verifying pow block witness portion witness algorithm requiring blockchain order calculate valid witnesses adequate function secure way security slightly downgraded pow xc2 xb2 node 73 worth noting xe2 x80 x99degraded xe2 x80 x99 security essentially worst par pow spv node implemented right possibly secure pow spv node spv gain pow xc2 xb2 verifying node harmed necessary refine process try address minimise downsides 4 1 2 optimised concept opportunities improve initial naive concept 1 opt participation usual pos implementations network able stake unfortunate effects impossible tell coins actively protecting network vs e g coins cold storage lost ability rough idea total number staking coins harder gauge expense possible attack impossible know secure network given moment worse people 73 case spv node x0c4 1 pow xc2 xb2 improved successor pow 24 intention staking selected stake74 leading erratic block times result improvement changing opt system coins xe2 x80 x99special xe2 x80 x99 addresses stake total number coins securing network easily enumerated suspicious activity monitored witnesses selected eligible pool 2 time based participation arguments leveled pos gives power large coin holders unlike pow burns electricity value xe2 x80 x9cat stake xe2 x80 x9d pos system expense staker signs block stop signing competing blocks way dealing ties opt participation introduce time concept staking accounts placing coins staking account user pick time period funds locked similar regular banking systems fixed period savings accounts user unable spend coins account lock time expired able stake user real xe2 x80 x9cat stake xe2 x80 x9d liquidity money time period factored equation determining stake weight account users choose lock funds longer periods time stake frequently gives opportunity users fewer coins stake coins helping level playing field extent beneficial network users willing lock coins long periods time likely long term health network mind likely attack network allowing users stake frequently security network improved attacker succeed attacking network likely lock coins long period time desirable attacker acts obstacle attacker contend finally users tying portion wealth fixed term decrease number coins 100% liquid bring positive impacts currency users unable rapidly exchange coins moments panic hysteria lead slightly stable market currency prone giant spikes dumps price attract users long term mindset reward balanced excessive benefits achieving undesirable effect drastically decreasing overall market liquidity absence users actually use coin day day basis 3 double key based participation changing staking address system use instead private public key pair possible solve 74 case xe2 x80 x99follow satoshi xe2 x80 x99 style implementation x0c4 1 pow xc2 xb2 improved successor pow 25 security issue staking wallets staking address keys associated spending key second staking key spend funds account signature keys required stake signature staking key required wallet spending key safely encrypted leave staking key unencrypted allowing wallet stake concern stolen staking key stolen attacker steal funds stake behalf victim improvement allow users participate staking beneficial network security 4 witness selection algorithm carefully adjusting witness selection algorithm ways potential attacker disadvantage possible improve security model attack harder 5 exist interesting possibilities pow xc2 xb2 offer e g possibility witnesses allowed temporarily increase block sizes certain situations help address high transaction traffic periods safe way address scaling sorts ideas best discussed later detail 4 1 3 implementation details gulden gulden making use optimised version pow xc2 xb2 following details xe2 x80 xa2 witnessing opt users create transfer funds xe2 x80 x99witness account xe2 x80 x99 order participate process xe2 x80 xa2 accounts use special address scripts blockchain serve indicator network intended participate witnessing special network rules apply addresses facilitate process witnessing details appendixa page 33 xe2 x80 xa2 witness addresses derived key pairs instead network allow normal spend operations key special witness related operations second allowing wallets witness blocks wallet open exposing funds risk theft having enter password point 75 allows set special backup witnessing devices software ensure witnessing continues wallet offline xe2 x80 xa2 theoretically allows party services witness behalf user witness key reward portion operation paid address allowing services 75 spending key remains encrypted memory wallet keys normally x0c4 1 pow xc2 xb2 improved successor pow 26 reward fee ease witnessing hardware servers ensure witnessing service obtains overly large portion addresses xe2 x80 xa2 witness addresses will76 creation fixed xe2 x80 x99maturity xe2 x80 x99 time period set future block number address mature maturity period determined user maximum minimum77 period network allows network accept spends address time time period expired allow address witnessing time xe2 x80 xa2 algorithm witness selected include quantity coins fixed time period selection factor putting attackers disadvantage lock money long periods time order compete legitimate holders xe2 x80 xa2 minimum cool period 100 blocks78 apply signing block address eligible sign ensures large weighting user dominate network significant way single address details appendixa page 33 xe2 x80 xa2 weighting slightly biased accounts coins longer time periods address 50000 coins higher chance winning given block address 25000 given time period penalizes attacker order succeed 50% attack require multiple addresses reducing impact coins increasing expenditure needed order succeed 79 xe2 x80 xa2 algorithm implement sort coin weight concept80 unnecessary functioning introduce flaws instead maturity period allow fewer coins xe2 x80 x99fair xe2 x80 x99 chance compete opting longer maturity period lack coins xe2 x80 xa2 algorithm witnesses selected random lottery style system mining style system second type prone grinding attacks details appendixa page 33 76 custom script commands 1 month 3 years appendix details 78 chosen match 100 block maturity period imposed pow miners 79 attack depth 5 blocks instance attacker require 5 addresses splitting funds 5 80 avoiding flaws like 3 3 7 77 roughly x0c4 1 pow xc2 xb2 improved successor pow 27 xe2 x80 xa2 witness addresses witnessed certain period time81 temporarily removed pool eligible addresses required perform xe2 x80 x99refresh xe2 x80 x99 transaction fee order eligible prevent build non participating systems cause system stall xe2 x80 xa2 block reward pow miners lowered 100 80 remaining 20 allocated witnesses leaving overall reward unchanged potentially82 lead slight drop overall mining power available pow mining network 83 xe2 x80 xa2 transactions included pow portion block considered having 1 confirmation transactions witness portion considered wallets having 0 confirmations time subsequent pow block mined 84 purposes worthwhile consider transactions witness portion having 12 confirmation implement concept consideration later date xe2 x80 xa2 spv wallets recognise transactions having 1 confirmation verified pow portion block note case normal wallets spv different reasons spv wallet confirm witness portion don xe2 x80 x99t blockchain fact potential witnesses drawn 10000 blocks fixed upper bound memory complexity process possible spv peers verify witness portion future development required area pursued initial launch additional concept xe2 x80 x99trusted peers xe2 x80 x99 introduced spv wallets future aid general protection sybil attacks 2 8 xe2 x80 xa2 difficulty adjustment algorithm use timestamp witness portion instead pow portion enable better accuracy remove pow miners ability tamper pow 81 proportionate weighting chaotic nature markets effect mining hash rate isn xe2 x80 x99t 100% possible predict impact certainty 83 choice reward split degree arbitrary overarching factors determine selection maintaining high overall pow hash rate crucial functioning system pow reward needs attract hash rate possible theoretically infinite growing pool global hash rate witness reward contrary needs high attract witnesses finite coin supply participate doesn xe2 x80 x99t need attract infinite overly high witness reward detrimental market effects like hoarding pow portion acts important means coin distribution liquidity 84 information 4 1 5 82 x0c4 1 pow xc2 xb2 improved successor pow 28 difficulty 85 detailed explanation analysis witness selection algorithm found appendixa page 33 4 1 4 analysis pow xc2 xb2 known flaws attacks faced existing algorithms xe2 x80 xa2 50% attacks 2 2 network resistance 50% attacks greatly increased point 1 conf transactions secure purposes xe2 x80 xa2 selfish mining 2 3 possibility selfish mining substantially reduced essentially possible xe2 x80 xa2 dos mining blocks 2 7 2 difficulty achieving greatly increased essentially possible xe2 x80 xa2 erratic inaccurate block times 2 6 accuracy block times greatly increased time controlled pos miners pow miners turn allows better functioning difficulty adjustment algorithm xe2 x80 xa2 pos insecure private keys 3 3 1 private keys secured times xe2 x80 xa2 stake issue 3 3 2 substantial pow hash power involved pow hash stake xe2 x80 xa2 pos stake buildup 3 3 7 coinage involved system immune xe2 x80 xa2 pos stake grinding 3 3 4 grinding achieved mining new pow blocks substantial pow hash rate involved grinding infeasible xe2 x80 xa2 pos old private keys 3 3 6 old private keys hold attack value ridiculously high pow hash work 4 1 5 consideration new flaws attacks exist new possible xe2 x80 x99weak points xe2 x80 x99 system 1 witness algorithm selects winner exists likelihood times winner available perform witness duty obvious way address introduce multiple winners system redundancy similar previous systems tried unfortunately vastly weakens system opening grinding attacks vulnerabilities 85 timestamp block acceptance witness timestamp difficulty adjustment x0c4 1 pow xc2 xb2 improved successor pow 29 instead rely pow miners pow miners find block stop mining continue attempting create competing blocks receive news witnessed block new block mined randomly select new single witness provides variation required overcome stalling introducing vulnerabilities come multiple witnesses ordinarily concerns long process example 3 witnesses row present block takes 5 minutes 15 minute wait 10 witnesses row missing 50 minutes etc potential accidental stalls deliberate dos attack difficulty adjustment algorithm delta ordinary special mechanism built safely lower difficulty cases block times overly long assures wait longer quantity pow blocks mined frequent minimising delay situations 86 reduces stalling worst minor inconvenience instead major attack vector opt nature system mechanisms having large percentage chance selected difficult expensive fact non participating witnesses regularly xe2 x80 x99pruned xe2 x80 x99 system need pay fee enter system work ensure pool xe2 x80 x99fittest xe2 x80 x99 witnesses long term sustained attempt achieving dos attack way impractical costly 2 selected witness need perform expensive work perform signing possibility exists witness attempt dos attack network signing multiple blocks varying transactions data sending different peers worth noting specifically unique pow xc2 xb2 conducted normal pos coin simply powerful hardware like asic miner case existing flaw bit obvious thankfully overly difficult deal situation simply putting network rules place xe2 x80 xa2 clients request witness blocks headers contain base pow block header block received xe2 x80 xa2 clients forward multiple headers containing base pow block xe2 x80 xa2 clients assign misbehaviour score subsequent header containing base pow block 86 subtle detail turns important puzzle pieces concept possible lack feature previously possibly prevented pow xc2 xb2 appearing sooner x0c30 xe2 x80 xa2 clients eventually ban peers multiple blocks case different nodes end different witness block network quickly come consensus pow block mined 87 5 secure 0 conf solution code prime ii existence xe2 x80 x9ctwo layered xe2 x80 x9d network brought prime allows interesting possibilities important potential mechanism secure 0 conf transactions price desirable mechanism work follows 1 2 3 4 5 6 7 87 occasional brief forking blockchains work cause alarm x0c31 let evaluate chances success order succeed attacker need following 1 2 3 probability brings valuable additional capability network capability opt comes price transaction costs secure 0 conf transactions higher normal transaction require functionality cost worth specific subset transactions needs absolutely instant confirmation addition obvious benefit secure 0 conf obvious benefits new possibilities brings terms network scalability mentioned earlier paper hot topic moment important problem solve x0c32 6 conclusion paper looked challenges faced gulden virtual currencies strength weaknesses blockchain current form solutions offered possible ways counter weaknesses looked positive aspects solutions aspects exist shortcomings based proposed exciting new way forward pow xc2 xb2 consider generation step building solutions simple description manages significantly improve weaker aspects traditional pow blockchain drastically enhance network security way feels natural introduce massive complexity new failure modes briefly touched exciting future possibilities pow xc2 xb2 enables including way allowing secure 0 conf transactions enabled network suggestions paper implemented gulden coming months starting pow xc2 xb2 secure 0 conf following shortly afterward x0c33 appendixa witness selection algorithm critical pow xc2 xb2 algorithm determines selection witness mined block process following requirements 1 needs random 2 needs deterministic e rely additional network communication 3 resistant grinding attacks possible gain mechanical advantage 4 possible gain advantage having multiple accounts 5 possible predict winner advance 6 light resources possible 7 lead forks blockchain possible 8 needs fast efficient exhaust huge amounts memory introduce little delay system possible discarded possibility hashcash 1 based system fails meet criteria 3 5 7 aside hashcash remaining possibility kind random selection blockchain seed existing computer science literature algorithm perfect task genetic algorithms known xe2 x80 x99roulette wheel selection xe2 x80 x99 b xc3 xa4ck 2 perfect fit task image page 35 brief understanding selection works algorithm work follows note arithmetic uint256 appropriate basing precision avoiding floating point xe2 x80 xa2 valid witness input unspent output constructed special witness script included 10000 blocks chain 88 xe2 x80 xa2 witness inputs subject following restrictions 1 locked minimum 17280 blocks creation approximately 1 calendar month 2 locked maximum 630720 blocks creation approximately 3 years 3 minimum 5000 coins minimum weight 10000 89 xe2 x80 xa2 witness inputs newly created result previous witnessing operation 100 blocks excluded 88 constant time requirement scan backward chain prohibit pruning utxo 89 subject adjustment future x0c34 xe2 x80 xa2 witness scripts inserted array deterministic fashion age second90 quantity finally91 block order xe2 x80 xa2 witness scripts assigned weighting based quantity time blocks unspendable92 weighting designed way beneficial user weight account possible instead multiple t ime xc3 x97 2 xe2 x88 x92 1000094 accounts93 w quantity xc3 x97 1 576 xc3 x97365 xe2 x80 xa2 second pass values inputs older 95 max t otalnw eworkw xc3 x97 2 200 removed consideration xe2 x80 xa2 final pass values witness weight exceeds 2% overall weighting taken second pass reduced 2% weighting 96 xe2 x80 xa2 sha256 hash pow block converted 256 bit seed integer use normal scrypt pow hash deliberately avoided prevent theoretical manipulation attempted means varying difficulty certain ranges 97 xe2 x80 xa2 seed integer multiplied 2 exceeds final overall wheel weighting prevent bias specific ends wheel certain difficulties xe2 x80 xa2 roulette wheel selection select winning witness array spin starting 0 allow efficient calculation 98 meets requirements completely random deterministic99 opportunity grinding100 maximum cap algorithm complexity resource usage splitting coins multiple accounts overall weighting weakening attackers impossible predict winner advance block arriving time delay 90 case identical age case identical quantity 92 set user address creation 93 important diminish effect attacker network 94 actual code implementations calculation rebased avoid floating point left clarity 95 prevent stale inactive witnesses stalling chain repeatedly 96 change affects final overall weighting actual result slightly different 2% fine attempt adjust 97 unlikely legitimate case think difficulty gets high 98 algorithmically modulus seed%t otalw eighting binary search array appropriate place 99 long care avoid floating point 100 pow generation address paper 91 x0c35 accepting witness witness selected forking takes place algorithm appendixb attack probability naive 101 pow xc2 xb2 combines regular pow witnessing power coin holders way lead minimal drop pow hash rate time substantially enhancing blockchain security bringing desirable properties table difficult grasp significant change best proper visualisation illustrate xe2 x80 x99ve taken code nakamoto 11 appendixb modified slightly purposes102 run generate visualisation page 38 process following figures taken time writing 100% accurate purposes sufficient xe2 x80 xa2 gulden network hash rate scrypt 50 gh s 101 biased pow core equation unchanged 102 original x0c36 xe2 x80 xa2 cost rent scrypt mining rigs 20 gh s hours rental $132103 e $6 6 gh s xe2 x80 xa2 cost purchase scrypt mining rigs $5400 gh s xe2 x80 xa2 gulden price 1 nlg $0 02 xe2 x80 xa2 gulden availability largest exchange 5 000 000 nlg xe2 x80 xa2 gulden circulation 444 413 900 following assumptions xe2 x80 xa2 20% coin holders participates witnessing total 88 882 780 coins likely impossible sure real implementation coin holders participate increase number coins required perform attack increase costs attack xe2 x80 xa2 overlook possibility renting hash attacking current hash rate rented hash simply cheap compare $165 larger hash rates coins different algorithms rental option constructive ignore rental noted fact rental attack possible gulden104 makes case pow xc2 xb2 stronger rental attack considered gap pow xc2 xb2 pow larger xe2 x80 xa2 assume 10% reduction network hash rate pow xc2 xb2 accommodate fact portion reward pos miners legitimate reasons believe drop hash rate actually 105 sake comparison want things bad pow xc2 xb2 possibly xe2 x80 xa2 ignore market effect buying larger amounts coins order attack pow xc2 xb2 coin price 106 drive cost acquiring coins attack affect network hash rate 107 cost estimates pow xc2 xb2 attacks especially ones involving larger amounts coins likely vast underestimates cost drastically reality 103 prices appendix usd currently protected checkpointing 105 network hash rate ultimately dictated market price coin 106 largest exchange 5 000 000 coins available sale moment purchase 3 000 000 coins likely measurable impact market price 107 coins worth network hash rate attracted 104 x0c37 attack probability conclusion chart following page clearly illustrates comparison favour pow possible way pow xc2 xb2 vastly outperforms pow terms security given attack price scenario vastly money thrown attack pow xc2 xb2 continues offer protection pow $1030534108 pow xc2 xb2 remains secure $137700 possible gain complete control equivalent pow network 60% hash rate 60% coins 20% risk 9 confirms confirms low risk good transactions attack price point109 50% attack pow network pow xc2 xb2 network yields 1% chance success attacker leading terming xe2 x80 x99secure 1 conf xe2 x80 x99 transactions110 purposes 2 3 confirmations reasonably secure sensitive transactions appendixc analysis attack probability grinding astute notice course ignored possibility instead opting e g 60% pow hash 60% witness coins attacker instead attempt grinding attack aim times network hash rate 10% coins total cost $1 257 765111 mining 4 times pow blocks chances selected witness block instead 1 probability follows xe2 x80 xa2 p signingblock 1 xe2 x88 x92p notsigningblock numattempts 1 xe2 x88 x92p 1 xe2 x88 x92signingblock 4 1 xe2 x88 x92 p 1 xe2 x88 x92 0 10 4 1 xe2 x88 x92 p 0 9 4 1 xe2 x88 x92 0 6561 0 3439 roughly 35% chance signing single block instead 10% coins normally entitle substantial expense compared plain 50% attack grinding possible extent pow xc2 xb2 resilient point likely effectual reasonable network hash rates involved particular case grinding attempt costs slightly xe2 x80 x9c60% pow 60% witness xe2 x80 x9d attack lower probability success 112 108 actually underestimate price coins cost far acquire 109 reality likely cost 110 secure relative common instance bitcoin users refer 5 6 7 conf xe2 x80 x99secure xe2 x80 x99 security relative seen probability analysis graph 111 hash rate 50 xe2 x88 x97 4 xe2 x88 x97 5400 $1080000 coins 88882780 xe2 x88 x97 0 1 xe2 x88 x97 0 02 177765 112 costs fluctuate based factors involved coin price witness supply network hash rate forth vary cheaper given time x0c38 appendixd attack probability analysis graph naive 113 100 pow pow xc2 xb2 attacks similar costs paired colour comparison 90 $usd 13500 pow 5% hash $usd 27000 pow 10% hash $usd 20206 pow xc2 xb2 1% hash 1% coins 80 $usd 40500 pow 15% hash $usd 40413 pow xc2 xb2 2% hash 2% coins $usd 81000 pow 30% hash 70 $usd 80826 pow xc2 xb2 4% hash 4% coins $usd 137700 pow 51% hash 60 $usd 141445 pow xc2 xb2 7% hash 7% coins pow xc2 xb2 worth evaluating point $usd 303098 pow xc2 xb2 15% hash 15% coins 50 $usd 323565 pow xc2 xb2 60% hash 10% coins $usd 606196 pow xc2 xb2 30% hash 30% coins 40 $usd 1030534 pow xc2 xb2 51% hash 51% coins probability attack success $usd 1212393 pow xc2 xb2 60% hash 60% coins 30 20 10 9 8 7 6 5 4 3 2 1 1 2 3 4 5 6 number blocks transaction 113 biased favour pow 7 8 9 x0c39 appendixe attack probability source code code borrowed adapted nakamoto 11 calculates114 function attackersuccessprobability chances success attacker attacking chain depth q probability z pow feed percentage hash rate probability pow xc2 xb2 use p p ow xe2 x88 xa9 w itness p p ow xc3 x97 p w itness ignores witness witness blocks row reducing probability subsequent block enhancements discussed paper results biased favour pow n c l u d e o s t r e m n c l u d e iomanip n c l u d e math h double double double double pricepergh 5 4 0 0 0 networkhashrate 5 0 0 pricepercoin 0 0 2 networknumcoins 8 8 8 8 2 7 8 0 0 double t t c k e r s u c c e s s p r o b b l t y double q n t z double p 1 0 xe2 x88 x92 q d o u b l e lambda z q p d o u b l e sum 1 0 int k f o r k 0 k z k d o u b l e p o s s o n exp xe2 x88 x92lambda f o r 1 k p o s s o n lambda sum xe2 x88 x92 p o s s o n 1 xe2 x88 x92 pow q p z xe2 x88 x92 k r e t u r n sum 1 0 0 n t attackercost double percenthashrate double percentcoins n t hashcost pricepergh networkhashrate p e r c e n t c o n s 0 0 0 9 1 p e r c e n t h s h r t e n t c o n c o s t p r c e p e r c o n networknumcoins p e r c e n t c o n s r e t u r n hashcost c o n c o s t v o d printpowattack d o u b l e p e r c e n t g e 114 slightly naive useful way x0c40 s t d c o u t xe2 x80 x9d pow xe2 x80 x9d n t p e r c e n t g e 1 0 0 xe2 x80 x9d% hash xe2 x80 x9d s t d c o u t t t c k e r c o s t p e r c e n t g e 0 0 xe2 x80 x9d xe2 x80 x9d f o r n t 0 10 s t d c o u t xe2 x80 x9d xe2 x80 x9d s t d f x e d s t d s e t p r e c s o n 1 2 xe2 x80 x9d xe2 x80 x9d t t c k e r s u c c e s s p r o b b l t y p e r c e n t g e xe2 x80 x9d n xe2 x80 x9d v o d printpow2attack d o u b l e percentagepow d o u b l e percentagepos s t d c o u t xe2 x80 x9d pow xc2 xb2 xe2 x80 x9d n t percentagepow 1 0 0 xe2 x80 x9d% hash xe2 x80 x9d n t percentagepos 1 0 0 xe2 x80 x9d% c o n s xe2 x80 x9d s t d c o u t t t c k e r c o s t percentagepow percentagepos xe2 x80 x9d xe2 x80 x9d f o r n t 0 10 s t d c o u t xe2 x80 x9d xe2 x80 x9d s t d f x e d s t d s e t p r e c s o n 1 2 xe2 x80 x9d xe2 x80 x9d t t c k e r s u c c e s s p r o b b l t y percentagepow percentagepos xe2 x80 x9d n xe2 x80 x9d n t main printpowattack 0 0 5 printpow2attack 0 0 1 printpow2attack 0 0 2 printpow2attack 0 0 4 printpow2attack 0 0 7 printpow2attack 0 6 printpow2attack 0 5 1 r e t u r n xe2 x88 x921 printpowattack 0 1 0 0 1 printpowattack 0 1 5 0 0 2 printpowattack 0 3 0 0 4 printpowattack 0 5 1 0 0 7 printpow2attack 0 1 5 0 1 5 0 1 printpow2attack 0 3 0 3 0 5 1 printpow2attack 0 6 0 6 x0c41 nomenclature hashcash hashcash proof work system limit email spam denial service attacks recently known use bitcoin cryptocurrencies mining algorithm pos proof stake pow proof work pow xc2 xb2 proof work 2 proof work squared new system achieves massive security gains multiplying security proof work witness signatures scrypt cryptography scrypt pronounced ess crypt passwordbased key derivation function created colin percival originally tarsnap online backup service spv simplified payment verification lighter faster method mobile wallets nakamoto 2009 witness context pow xc2 xb2 witness holder coin places coins special time locked account uses locked coins sign pow blocks valid 1 hashcash 1997 hashcash url http www cypherspace org 2 thomas b xc3 xa4ck evolutionary algorithms theory practice evolution strategies evolutionary programming genetic algorithms oxford university press oxford uk 1996 isbn 0 19 509971 0 3 bitcoinwiki block size limit controversy bitcoin wiki url https en bitcoin wiki block size limit controversy 4 blockchain info bitcoin blocks height 465740 blockchain info block height 465740 url https 5 blockchain info bitcoin blocks height 465754 blockchain info block height 465754 url https 6 cryptoid info litecoin explorer url https chainz cryptoid info ltc overview 7 c decker r wattenhofer information propagation bitcoin network ieee p2p 2013 proceedings pages 1 xe2 x80 x9310 sept 2013 doi 10 1109 p2p 2013 6688704 x0c42 8 john r douceur sybil attack revised papers international workshop peer peer systems iptps xe2 x80 x9901 pages 251 xe2 x80 x93 260 london uk uk 2002 springer verlag isbn 3 540 44179 4 url http dl acm org citation cfm id 646334 687813 9 ittay eyal emin g xc3 xbcn sirer majority bitcoin mining vulnerable corr abs 1311 0243 2013 url http arxiv org abs 1311 0243 10 juan garay aggelos kiayias nikos leonardos bitcoin backbone protocol analysis applications pages 281 xe2 x80 x93310 springer berlin heidelberg berlin heidelberg 2015 isbn 978 3 662 46803 6 doi 10 1007 978 3 662 46803 6 10 url http dx doi org 10 1007 978 3 662 46803 6 10 11 satoshi nakamoto bitcoin peer peer electronic cash system 2009 url http www bitcoin org bitcoin pdf 12 nlgstats nl nlgstats nl 2016 url http nlgstats nl historical mining stats html 13 meni rosenfeld analysis hashrate based double spending abs 1402 2009 2014 url http arxiv org abs 1402 2009 corr x0c